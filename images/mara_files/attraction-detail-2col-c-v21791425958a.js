var ta="undefined"!=typeof window&&window.ta||{},define,require;ta.rollupAmdShim=ta.rollupAmdShim||function(){function e(e,i){var t,o,d,f;for(t=0;e&&e.length&&t<e.length;++t)m[e[t]]=!0;for(t=0;i&&i.length&&t<i.length;++t)w[i[t]]=!0;var l,u;if(y&&window._dummyDefine&&window._dummyDefine.isDummyDefine&&(l=window._dummyDefine.pendingDefinitions,window._dummyDefine=null,define=null),"undefined"!=typeof require&&require.isDummyRequire){u=require.pendingRequirements;var a=require.pendingConfigs;if(a&&a.length)for(t=0;t<a.length;t++)f=a[t],r.config.apply(null,f);require=null}if("function"==typeof define&&define.isTaRollupShim||(E="function"==typeof define?define:null,define=n),"function"==typeof require&&require.isTaRollupShim||(O="function"==typeof require?require:null,require=r),l&&l.length)for(t=0;t<l.length;t++)o=l[t],n.apply(null,o);if(u&&u.length)for(t=0;t<u.length;t++)d=u[t],r.apply(null,d)}function n(e,r,t,d){var f,l,a=[];if("function"==typeof r&&void 0===t&&void 0===d&&(t=r,r=[]),"string"==typeof e&&"object"==typeof r&&"function"==typeof t){if(D.hasOwnProperty(e)||v[e]&&v[e].deps)return;if(l=i(r,a))try{f=t.apply(null,l),u(e,f)}catch(e){L("Error in require callback: ",e)}else o(a,{deps:r,cb:t,defname:e},n.depLoader)}else{if(E)return E(e,r,t,d);L("invalid args for AMD define: "+typeof e+", "+typeof r+", "+typeof t)}}function r(e,r,d,f){var l=null;if("string"==typeof e&&"function"!=typeof r){try{l=i([e]),!l&&O&&(l=[O(e,r,d,f)])}catch(e){}if(!l)throw t(e);return l[0]}if("object"==typeof e&&"function"==typeof r){var u=[];if(l=i(e,u))try{r.apply(null,l)}catch(e){L("Error in require callback: ",e)}else o(u,{deps:e,cb:r,eb:"function"==typeof d&&d},n.depLoader)}else{if(O)return O(e,r,d,f);L("invalid args for AMD require: "+typeof e+", "+typeof r+". Expected either a string-literal singular dependency (i.e. synchronous) or an array of dependencies with a callback function (i.e. async).")}}function i(e,n){var r,i,t,o,d=[];for(r=0;r<e.length;++r)if(i=e[r],o=null,i)if(D.hasOwnProperty(i))o=D[i],d.push(o);else if(w[i]){for(t=i.split("/"),"underscore"===t[0]&&(t[0]="_"),o="undefined"!=typeof window&&window;t.length>1&&o;o=o[t.shift()]);t.length>0&&o&&(o=o[t[0]]||o[t[0].toLowerCase()]),o?(D[i]=o,d.push(o)):n.push(i)}else n&&n.push(i);else d.push(null);if(d.length===e.length)return d}function t(e){var n,r,i,t,o="Missing immediately required dependency: "+e;for(n=0;n<10;n++){var d=v[e];if(!d){o+=" (not specified)";break}if(d.error){o+=" ("+d.error+")";break}if(e=null,t=d.deps)for(r=0;r<t.length;r++)if(i=t[r],!D.hasOwnProperty(i)){e=i;break}if(!e)break;o+=" -> "+e}var f=new Error(o);return y&&!window.IS_DEBUG||!g||y&&null===window.require.caller&&/^R|react$/.test(e)||g.error(f),f}function o(e,n,t){var u,a,s,p,c,h,y,g=[],m=[],w=[];n.deps=n.deps||[],n.defname&&(p=v[n.defname],v[n.defname]=n,p&&p!==n&&p.needers&&p.needers.length&&(n.needers=(p.needers||[]).concat(n.needers||[])));for(var c=0;c<e.length;c++)u=e[c],h=u.lastIndexOf("!"),h>=0?(g.push(u.substring(0,h)),m.push(u.substring(h+1))):(g.push(null),m.push(u));if(g=i(g,w),!g)return o(w,n);for(var c=0;c<e.length;c++)if(a=g[c],s=v[e[c]],!s&&!D.hasOwnProperty(e[c])){s={defname:e[c]},v[e[c]]=s;var E=f(s),P=l(s);E.error=P;try{if(a)a.load(m[c],r,E,{});else if(t)t(m[c],r,E,{});else{if(!O||O.taVer)throw new Error("no loader for AMD module '"+s.defname+"'");O([s.defname],E,P)}y=!0}catch(e){n.error=e,P(e)}}n.need=0;for(var c=0;c<e.length;c++)u=e[c],s=v[u],!s||D.hasOwnProperty(u)||s.error||(s.needers=s.needers||[],s.needers.push(n),n.need+=1);!n.need&&y&&(b.push(n),q||(q=setTimeout(d,0)))}function d(){var e,n,r,t;for(q=-1;b.length>0;){var d=b.shift();if(d)try{if(d.error){d.defname&&a(d.defname);continue}if(n=[],t="string"==typeof d.deps?[d.deps]:d.deps,e=i(t||[],n),n.length>0){o(n,d);continue}r=null,d.cb&&(r=d.cb.apply(null,e)),d.deps=[],d.cb=null,d.defname&&u(d.defname,r)}catch(e){L("Error propagating dependency resolutions: ",e)}}q=null}function f(e){return function(n){e.defname&&u(e.defname,n)}}function l(e){return function(n){e.defname&&(e.error="Error loading '"+e.defname+"': "+n,L(e.error),e.need=0,e.deps=[],a(e.defname))}}function u(e,n){if(!D[e]){var r=v[e];if(D[e]=n,delete v[e],m[e]){var i,t=e.split("/"),o=ta;for("ta"===t[0]&&t.shift();t.length>1;)i=t.shift(),o[i]||(o[i]={}),o=o[i];t.length>0&&(i=t.shift(),i in o||i.toLowerCase()in o||(o[i]=n,o[i.toLowerCase()]=n))}if(E&&E(e,[],s(n)),r)for(;r.needers&&r.needers.length>0;){var f=r.needers.shift();f.need-=1,f.need||b.push(f)}b.length&&!q&&(q=setTimeout(d,0))}}function a(e){var n=v[e];if(n){var r=n.eb;for(n.deps=null,n.cb=null,n.eb=null,n.error||(n.error="Error loading '"+n.defname+"'");n.needers&&n.needers.length>0;){var i=n.needers.shift();i.error="Failed to load AMD module '"+e+"' which is depended upon by '"+i.defname+"'",i.need>0&&(i.need=0,b.push(i)),y&&!window.IS_DEBUG||!g||g.error(i.error)}if(null!=r)try{r(n.error)}catch(e){}}b.length&&!q&&(q=setTimeout(d,0))}function s(e){return function(){return e}}function p(e){return e&&(e.indexOf("trjs!")!==-1||e.indexOf("trcss!")!==-1||e.indexOf("trhtml!")!==-1||e.indexOf("trdust!")!==-1)}function c(){return!("undefined"!=typeof ta&&ta.page&&ta.page.loadDeferred)}function h(){var e,n,r,t,o;if(q)return void setTimeout(h,0);if(P=!0,v&&c())for(e in v)if(v.hasOwnProperty(e)){if(n=v[e],t=[],o=[],p(n.defname))continue;if(v.hasOwnProperty("trjs!"+n.defname))continue;if(n.deps&&n.deps.length){for(r=0;r<n.deps.length;r++)p(n.deps[r])||t.push(n.deps[r]);if(i(t,o),0===o.length)continue}L("Page 'load' event fired but we have not resolved the '"+n.defname+"' AMD module"+(n.deps&&n.deps.length?" due to missing dependencies: "+o:""))}}var y="undefined"!=typeof window,g=y&&window.console||"undefined"!=typeof console&&console||void 0,m={},w={},v={},b=[],q=null,D={ta:ta},E=null,O=null,P=!1,L=function(e,n){if("undefined"!=typeof __SERVER__)throw n;g&&g.error.apply&&g.error.apply(g,arguments),g&&!g.error.apply&&g.error&&g.error([].slice.apply(arguments))};n.amd=!0,n.isTaRollupShim=!0,n.depLoader=function(){},n.depLoader.isDefault=!0,r.isTaRollupShim=!0,r.undef=function(e){delete D[e];var n=v[e];n&&n.deps&&(n.deps=[],n.cb=null,n.defname=null,delete v[e])},r.config=function(){O&&O.config&&O.config.apply(O,arguments)},r.defined=function(e){return!!D.hasOwnProperty(e)||!v.hasOwnProperty(e)&&(O&&O.defined&&O.defined(e))},r.parsed=function(e){return!!D.hasOwnProperty(e)||v[e]&&v[e].deps},r.specified=function(e){return!(!D.hasOwnProperty(e)&&!v[e])||O&&O.specified&&O.specified(e)},y&&window.addEventListener?window.addEventListener("load",h,!1):y&&window.attachEvent&&window.attachEvent("onload",h);var _={install:e,reportMissing:h,define:n,require:r,initializedModules:D,debug:function(){return{initializedModules:D,pendingModules:v,outer:{require:O,define:E},depLoader:n.depLoader}}};return _.install(),u("ta/rollupAmdShim",_),_}();
function checkEmailActionAttr(t,e,a,n){window.location="mailto:"+t+"?subject="+a,new Request({url:"/ActionRecord?excludeFromVS=false&action="+n+"&d="+e}).send()}function _isAnimalWelfareOverlay(t){return t&&t.sourceElement&&t.sourceElement.hasClass("animal_tag")}"undefined"==typeof ta.attractions&&(ta.attractions=new Object),ta.attractions.showMoreDetails=function(t,e,a){var n=ta.id("ATTRACTION_OVERLAY_CONTENTS");if(n){var o=n.clone();o.removeClass("detailsOverlayHide");new ta.overlays.CenteredOverlay({showCloseButton:!0,style:"s4 mg",content:o,fontSize:"1em",attachCloseEvent:!0});ta.trackEventOnPage("AttractionListing","MoreDetails",a,1,!1)}},ta.attractions.showMoreTags=function(t,e){return t.preventDefault(),ta.select(".collapse").removeClass("hidden"),e.addClass("hidden"),!1},ta.on("overlay_source_clicked",function(t){_isAnimalWelfareOverlay(t)&&ta.trackEventOnPage("Attractions","Attraction_Review_paw_button","")}),ta.on("overlay_closed",function(t){_isAnimalWelfareOverlay(t)&&ta.trackEventOnPage("Attractions","Attraction_Review_paw_close","")}),ta.on("shelf_item_click_event",function(t,e){window.open(require("attractions/url_decode").getUrl(e),"_blank"),ta.trackEventOnPage("AttractionReview","RecentlyViewedShelf_Click",e.getAttribute("data-tpatt"),window.modelLocId)});
require(["ta/rollupAmdShim"],function(a){a.install(["attractions/url_decode","pages/location_detail","pages/reviews","ta/common/behavior/ScrollAd","ta/servlet/ShowSpecialOffer","ta/maps/trackpixel","answers/minimal","lib/jquery-amd","ta/Core/TA.Record","utils/resourceLoader","ta/Core/TA.Event","ta/util/Cookie","overlays/Overlay","overlays/styles/modal","overlays/styles/dropdown","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","ta/Core/TA.Store","ta/util/Deferred","overlays/options/disablePageScroll","lib/TypeAhead","members/memberOverlay","common/trackingStreams","overlays/options/ajax","api-mod","overlays/uiOverlay","overlays/styles/default","overlays/position/conditional","utils/responsive","overlays/position/fullscreen","overlays/position/center","utils/ajax","vanillajs","actions/openRespPhotoViewer","utils/stopevent","overlays/ajaxUtil","ta/Core/TA.FireEvent","ta/prwidgets","utils/nodePreserve","hotels/SpecialMessageUtil","ta/common/Flyout","ta/util/Link","ta/maps/opener","utils/classnameUtils","utils/ceUtils","ta/servlet/ShowSpecialOffer","ta/util/Element","utils/ScrollInContainer","ta/popups/BeforePopTargetBlankIE","babel/babel-helpers","ta/Core/TA.Load","ta/util/openNewTab","tab_bar/TabBar","tab_bar/ScrollPastBottom","tab_bar/MoreTab","tab_bar/HighlightActiveTab","tab_bar/StickyBar","tab_bar/CorrectLazyLoadOffset","overlays/utils","overlays/widgetoverlays","ta/util/Error","ta/util/ReCaptcha","ta/util/GeeTest","pages/inappropriate_vote_stub","ta/registration/RegOverlay","ta/registration/AuthCheck","hotels/HRContentBlockUtils","actions/openPhotoViewer","utils/localstorage","utils/ellipsis","xsell/metaLightbox","typeahead/TypeAhead.utils","ta/servlet/userreview/common","ta/util/Qualaroo","ta/support/Qualtrics","ta/util/Object","widget/saves","servlets/attractionreview","common/trackingStreams","vanillajs","ta/common/Flyout","ta/Core/TA.Record","ta/util/Link","ta/Core/TA.Event","overlays/uiOverlay","ta/maps/opener","utils/classnameUtils","lib/jquery-amd","ta/prwidgets","utils/nodePreserve","utils/ceUtils","ta/servlet/ShowSpecialOffer","ta/Core/TA.FireEvent","ta/util/Cookie","api-mod","ta/util/Element","utils/ScrollInContainer","ta/popups/BeforePopTargetBlankIE","babel/babel-helpers","ta/Core/TA.Load","ta/Core/TA.Store","ta/util/openNewTab","tab_bar/TabBar","tab_bar/ScrollPastBottom","tab_bar/MoreTab","tab_bar/HighlightActiveTab","tab_bar/StickyBar","tab_bar/CorrectLazyLoadOffset","overlays/utils","overlays/widgetoverlays","utils/ajax","ta/util/Error","ta/util/ReCaptcha","ta/util/GeeTest","pages/inappropriate_vote_stub","members/memberOverlay","ta/registration/RegOverlay","ta/registration/AuthCheck","hotels/HRContentBlockUtils","overlays/Overlay","overlays/styles/modal","overlays/styles/dropdown","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","ta/util/Deferred","overlays/options/ajax","overlays/options/disablePageScroll","overlays/styles/default","overlays/position/conditional","utils/responsive","overlays/position/fullscreen","overlays/position/center","actions/openPhotoViewer","overlays/ajaxUtil"],["ta","ta","ta","ta","page-model","page-model","ta","page-model","ta","ta","ta","ta","ta","ta","ta","ta","page-model","page-model","ta","ta","ta","ta","ta","ta","ta","ta","ta","ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"attraction-detail-2col-en_IN",files:{js3_secure:{ssl:{ta:{util:{Deferred:1,Qualaroo:1},Core:{"TA.Record":1}}}},"js-amd":{lib:{babel:{"babel-helpers":1}},src:{styleguide:{overlays:{Modal:1}},tab_bar:{TabBar:1,StickyBar:1,ScrollPastBottom:1,HighlightActiveTab:1,CorrectLazyLoadOffset:1,MoreTab:1},widget:{saves:1},mobile:{lite:{"image-loader":1}},purify:1,commerce:{offerclickEvents:1},"ajax-request":1,mixins:{"page-dates":{"default-dates":1,"pop-calendar":1,Desktop:1,Utils:1,DateEvents:1,Base:1,Validator:1,DateTypeStore:1},Reviews:1,Events:1},common:{trackingStreams:1,"pixels-loader":1,Radio:1},"ns-exporter":1,amdloaders:1,calendars:{CalendarDate:1,DesktopStayDates:1},hotels:{SpecialMessageUtil:1,ChildAgesSerialization:1,HRContentBlockUtils:1},utils:{urlutils:1,throttle:1,ScrollInContainer:1,"asdf-encoder":1,browserutils:1,stopevent:1,AjaxData:1,ceUtils:1,"is-element":1,ajax:1,ellipsis:1,localstorage:1,array:{flatten:1},errorutils:1,"to-array":1,HistoryManager:1,"form-to-json":1,objutils:1,responsive:1,"json-to-url":1,classnameUtils:1,resourceLoader:1,nodePreserve:1,object:{"set-props":1,"shallow-copy":1}},"api-mod":1,members:{memberOverlay:1},overlays:{EmailHotelOverlay:1,ajaxUtil:1,uiOverlay:1,ux:{elementToggle:1},utils:1,options:{closeOnWindowshadeClick:1,pinnable:1,autoReposition:1,moveIntoView:1,closeOnEscape:1,closeOnBackButton:1,closeOnTaEvent:1,repositionOnEvent:1,disablePageScroll:1,ajax:1,closeOnDocClick:1},widgetoverlays:1,styles:{"default":1,spinnershade:1,popover:1,tooltip:1,windowshade:1,dropdown:1,modal:1},position:{conditional:1,fullscreen:1,center:1,centerWithGutters:1,autosize:1,base:1},Overlay:1,"loading-spinner":1,support:{radio:1}},servlets:{attractionreview:1},xsell:{metaLightbox:1},actions:{openPhotoViewer:1,openRespPhotoViewer:1},vanillajs:1}},js3:{lib:{TypeAhead:1,"jquery-amd":1,jquery:{"jquery.hoverIntent":1}},build:{es6:{src:{overlays:{options:{closeOnEmit:1,disableBodyScroll:1}},photoviewer:{loader:1,tracking:1}}}},src:{pages:{reviews:1,location_detail:1,inappropriate_vote_stub:1},answers:{minimal:1},trcore:1,attractions:{url_decode:1},typeahead:{"TypeAhead.utils":1,"TypeAhead.views":1},ta:{common:{Repoll:1,Flyout:1,Search:1,behavior:{ScrollAd:1}},maps:{opener:1,trackpixel:1},util:{Cookie:1,Element:1,Error:1,String:1,ReCaptcha:1,Date:1,ajaxPreserves:1,openNewTab:1,GeeTest:1,Object:1,SessionStorage:1,Link:1,I18N:1},servlet:{ShowSpecialOffer:1,userreview:{common:1}},prwidgets:1,popups:{BeforePopTargetBlankIE:1},registration:{AuthCheck:1,RegOverlay:1,RegEvents:1},media:{viewerScaffold:1},photos:{oysterTracking:1},support:{Qualtrics:1},Browser:1,Core:{"TA.FireEvent":1,"TA.Event":1,"TA.Load":1,"TA.Dust":1,"TA.LocalStorage":1,"TA.Store":1}}}}},_:{baseUrl:"/"}})};
define("attractions/url_decode",[],function(){var e={};return e.decodeUrl=function(e){if(!e)return null;var t=4;return e=ta.util.decoder.base64Decoder(e),e=e.substring(t,e.length-t)},e.getUrl=function(t){return t.getAttribute("href")||e.decodeUrl(t.getAttribute("data-params"))},e});
define("lib/jquery-amd",[],function(){return window.Zepto||ta.jquery||window.jQuery});
define("vanillajs",[],function(){return{}});
define("utils/browserutils",["vanillajs"],function(e){"use strict";var o={},n=window.navigator?window.navigator.userAgent.toLowerCase():"",a=window.navigator?window.navigator.platform.toLowerCase():"",r=n.match(/(opera|ie|firefox|chrome|crios|trident|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],i="ie"==r[1]&&document.documentMode;return"trident"===r[1]&&(r[1]="ie",r[2]=parseInt(r[2],10)+4),o.name="version"==r[1]?r[3]:r[1],o.version=i||parseFloat("opera"==r[1]&&r[4]?r[4]:r[2]),o.Platform={name:n.match(/ip(?:ad|od|hone)/)?"ios":(n.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]},o[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.Platform[o.Platform.name]=!0,o});
define("utils/throttle",["vanillajs"],function(){return function(t,n,e){var i,r;return function(){r&&(clearTimeout(r),r=0);var u=i?n-(Date.now()-i):null;if(null!==u&&u>0)return void(e||(r=setTimeout(t.apply.bind(t,this,arguments),u)));var l=t.apply(this,arguments);return i=Date.now(),l}}});
define("utils/stopevent",["vanillajs"],function(){return function(e){return e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1),!1}});
define("utils/form-to-json",["vanillajs"],function(){"use strict";function e(e,n,r){e in r?(Array.isArray(r[e])||(r[e]=[r[e]]),r[e].push(n)):r[e]=n}return function(n){for(var r={},i={file:1,reset:1},t={DATALIST:1,OUTPUT:1},a={checkbox:1,radio:1},o=0;o<n.elements.length;o++){var l=n.elements[o],s=l.name;if(s){var u=l.nodeName,f=l.type;if("SELECT"===u)for(var v=0;v<l.options.length;v++){var c=l.options[v];c.selected&&e(s,c.value,r)}else"INPUT"===u?f in a?l.checked&&e(s,l.value,r):f in i||e(s,l.value,r):u in t||e(s,l.value,r)}}return r}});
define("utils/to-array",["vanillajs"],function(){return function(n){return"number"!=typeof n.length?[n]:Array.prototype.slice.call(n)}});
define("utils/is-element",["vanillajs"],function(){return function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}});
define("api-mod",["lib/jquery-amd","utils/browserutils","utils/throttle","utils/stopevent","utils/form-to-json","utils/to-array","utils/is-element"],function($,browser,throttle,stopEvent,formToJson,toArray,isElement){"use strict";var exports={};return exports.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=null;try{f=eval(fn)}catch(t){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(t){}}if(f&&"function"==typeof f)return f}return null},exports.bind=function(t,e){return Function.prototype.bind.apply(t,Array.prototype.slice.call(arguments,1))},exports.bindAll=function(t,e){if(arguments.length>1)Array.prototype.slice.call(arguments,1).forEach(function(e){t[e]=this.bind(t[e],t)},this);else for(var r in t)t.hasOwnProperty(r)&&(t[r]=this.bind(t[r],t));return t},exports.inDocument=function(t){return t=exports.find(t),!!t.parentNode&&11!==t.parentNode.nodeType},exports.addEvent=function(t,e,r){$(t).on(e,r)},exports.fireEvent=function(t,e,r){$(t).trigger(e,r)},exports.removeEvent=function(t,e,r){$(t).off(e,r)},exports.removePropertyEvent=function(t,e,r){"on"!==e.substr(0,2)&&(e="on"+e);var o=t.getAttribute(e);if(o){var n,s=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");n=o.replace(new RegExp(s+"\\s*\\([^)]*\\);?|(ta\\.call|requireCallLast|requireCallIfReady)\\s*\\(\\s*['\"]\\s*"+s+"[^)]*\\);?"),""),t[e]=n.trim()}},exports.store=function(t,e,r){$(t).data(e,r)},exports.retrieve=function(t,e){return $(t).data(e)},exports.getSize=function(t){if(t=exports.find(t),!t)return null;if(/^(?:body|html)$/i.test(t.tagName)||t===window||t===document){var e=document.compatMode&&"CSS1Compat"!==document.compatMode?document.body:document.body.parentNode;return{x:e.clientWidth,y:e.clientHeight}}return{x:t.offsetWidth,y:t.offsetHeight}},exports.getPosition=function(t,e){if(e=$(e),t=$(t),e.length){var r=e.offset(),o=t.offset();return{left:o.left-r.left,top:o.top-r.top}}return t.offset()},exports.getCoords=function(t){if(t=exports.find(t),!t)return null;var e=this.getSize(t),r=this.getPosition(t);return{top:r.top,left:r.left,bottom:r.top+e.y,right:r.left+e.x,height:e.y,width:e.x}},exports.getOffsetParent=function(t){return $(t).offsetParent().get(0)},exports.getParent=function(t,e){if(t=exports.find(t),!t)return null;if(e){for(;t&&"html"!=t.tagName;t=t.parentNode)if(exports.hasClass(t,e))return t;return null}return t.parentNode},exports.elementOrParentMatches=function(t,e){if(e)for(;t;t=t.parentElement)if(e(t))return!0;return!1},exports.containsElement=function(t,e){if(t=exports.find(t),e=exports.find(e),!t||!e)return!1;for(;null!=e;){if(e===t)return!0;e=e.parentElement}return!1},exports.checkBrowser=function(t){var e=Array.prototype.slice.call(arguments);return e.some(function(t){return!!browser[t]})},exports.containsEvent=function(t,e){if(t=exports.find(t),!e||!t)return!1;var r=e.pageX,o=e.pageY,n=this.getCoords(t);return"fixed"!==$(this.getOffsetParent(t)||t).css("position")&&"undefined"!=typeof r&&"undefined"!=typeof o||(r=e.clientX,o=e.clientY),o>=n.top&&o<=n.bottom&&r>=n.left&&r<=n.right},exports.select=function(t,e){var r=Array.prototype.slice.call(arguments),o=r.length>1&&("string"==typeof r[0]?r.pop():r.shift())||document,n=r.shift();try{return $(n,o).get()}catch(t){return[]}},exports.addClass=function(t,e){$(t).addClass(e)},exports.removeClass=function(t,e){$(t).removeClass(e)},exports.toggleClass=function(t,e,r){$(t).toggleClass(e,r)},exports.hasClass=function(t,e){return t&&$(t).hasClass(e)},exports.destroy=function(t){$(t).remove().get()},exports.find=function(t,e){try{return $(t,e||document)[0]}catch(t){}},exports.scrollTop=function(){var t=void 0!==window.pageYOffset,e="CSS1Compat"===(document.compatMode||"");return t?window.pageYOffset:e?document.documentElement.scrollTop:document.body.scrollTop},exports.scrollLeft=function(){var t=void 0!==window.pageXOffset,e="CSS1Compat"===(document.compatMode||"");return t?window.pageXOffset:e?document.documentElement.scrollLeft:document.body.scrollLeft},exports.createElement=function(t,e){var r=document.createElement(t);return e&&$(r).attr(e),r},exports.isElement=isElement,exports.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},exports.adopt=function(t,e){$(t).append(Array.prototype.slice.call(arguments,1))},exports.setStyle=function(t,e,r){$(t).css(e,r)},exports.stopEvent=stopEvent,exports.mixin=function(t,e){return Array.prototype.slice.call(arguments,1).forEach(function(e){for(var r in e)t[r]=e[r]},t),t},exports.merge=function(t,e){for(var r=Array.prototype.slice.call(arguments,1),o=0,n=r.length;o<n;o++)for(var s in r[o])r[o].hasOwnProperty(s)&&(t[s]=r[o][s]);return t},exports.getFormData=function(t){return formToJson($(t).get(0))},exports.toFormQueryString=function(t){var e=[];t&&"FORM"===t.nodeName&&(t=exports.getFormData(t));for(var r in t)if(t.hasOwnProperty(r)){var o=t[r];if(o&&"object"==typeof o)for(var n=0;o.length&&n<o.length;++n){var s=o[n];s="object"==typeof s?"":String(s),e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}else e.push(encodeURIComponent(r)+"="+encodeURIComponent(String(o)))}return e.join("&")},exports.toArray=toArray,exports.throttled=throttle,exports.forceReflow=function(t){$(t).each(function(t,e){e.offsetWidth})},exports.stripTags=function(t,e,r){e=e||"";var o=r?"<"+e+"(?!\\w)[^>]*>([\\s\\S]*?)</"+e+"(?!\\w)>":"</?"+e+"([^>]+)?>";return t.replace(new RegExp(o,"gi"),"")},exports});
define("mixins/Events",["vanillajs"],function(e){"use strict";var t=function(){this.events={},Array.prototype.slice.call(arguments).forEach(function(e){this.events[e]=[]},this)};return t.create=function(){function e(e){return t.apply(this,e)}return e.prototype=t.prototype,function(){return new e(arguments)}}(),t.extend=function(e,r){var i=Object.create(t.prototype);return i.delegate=e,t.apply(i,r),i},t.prototype.on=t.prototype.addListener=function(e,t){return void 0!==this.events[e]?this.events[e].push(t):this.delegate?this.delegate.on(e,t):this.events[e]=[t],this},t.prototype.off=t.prototype.removeListener=function(e,t){if(void 0!==this.events[e])if(t){var r=this.events[e].indexOf(t);r>=0&&this.events[e].splice(r,1)}else this.events[e].length=0;else this.delegate&&this.delegate.removeListener(e,t);return this},t.prototype.removeAllListeners=function(e){if(e&&void 0!==this.events[e])this.events[e].length=0;else if(e)this.delegate&&this.delegate.removeAllListeners&&this.delegate.removeAllListeners(e);else{for(var t in this.events)this.events.hasOwnProperty(t)&&(this.events[t].length=0);this.delegate&&this.delegate.removeAllListeners&&this.delegate.removeAllListeners()}},t.prototype.hasListeners=function(e){if(e){if(this.events.hasOwnProperty(e))return this.events[e].length>0;if(this.delegate&&this.delegate.hasListeners)return this.delegate.hasListeners(e)}return!1},t.prototype.emit=function(e,t){if(this.events[e]){var r=Array.prototype.slice.call(arguments,1);this.events[e].slice(0).forEach(function(t){if(t)try{t.apply(this,r)}catch(t){"string"==typeof t&&(t=new Error(t));var i="Error in event handler for "+e;if(require.defined("ta/util/Error"))require("ta/util/Error").record(t,i);else{var s=require.defined("ta")&&require("ta");s&&s.log&&s.log.error?s.log.error(t,i):s&&s.m&&s.m.recordJSError?s.m.recordJSError([t,i]):"undefined"!=typeof console&&(console.error||console.log)(i,t)}}},this)}else this.delegate&&this.delegate.emit&&this.delegate.emit.apply(delegate,arguments);return this},t});
define("tab_bar/TabBar",["lib/jquery-amd","api-mod","mixins/Events","utils/throttle"],function(t,i,n,e){"use strict";function o(o,r,s){function l(i,n){if(!d){i=t(i);var e=c.getAnchor(i),o=u.getElements();if(e.length&&!e.is(":visible")){var r=o.anchors,s=r.index(e);if(s>=0)for(;s<r.length&&!e.is(":visible");s++)e=r.eq(s)}if(c.emit("beforeTabClick",i.get(0),e.get(0)),e.length){var l=n||b;d=!0,setTimeout(function(){d=!1},2*l);var a=function(){d=!1,c.emit("afterTabClick",i.get(0),e.get(0))},f=u.getScrollable(o.scrollWindow),h=u.getTopInScrollable(o.scrollWindow,e)-u.getClickOffset();f.stop?f.stop(!0,!0).animate({scrollTop:h},{duration:l,complete:a}):(window.scrollTo(0,h),a())}}}function a(){var i=t(this);i.is(":visible")&&l(i)}i.mixin(this,new n("init","uninit","test","redraw","beforeTabClick","afterTabClick")),function(){var t=this.emit;this.emit=function(){v=!0,t.apply(this,arguments),w=null,v=!1}}.bind(this)(),r=r||{};var c=this,u={},f={},h={},b=r.scrollSpeed||300,d=!1,g=r.tabAttr||"data-anchor",m=r.anchorAttr||"data-tab",w=null,v=!1;if(s)for(var p=0;p<s.length;p++)s[p]&&s[p].call(this,u);this.init=function(){var i=u.getElements();return this.uninit(),i.scrollWindow.on("scroll",T),t(window).on("resize orientationchange",k),i.anchors.each(function(i,n){n=t(n),f[n.attr(m)]=n}),i.tabs.each(function(i,n){n=t(n),h[n.attr(g)]=n}),i.tabs.on("click",a),setTimeout(this.emit.bind(this,"init"),1),setTimeout(k,1),this},this.uninit=function(){var i=u.getElements();i.scrollWindow.off("scroll",T),t(window).off("resize orientationchange",k),f={},d=!1,i.tabs.off("click",a),this.emit("uninit")},this.redraw=this.emit.bind(this,"redraw"),this.test=this.emit.bind(this,"test");var T=e(this.emit.bind(this,"test"),300);this.isScrolling=function(){return d},this.show=function(t,i){l.apply(null,arguments)},this.getAnchor=function(i){var n=i.substr?i:t(i).attr(g);return f[n]||t()},this.getTab=function(i){var n=i.substr?i:t(i).attr(m);return n in h?h[n].get(0):null};var k=function(){this.redraw(),this.test()}.bind(this);!function(){var i=o,n=r.clickOffset||0;u.getElements=function(){if(v&&w)return w;var n=t(i.tabBar),e={tabBar:n,scrollRegion:t(i.scrollRegion||"body"),scrollWindow:t(i.scrollWindow||window),content:i.content?t(i.content):t(".tb_content",n),tabs:i.tabs?t(i.tabs):t(".tb_tab",n)};if(i.anchors)e.anchors=t(i.anchors);else{var o=e.scrollRegion.attr(m);e.anchors=t(o?i.scrollRegion:null).add(t("["+m+"]",i.scrollRegion))}return v&&(w=e),e},u.getClickOffset=function(){return n},u.getAnchorAttr=function(){return m},u.getScrollable=function(i){return u.isWinOrBody(i)?t("html,body"):i},u.getTopInScrollable=function(i,n){return n=t(n),u.isWinOrBody(i)?n.offset().top:t(i).scrollTop()+n.position().top},u.isWinOrBody=function(t){return t.get(0)==window||t.get(0)==document.body}}()}return o});
define("tab_bar/ScrollPastBottom",["lib/jquery-amd"],function(t){"use strict";function i(){return function(i){var e,n=-1;return this.on("beforeTabClick",function(o,r){if(r){var c=i.getElements();e||(e=t("<div></div>").css("height",0),c.scrollRegion.append(e));var h=c.scrollRegion.height()-e.height(),l=h-i.getTopInScrollable(c.scrollWindow,r),s=c.scrollWindow.height()-l;n=-1,s>e.height()?e.css("height",s+"px"):n=Math.max(s,0)}}).on("afterTabClick",function(){n>=0&&e.css("height",n+"px")}),this}}return i});
define("tab_bar/MoreTab",["lib/jquery-amd"],function(e){"use strict";function t(t){return function(n){function i(n){var i=o||(t.tab?e(t.tab):e(".tb_more",n.tabBar));return{tab:i,content:t.content?e(t.content):e(".tb_more_content",i),dodge:t.dodge?e(t.dodge):e()}}function a(t,n){for(var i=0;i<t.length;i++){var a=e(t[i]);if(a.is(":visible")&&a.offset().top>n)return!0}return!1}function r(){var t=n.getElements(),a=i(t);a.content.is(":visible")&&a.content.css("display",""),e(window).off("click",r)}var o;t=t||{};var d=function(n){var i=e(n.dodge);if(i=i.add(n.tab),t.neverHide)for(var a=0;a<t.neverHide.length;a++){var r=this.getTab(t.neverHide[a]);r&&(i=i.add(r))}return i}.bind(this);this.on("redraw",function(){var r=n.getElements(),c=i(r),s=e(r.tabs).not(".hidden"),l=function(e){var t=s.index(e);t>=0&&s.splice(t,1)};if(o||(c.tab.addClass("hidden"),c.tab.before(c.content.children().detach()),l(c.tab)),t.neverHide)for(var b=0;b<t.neverHide.length;b++)l(this.getTab(t.neverHide[b]));for(var f=!1,g=r.tabs.filter(":visible"),v=e(g.length?g.get(0):r.tabs.get(0)),h=v.offset().top+v.height()/2,u=d(c);s.length&&(a(s.last(),h)||a(u,h));){var p=e(s.splice(-1,1));if(o){var m=v;g.length&&(g.get(g.length-1)==c.tab.get(0)?g.length>=2&&(m=e(g.get(g.length-2))):m=e(g.get(g.length-1))),m.after(c.tab),o=null,c=i(r)}c.content.prepend(p.detach()),c.tab.removeClass("hidden"),f=!0}f||o||(o=c.tab.detach())}).on("beforeTabClick",function(t){t=e(t);var a=n.getElements(),o=i(a);o.tab.get(0)==t.get(0)&&(o.content.is(":visible")?o.content.css("display",""):(o.content.css("display","block"),setTimeout(function(){e(window).on("click",r)},1)))})}}return t});
define("tab_bar/HighlightActiveTab",["lib/jquery-amd","api-mod","mixins/Events"],function(t,e,i){"use strict";function n(e){function n(e){for(var i=t(e.tabs.get(0));i.length&&i.get(0)!=e.tabBar.get(0);i=i.parent()){if("fixed"==i.css("position")||"absolute"==i.css("position"))return i.height();if("body"==i.prop("tagName").toLowerCase())break}return 0}e=e||{};var s=e.activeClassName||"current",o=e.offset||0,r="undefined"==typeof e.defaultToFirstTab||e.defaultToFirstTab;return function(a){i.extend(this,["activeChanged"]);var l=t(),f=t();this.getActiveTab=function(){return l.get(0)},this.on("uninit",function(){l.removeClass(s),l.empty()}).on("test",function(){var i,c=null,g=a.getElements(),u=g.tabBar.closest(g.scrollRegion).length>0,h=t(g.anchors.filter(":visible").get().reverse());if(u){var v,b,d;h.each(function(e,s){var r=!1,l=t(s),f=t(this.getTab(s));if(l.get(0)==document.body?r=!0:f.is(":visible")&&(void 0===v&&(v=a.isWinOrBody(g.scrollRegion),d=n(g)+o),v?(void 0===b&&(b=t(g.scrollWindow).scrollTop()),r=l.offset().top-d<=b):r=l.position().top-d<=0),r)return i=f,c=l,!1}.bind(this))}else h.each(function(e,n){var s=t(n);if(s.position().top<=0)return i=t(this.getTab(s.get(0))),c=s,!1}.bind(this));if(!i&&r){var p=g.tabs.filter(":visible");i=p.length?p.first():g.tabs.first()}if(i&&(i.length&&i.get(0)!=l.get(0)?(l.removeClass(s),i.addClass(s),this.emit("activeChanged",l.get(0),i.get(0)),l=i,f=c):!i.length&&l.length&&(l.removeClass(s),this.emit("activeChanged",l.get(0),null),l=t(),f=t())),e.scrollToTab){var m=l.position().left+t(g.content).scrollLeft();g.content.prop("scrollLeft",m)}})}}return n});
define("tab_bar/StickyBar",["lib/jquery-amd","api-mod","mixins/Events"],function(t,i,s){"use strict";function n(i,n){return function(e){function o(s){return i?t(i):t(".tb_stickyElt",s.tabBar)}function r(t){var i=t.tabBar.offset().top+(n.lastYOffset||0);return t.scrollWindow.scrollTop()>i}s.extend(this,["beforeSticky","afterSticky"]),n.stickyClass||(n.stickyClass="sticky");var a,c=!1,u=function(t){t.addClass(n.stickyClass).css({transition:"none",top:"-"+t.height()+"px"}),this.redraw(),this.test(),setTimeout(function(){t.css({transition:"",top:0})},1)}.bind(this),f=function(t){a=!0,t.css("top","-"+t.height()+"px"),setTimeout(function(){a=!1,t.removeClass(n.stickyClass).css({transition:"none",top:""}),this.redraw(),this.test()}.bind(this),n.transitionDuration)}.bind(this),h=function(){var t=e.getElements(),i=r(t),s=c!=i;s&&(this.emit("beforeSticky",i),c=i,n.transitionDuration?i?u(o(t)):a||f(o(t)):o(t).toggleClass(n.stickyClass,i),setTimeout(function(){this.emit("afterSticky",i)}.bind(this),n.transitionDuration))}.bind(this);this.on("test",h)}}return n});
define("tab_bar/CorrectLazyLoadOffset",["lib/jquery-amd"],function(t){"use strict";function e(e){var o="wheel mousewheel mousedown touchstart dragstart",n="keydown DOMMouseScroll",r=e?e.sort():[500,1e3,2e3];return function(e){return this.on("afterTabClick",function(l,c){function i(){u&&(a.off(o,i),t(document).off(n,i),u=!1)}function s(t){u&&(a.scrollTop(e.getTopInScrollable(f.scrollWindow,c)-d),t&&i())}var u,f=e.getElements(),a=t(f.scrollWindow),d=e.getClickOffset();a.on(o,i),t(document).on(n,i),u=!0;for(var h=0;h<r.length;h++)setTimeout(s.bind(this,h==r.length-1),r[h])}),this}}return e});
define("pages/location_detail",["tab_bar/TabBar","tab_bar/ScrollPastBottom","tab_bar/MoreTab","tab_bar/HighlightActiveTab","tab_bar/StickyBar","tab_bar/CorrectLazyLoadOffset"],function(t,e,a,n,i,o){"undefined"==typeof ta.locationDetail&&(ta.locationDetail={}),ta.locationDetail.checkEmailAction=function(t,e,a,n,i,o){window.location="mailto:"+a+"?subject="+i,new Request({url:"/ActionRecord?excludeFromVS=false&action="+o+"&d="+n}).send()},ta.locationDetail.resizeHeading=function(t){var e=ta.id("HEADING");if(void 0==e||null==e){if(t>10)return;setTimeout(function(){ta.locationDetail.resizeHeading(t+1)},50)}else for(var a=e.parentNode.offsetWidth,n=2.5835;e.offsetWidth>a&&n>1;)n-=.1,e.style.fontSize=n+"em"},ta.locationDetail.resizeHeading(1),ta.locationDetail.mapMouseOver=function(t,e){var a=e.getElement(".expandMap .expandMapIcon");a&&(a.toggleClass("sprite-expandMapLight"),a.toggleClass("sprite-expandMapDark"))},ta.locationDetail.showMoreDetails=function(t,e,a){var n=ta.id("OVERLAY_CONTENTS");if(n){var i=n.clone();i.removeClass("detailOverlayHide");new ta.overlays.CenteredOverlay({showCloseButton:!0,style:"s4 mg",content:i,fontSize:"1em",attachCloseEvent:!0})}},ta.locationDetail.showMoreHours=function(t,e,a,n){var i=ta.id("HOUR_OVERLAY_CONTENTS");if(i){var o=i.clone();o.removeClass("hoursOverlayHide");new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,showCloseButton:!0,style:"s4 mg",content:o},e);"Eatery"==n?ta.trackEventOnPage("RestaurantListing","MoreHours",a,1,!1):"Attraction"==n&&ta.trackEventOnPage("AttractionListing","MoreHours",a,1,!1)}},ta.locationDetail.showFullEventSchedule=function(t,e){var a=ta.id("EVENT_SCHEDULE_OVERLAY_CONTENTS");if(a){var n=a.clone();n.removeClass("force_hidden");new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,showCloseButton:!0,style:"s4 mg",content:n},e)}},ta.servlet.LocationDetail=function(){var r=null,l=!1,s=!1;return{initTabs:function(){ta.find(".persistent_tabs_header .tabs_pers_item")&&(r=new t({tabBar:".persistent_tabs_container",content:".persistent_tabs_container .tabs_pers_content",tabs:".tabs_pers_item"},{clickOffset:68},[e(),a({tab:".tabs_more",content:".tabs_more .tabs_more_content",dodge:".tabs_buttons"}),n({offset:24}),o(),i("#FLOATING_PERSISTENT_TAB_HEADER",{stickyClass:"fixed",lastYOffset:-15,transitionDuration:150})]),r.init().on("activeChanged",function(t,e){!r.isScrolling()&&e&&ta.trackEventOnPage("Tab_Bar",e.getAttribute("data-anchor")+"_SCROLL",e.getAttribute("data-anchor"))}).on("beforeTabClick",function(t,e){var a=t.getAttribute("data-anchor");ta.trackEventOnPage("Tab_Bar",t.getAttribute("data-track"),a),e&&(window.removeEvent("scroll",ta.servlet.LocationDetail.onScroll),"TABS_MENU"==a?ta.servlet.LocationDetail.loadMenu():"TABS_ANSWERS"==a&&ta.servlet.LocationDetail.loadAnswers(),ta.fireEvent("clickTab",a))}).on("afterTabClick",function(){l&&s||window.addEvent("scroll",ta.servlet.LocationDetail.onScroll)}).on("redraw",function(){ta.find(".tabs_pers_content .tabs_pers_item")&&ta.select("#PERSISTENT_TAB_HEADER").removeClass("invisible")}).on("beforeSticky",function(t){t?ta.fireEvent("arrrTabBarFixBegin"):ta.fireEvent("arrrTabBarUnFixBegin")}).on("afterSticky",function(t){t?(ta.fireEvent("scrollingTabs_updateTabBar",{"height":ta.find(".persistent_tabs_header").getHeight()}),ta.fireEvent("arrrTabBarFixed")):ta.fireEvent("arrrTabBarUnFixed")}))},loadMenu:function(){if(!l){l=!0;var t=ta.id("INLINE_MENU");if(t){var e=window.modelLocId;"SinglePlatform"!==t.getAttribute("data-attribution")&&new Request({url:"/MenuAjax?locId="+e,method:"get",onSuccess:function(e){t.innerHTML=e}}).send();var a=t.getAttribute("data-attribution");"Locu"===a?ta.trackEventOnPage("Tab_Content","L_MENU_VISIBLE","",0,!1):"SinglePlatform"===a&&ta.trackEventOnPage("Tab_Content","SP_MENU_VISIBLE","",0,!1)}}},loadAnswers:function(){if(!s){s=!0,ta.store("answers.pid.pageType",39146),ta.store("answers.pid.registration.question",39145),ta.store("answers.pid.registration.vote",39147);var t=ta.id("QUESTION_LIST");return!(!t||!window.modelLocId)&&(ta.load("ta-answers",function(){require("answers/Answer").updateAnswersTab(window.modelLocId,r?r.test:null)},!0),!1)}},clickTab:function(t){r.show(t)},onScroll:function(){r&&r.isScrolling()||(!s&&ta.util.element.isScrolledIntoView(ta.id("ANSWERS_TAB"),ta.id("FLOATING_PERSISTENT_TAB_HEADER"))&&ta.servlet.LocationDetail.loadAnswers(),!l&&ta.util.element.isScrolledIntoView(ta.id("INLINE_MENU"),ta.id("FLOATING_PERSISTENT_TAB_HEADER"))&&ta.servlet.LocationDetail.loadMenu(),s&&l&&window.removeEvent("scroll",ta.servlet.LocationDetail.onScroll))}}}(),function(t){var e=function(){var e=1,a=3,n=12,i=23,o=t.id("ABOVE_THE_FOLD");if(o){var r=o.getElement(".above_fold_listing_details .flexible_details"),l=o.getElement(".alsoviewedbar"),s=o.getElement(".highlightsbar")||l,c=o.getElement(".photos_and_highlights"),d=o.getElement(".map"),g=o.getElement(".histograms"),v=o.getElement(".highlight_review"),u=o.getElement(".bubbleHistogram"),E=14;if(c&&g&&v&&u){var f=[[],[]];u.getElements(".ratingRow").each(function(t,e){f[e%2].push(t)});for(var _=0,b=0;b<f.length;b++){for(var h=0,T=0;T<f[b].length;T++){var m=f[b][T],p=m.getElement(".label");h=Math.max(h,t.util.element.getTotalWidth(p)-p.getWidth()+t.util.element.getTotalWidth(p.getElement(".text"))+t.util.element.getTotalWidth(m.getElement(".row")))}_+=h}var w=parseInt(g.getComputedStyle("width")),S=6,A=w-_<=S;u.toggleClass("narrow",A),u.toggleClass("wide",!A)}if(c&&d){var y=t.select(".above_fold_listing_details .detail_section");s&&(s.style.height=""),y.each(function(t){t.style.paddingTop||(t.style.paddingTop=n+"px",t.style.paddingBottom=n+"px")});var L=0;r.getChildren().each(function(t){L+=t.getHeight()});var C=0;l&&s!=l&&(C=l.getHeight()+E);var D=c.getHeight()-r.getPosition(c).y-e;r.style.height=Math.max(D,L)+"px";var I=y.length;if(I>0){var B=L,N=(D-B)%(2*I),O=(D-B-N)/(2*I);y.each(function(t){var e=parseInt(t.style.paddingTop)+O;e=Math.max(Math.min(e,i),n),t.style.paddingTop=e+"px",t.style.paddingBottom=t.style.paddingTop})}if(s&&D<L){var R=o.getElement(".listingbar");R&&s&&(s.style.height=R.getHeight()-s.getPosition(R).y-C-a+"px")}}}};if(!Browser.ie||Browser.version>=8){try{e()}catch(t){}t.queueForReady(function(){e(),window.addEvent("resize",e)},"WINDOW_RESIZE_EVENT")}try{window.addEvent("scroll",t.servlet.LocationDetail.onScroll)}catch(e){t.util.error.record(e,"LocationDetail.onScroll",null,null,"ERROR")}}(ta)});
define("ns-exporter",["vanillajs"],function(r){function n(r){if("undefined"==typeof window)return null;if("undefined"==typeof r&&(r=window),!r)return require.defined("ta/util/Error")&&require("ta/util/Error").record(null,"Using ns-exporter:exportTo without a namespace"),null;if("string"==typeof r){var n=window;n.ta||(ta={}),r.split(".").forEach(function(r){n[r]||(n[r]={}),n=n[r]}),r=n}return r}return{exportTo:function(r,e,t){if(e=n(e),!e)return!1;for(var i in r)!r.hasOwnProperty(i)||t&&i in e||(e[i]=r[i]);return!0},createNs:function(r,e,t){return!!(e=n(e))&&void(e[t]=r)}}});
define("ta/util/Object",["vanillajs","ns-exporter"],function(t,e){var r={};return r.typeOf=function(t){return Object.prototype.toString.call(t).match(/(\w+)\]$/)[1].toLowerCase()},r.merge=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n){t||(t="array"===r.typeOf(n)?[]:{});for(var o in n){var a=n[o];if(n.hasOwnProperty(o)&&"undefined"!==r.typeOf(a)){var i=r.typeOf(a);if("string"===i||"number"===i||"boolean"===i||"function"===i||null===a){t[o]=a;continue}t[o]=r.merge(t[o],a)}}}}return t},e.exportTo(r,"ta.util"),r});
define("ta/Core/TA.Store",["vanillajs","ns-exporter","ta/util/Object"],function(e,r,t){"use strict";var n={},a={};return a.store=function(e,r){return n[e]=r,r},a.retrieve=function(e){return n[e]},a.has=function(e){return"undefined"!=typeof n[e]},a.retrieveOrStore=function(e,r){var t=n[e];return"undefined"==typeof t&&(n[e]=r,t=r),t},a.remove=function(e){var r=n[e];return delete n[e],r},a.keep=function(e,r){var t,n=a.retrieve(e);t=n?n instanceof Array?n:[n]:[],r instanceof Array?r.forEach(function(e){t.contains(e)||t.push(e)}):t.push(r),a.store(e,t)},a.merge=function(e,r){a.store(e,t.merge(a.retrieve(e)||{},r))},a.asInt=function(e,r){var t=parseInt(a.retrieve(e));return isNaN(t)?r||0:t},a.asFloat=function(e,r){var t=parseFloat(a.retrieve(e));return isNaN(t)?r||0:t},a.executeCallbacks=function(e){if(a.has(e)){var r=a.retrieve(e);if(!r instanceof Array)return;for(var t=0;t<r.length;t++)r[t]()}},r.exportTo(a,"ta"),a});
define("purify",["vanillajs"],function(e){function n(e,n){return e?t(e)?(window.IS_DEBUG&&console.error("You're using a jQuery object where you shouldn't. Check the stack trace and fix it!"),n&&e.length>1?e.get():e.get(0)):e.forEach&&(e.length<=1||!n)?e[0]:e:e}function t(e){return!!(e.animate&&e.get&&e.eq&&e.each)}return n});
define("utils/json-to-url",["vanillajs"],function(){"use strict";return function(n){return n?Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}).join("&"):""}});
define("utils/asdf-encoder",["ns-exporter","vanillajs"],function(e){"use strict";var t={};return t.getOffset=function(e){return e>=97&&e<=122?e-61:e>=65&&e<=90?e-55:e>=48&&e<=71?e-48:-1},t.asdf=function(e){for(var t={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],"q":[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],"x":[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],"z":[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]},r="",a=0;a<e.length;a++){var n=e.charAt(a),o=n;t[n]&&a+1<e.length?(a++,o+=e.charAt(a)):n="";var s=getOffset(e.charCodeAt(a));r+=s<0||"String"==typeof t[n][s]?o:t[n][s]}return r},e.exportTo(t),t});
define("utils/urlutils",["vanillajs","utils/asdf-encoder"],function(e,n){"use strict";function t(e,n,t){var o=new RegExp("(-"+n+"([0-9]+))|([?&]"+t+"=([0-9]+))"),r=o.exec(e);if(r){if("undefined"!=typeof r[2])return Number(r[2]);if("undefined"!=typeof r[4])return Number(r[4])}}function o(e){return t(e,"d","detail")||t(e,"g","geo")}function r(e){for(var n={},t=e.split("#")[0].split("?")[1]||"",o=t.split("&"),r=0;r<o.length;r++){var i=o[r].split("=");i[0]&&(n[decodeURIComponent(i[0])]=decodeURIComponent(i[1]))}return n}function i(e){var n=[];for(var t in e)if(e.hasOwnProperty(t)){var o=e[t];if(o&&"object"==typeof o)for(var r=0;o.length&&r<o.length;++r){var i=o[r];i="object"==typeof i?"":String(i),n.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}else n.push(encodeURIComponent(t)+"="+encodeURIComponent(String(o)))}return n.join("&")}function f(e){return location.protocol+"//"+location.hostname+e}function u(e){return e=e||"",e.indexOf("http")===-1&&(e=f(e)),e.replace("http://","https://")}function a(e){var n=d.exec(e);return{protocol:n?n[1]:"",host:n?n[2]:""}}var d=/^([^:]+:)\/\/([^\/\?]+)/,l="undefined"!=typeof window&&window.asdf||("undefined"!=typeof global&&global.asdf?global.asdf:n.asdf);return{asdf:l,getUrlArgNumeric:t,getUrlPageLoc:o,getUrlQueryArgs:r,toQueryString:i,https:u,getParts:a}});
define("ajax-request",["utils/json-to-url","utils/urlutils"],function(t,e){function r(t){var r=document.createElement("a");r.href=t;var s=e.getParts(r.href);return s.protocol!==window.location.protocol||s.host!==window.location.hostname}function s(t,e,s){try{r(t)||e.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(t){}try{var n=s["content-type"]||"application/x-www-form-urlencoded; charset=utf-8";e.setRequestHeader("Content-Type",n)}catch(t){}try{var o=s.accept||"text/html, */*";e.setRequestHeader("Accept",o)}catch(t){}try{var a=s["x-requested-by"];a&&e.setRequestHeader("X-Requested-By",a)}catch(t){}}function n(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){throw new Error("Can't create XMLHttpRequest or similar")}}}}return function(e,r){"object"==typeof e&&(r=e,e=r.url),r=r||{};var o=r.method||r.type||"GET",a="string"==typeof r.data?r.data:t(r.data);return new Promise(function(t,c){var u=n(),i=!1;u.onreadystatechange=function(){i||u.readyState!==XMLHttpRequest.DONE||(i=!0,u.status>=200&&u.status<=299?(r.success&&r.success(this.responseText,this.status,u),t(this.responseText)):u.status>0&&(r.error&&r.error(u,this.status,this.statusText),c(this.responseText)),r.complete&&r.complete(u,this.statusText))},"get"===o.toLowerCase()&&"string"==typeof a&&a.length>0&&(e+=("?"===a[0]?"":"?")+a,a=null),u.open(o,e,!r.synchronous),s(e,u,r),u.send(a)})}});
define("ta/Core/TA.Record",["vanillajs","ns-exporter","ta/Core/TA.Store","purify","ajax-request"],function(e,t,n,r,a){"use strict";var i={},o={},l=[],u=8,c="impressionTrackingTree",s=0,d=1,g=2,f="UserTracking",v="impression",p="action",m="pageview",h="search",k=[],y=60,E=function(e){return"function"==typeof e},T=function(e,t){try{if(!e||"object"!=typeof t)return;if(window.JSON&&JSON.stringify){var n=JSON.stringify(t);n&&n.length<1e5&&(k.push([e,n]),k.length>y&&k.shift())}}catch(e){}},P=function(e,t,n,r){a(e,t).then(n,r),T(e,t)},_=function(){if(require.defined("ta/util/Error")){var e=require("ta/util/Error");e.record.apply(e,arguments)}else ta&&ta.m&&E(ta.m.recordJSError)&&ta.m.recordJSError(arguments)},b=function(e){return"undefined"==typeof e||null==e?"":("string"!=typeof e&&(e=e.toString()),e.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*"))},S=function(e){var t=[];for(var n in e){var r=e[n];t.push(b(n)+"."+b(r))}return t.join("*")},C=function(e){return"undefined"==typeof e||null===e?"":("string"!=typeof e&&(e=e.toString()),e.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*").replace(/\~/g,"!~"))},w=function(e){var t=[];for(var n in e){var r=e[n];t.push(C(n)+"."+C(r))}return t.join("*")},A=function(e){var t=/(https?:\/\/[^\/]+)?\/([^#.?-]*)/,n=t.exec(e);return n&&"undefined"!=typeof n[2]?n[2]?n[2]:"Home":null},N=function(){var e=i.getPageData();if(e&&e.url)return e.url.substring(1);var t=/\/([^-]*)/.exec(window.location.pathname);return t?t[1]:null},R=function(e,t,n){var r=new RegExp("(-"+t+"([0-9]+))|([?&]"+n+"=([0-9]+))"),a=r.exec(e);if(a){if("undefined"!=typeof a[2])return a[2];if("undefined"!=typeof a[4])return a[4]}return null},M=function(e){return R(e,"d","detail")||R(e,"g","geo")},I=function(e){var t=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return!!t&&(t=t[1],0===t.indexOf("%1%")&&(t=t.substring(3)),decodeURIComponent(t))},O=function(e,t,n){try{var r;n.encode&&(t=encodeURIComponent(t)),n.domain&&(t+="; domain="+n.domain),n.path&&(t+="; path="+n.path),n.duration&&(r=new Date,r.setTime(r.getTime()+1e3*n.duration),t+="; expires="+r.toGMTString()),n.secure&&(t+="; secure"),document.cookie=e+"="+t}catch(e){_(e,"_setCookieInSeconds",null,arguments)}},x=function(){return ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")?ta.m.store.get("bookingSessionId"):null},L=function(){var e=!1;return"boolean"==typeof ta.userLoggedIn&&(e="boolean"==typeof ta.userSecurelyLoggedIn?ta.userLoggedIn?ta.userSecurelyLoggedIn?g:d:s:ta.userLoggedIn),e},q=function(e,t){var r={gac:e[1],gaa:e[2],gal:e[3],gav:e[4],gani:e[5],gass:N(),gasl:M(document.location.href),gads:A(t),gadl:M(t),gapu:ta.uid,gams:L()},a=x();if(!r.gass)throw new Error("Src servlet undefined, gac:"+r.gac+", gaa:"+r.gaa+", gal:"+r.gal);if(!r.gads)throw new Error("Dst servlet undefined. gac:"+r.gac+", gaa:"+r.gaa+", gal:"+r.gal);n.has("gatt")&&(r.gatt=n.retrieve("gatt")),a&&(r.bsid=a),O("EVT",S(r),{domain:cookieDomain,duration:5,encode:!0,path:"/"})},D=function(e){if(!e||!e.className||!e.firstChild)return!1;var t=new RegExp("\\b"+c+"\\b"),n=e.firstChild.nodeType,r=e.firstChild.nodeValue;return t.test(e.className)&&n===u&&""!==r},H=function(){};require.defined("page-model")&&require(["page-model"],function(e){var t=e.session,r=t.analyticsInfo;r&&(n.keep("partials.pageProperties",r.pagePropertyStringForCurrentPageview),n.store("gaMemberState",r.memberState),t.analyticsInfo&&require.defined("ta/Core/TA.Prerender")&&require("ta/Core/TA.Prerender")._init(!0)),H=function(){r&&l.push(JSON.parse(r.jsonForCurrentPageview)),H=function(){}}}),i.getPageData=function(){return H(),l[l.length-1]},i.pushPageData=function(e){H(),e&&l.push(e)},i._GARecordRequest=function(e,t){var r,a={gac:e[1],gaa:e[2],gal:e[3],gav:e[4],gani:e[5],gass:N(),gasl:document.location?M(document.location.href):null,gapu:ta.uid,gams:L()},i=x();return t&&(a.gacl=t),n.has("gatt")&&(a.gatt=n.retrieve("gatt")),i&&(a.bsid=i),r=require.defined("utils/BatchRequest")?{get:function(){require("utils/BatchRequest").queue("/GARecord",a)}}:{get:function(){setTimeout(function(){var e=new XMLHttpRequest;e.open("GET","/GARecord?"+U(a),!0),e.send(null)},1)}},T("/GARecord",a),r};var U=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};o.urlArgLookup=function(e,t){var n=new RegExp("[\\?&]"+e+"=(\\w+)"),r=n.exec(t);return r&&"undefined"!=typeof r[1]?r[1]:null},i._validatedTrackEventArray=function(e,t,n,r,a){return e&&"string"!=typeof e&&(e=e.toString()),t&&"string"!=typeof t&&(t=t.toString()),n&&"string"!=typeof n&&(n=n.toString()),r?"number"!=typeof r&&(r=parseFloat(r),isNaN(r)&&(r=0)):r=0,"boolean"!=typeof a&&(a=a===!0),["_trackEvent",e,t,n,r,a]},i._toEvtParams=function(e){try{var t={gac:e.module,gaa:e.action,gal:e.context,gav:e.value,gani:e.noninteraction};return t.gass=N(),t.gasl=M(document.location.href),t.gapu=ta.uid,t.gams=L(),t}catch(t){_(t,"analytics._toEvtParams",null,e)}},i._trackEventAfterAjax=function(e){try{o.trackDMPBehavior(e.module,e.action,e.context,e.value,e.noninteraction)}catch(t){_(t,"analytics._trackEventAfterAjax",null,e)}},o.getEventPathOptions=function(e,t,n){try{var r=F(n,e);if(!r)return void _(null,"ta.getEventPathOptions - invalid element",null,arguments);var a=X(r);return t&&(a.noninteraction=t),a}catch(e){_(e,"ta.getEventPathOptions",null,arguments)}},i._trackEventPathAfterAjax=function(e){try{o.trackEventOnPage(e.category,e.action,e.label,e.value,e.noninteraction)}catch(e){_(e,"analytics._trackEventPathAfterAjax",null,arguments)}},o.trackPhysicalCommerce=function(e,t,n,r){try{var a=i._validatedTrackEventArray(e,"Commerce-Physical",t,n,!1);i._GARecordRequest(a,r).get()}catch(e){_(e,"ta.trackPhysicalCommerce",null,arguments)}},o.trackAttemptedCommerce=function(e,t,n){try{o.trackDMPBehavior(e,t,n,null,null)}catch(e){_(e,"ta.trackAttemptedCommerce",null,arguments)}},o.trackPhysicalAndAttemptedCommerce=function(e,t,n,r,a){o.trackPhysicalCommerce(e,t,r,a),o.trackAttemptedCommerce(e,t,n,r)},o.trackImpressionEventOnPage=function(e,t,n,r){e=e||"",t=t||"",n=n||"",r=r||0,o.trackEventOnPage(e,t,n,r,!0)},o.trackEventOnPage=function(e,t,n,r,a){try{var l=i._validatedTrackEventArray(e,t,n,r,a);i._GARecordRequest(l).get(),o.trackDMPBehavior(e,t,n,r,a)}catch(e){_(e,"ta.trackEventOnPage",null,arguments)}},o.trackEventOnPageOnce=function(e,t,r,a){var i,l="eventsAlreadyTracked";i="object"==typeof ta&&ta.m&&ta.m.store?ta.m.store.get(l):n.retrieve(l),i||(i={},"object"==typeof ta&&ta.m&&ta.m.store?ta.m.store.add(l,i):n.store(l,i));var u=e+"|"+t+"|"+r;i[u]||(o.trackEventOnPage(e,t,r,0,a),i[u]=!0)},o.trackDMPBehavior=function(e,t,n,r,a){try{if(require.defined("ta/common/behavior/dmp/DMP")){var i=require("ta/common/behavior/dmp/DMP");i.isEnabled()&&i.sendGABehavior(e,t,n,r,a)}}catch(e){_(e,"Error adding and sending GARecord behavior to DMP")}},o.setEvtCookie=function(e,t,n,r,a){try{var o=i._validatedTrackEventArray(e,t,n,r,!1);if(q(o,a),require.defined("ta/common/behavior/dmp/DMP")){var l=require("ta/common/behavior/dmp/DMP");l.isEnabled()&&l.sendEventBehavior(e,t,n,r,V())}}catch(e){_(e,"ta.setEvtCookie",null,arguments)}};var j=function(e){var t;try{if(t=I("MEVT")||"",t.length>0&&(t+="~"),t+=w(e),t.length>1024)throw"MEVT Cookie is full";O("MEVT",t,{domain:cookieDomain,duration:5,encode:!0})}catch(e){return _(e,"_appendMevtCookie",null,arguments),!1}return!0},G="trk",B=G.length,J="etk",W=/^([A-Z]{1,2}:)?[A-Za-z_0-9\-\.]+$/,V=function(){var e="undefined"!=typeof event?event:window.event;return e?e.target||e.srcElement:document.activeElement};i.getCommentTrackingPath=function(e,t){return F(e,t)};var F=function(e,t){if(e=r(e),!e&&(e=V(),!e))return _(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments),null;if(1!=e.nodeType)return null;var n=[];if(t&&"string"==typeof t&&""!==t&&W.test(t)){if("P:"==t.substring(0,2))return n.push(t.substring(2)),n;n.push(t)}if("undefined"==typeof e.previousSibling)return _(null,"_getCommentTrackingPath - browser does not support previousSibling",null,arguments),n;e:for(var a=e;a!=document.body;a=a.parentNode){if(null==a){_(null,"_getCommentTrackingPath - LOOP_PARENT_NODES got unexpected null node",null,arguments);break}for(var i=0,o=a.previousSibling;null!=o;o=o.previousSibling)if(o.nodeType==u){var l=o.nodeValue;if(l==J){i++;continue}if(l.substring(0,B)!=G)continue;if(i>0){i--;continue}var c=l.substring(B).split("/");c||_(null,'ta._getCommentTrackingPath - cannot split context class: "'+l+'"',null,arguments);for(var s=c.length-1;s>=0;s--){var d=c[s],g=W.exec(d);if(g){if("P:"==g[1]){var f=g[0].substring(2);n.push(f);break e}n.push(g[0])}else _(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+c[s]+'"',null,arguments)}}}return n},X=function(e){if(0===e.length)return null;var t={action:e[0],label:"",value:"1",category:e[e.length-1]};e.shift();for(var n=e.length-2;n>=0;n--)t.label+=e[n],n>0&&(t.label+="/"),"N:"==e[n].substring(0,2)&&(t.value=e[n].substring(2));return""===t.label&&(t.label="Unknown"),t};o.trk=function(e,t,n,a){n=r(n);try{var i=n?n.getAttribute("data-trk-path"):null;if(i)i=i.replace("P:",""),i=i.split("/"),i.reverse();else if(i=F(n,e),!i||!i.length){var l="";if(n)if(n.outerHTML){var u=document.createTextNode(n.outerHTML),c=document.createElement("div");c.appendChild(u),l=c.innerHTML.substring(0,100)}else n.nodeName?l=n.nodeName:l+=n;else void 0===n?l="undefined":null===n&&(l="null");return e||(e=null===i?"null path":void 0===i?"undefined path":i.hasOwnProperty("length")?0===i.length?"empty path":i.join(","):"path: "+i),void _(null,"ta.trk - invalid element for "+e+" from "+l,null,arguments)}o.trkWithPath(i,t,a)}catch(e){_(e,"ta.trk",null,arguments)}},o.trkWithPath=function(e,t,n){try{if(!e||!e.length)return void _(null,"ta.trkWithPath - no path in arguments",null,arguments);if(n&&n.length>0&&e.length&&e.splice)for(var r=n.length-1;r>=0;r--)"string"==typeof n[r]&&e.splice(1,0,n[r]);var a=X(e);o.trackEventOnPage(a.category,a.action,a.label,a.value,t)}catch(e){_(e,"ta.trkWithPath - "+e,null,arguments)}},o.trkImpTree=function(e){try{if(!D(e))return void _(null,"ta.trkImpTree called with invalid trackTreeElem!",null,arguments);var t=e.firstChild.nodeValue;Y(t)}catch(e){_(e,"ta.trkImpTree",null,arguments)}},o.recordImpression=function(e,t){if(!e)return void(t&&t());try{Y($(e),t)}catch(e){_(e,"ta.recordImpression",null,arguments),t&&t()}};var Z="<!--",z="-->",$=function(e){var t=e.indexOf(Z),n=0,r=e.indexOf(z);return t!==-1&&(n=t+Z.length),r===-1&&(r=e.length),e.substring(n,r)};i.stripCommentsFromTree=$;var K="\\",Q="/";i.appendAscendTokens=function(e){var t=0,n=0,r=0;for(t=0;t<e.length;t++)if(e[t]===Q)r++;else if(e[t]===K)for(n=t+1;n<e.length&&e[n]===K;)r--,t=n,n++;if(r>0)for(t=0;t<r;t++)e+=K;return e};var Y=function(e,t,n){var r={tTreeStr:e&&e.trim(),tTreeUid:ta.uid&&ta.uid.trim(),tTreeLastReferrer:window.location.href,tTreeIsMemberSignedIn:L()};ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")&&(r.bsid=ta.m.store.get("bookingSessionId")),r.tTreeStr?r.tTreeUid||_(new Error("tTreeUid is null/undefined/empty."),"ta._sendTreeImpression",null):_(new Error("tTreeStr is null/undefined/empty."),"ta._sendTreeImpression",null),P("/ImpressionRecord",{method:"POST",url:"/ImpressionRecord",data:r},t,function(){_(new Error("Server did not get tracking tree: "+e,"ta._sendTreeImpression"))})};o.setEvtCookieAndPath=function(e,t,n){try{n||(n=V());var r=F(n,e);if(!r)return void _(null,"ta.setEvtCookieAndPath - invalid element for "+e,null,arguments);var a=X(r);if(!t){for(;"A"!=n.nodeName&&n!=document.body;)n=n.parentNode;if(t=n.href,!t)return void _(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments)}o.setEvtCookie(a.category,a.action,a.label,a.value,t)}catch(e){_(e,"ta.setEvtCookieAndPath",null,arguments)}},o.recordPageview=function(e,t){if(e){var n=A(e),r="/PageviewRecord",a=t?t:{};n&&(a.servletName=n,P(r,{method:"POST",data:a}))}},o.recordTabView=function(e,t,n){if(e&&t){var r=e+"-"+t,a="/PageviewRecord",i=n?n:{};i.servletName=r,P(a,{method:"POST",data:i})}},o.resetPageDataUrl=function(){var e=i.getPageData();e&&(e.url="")},o.trackEngagementClick=function(e,t){return e&&t?E(t)?void t(e):void _(new Error("passed variable selectionFunction is not a function"),"ta.trackEngagementClick",null,t):void _(new Error("object/selectionFunction is null/undefined"),"ta.trackEngagementClick",null,arguments)},o.placementNodeSelectorTracker=function(e){if(!e||!e.element||!e.type)return void _(new Error("object/element/type is null/undefined"),"ta.placementNodeSelectorTracker",null,e);var t,n,r,a,l,u,c=e.element,s=e.type,d=i.getCommentTrackingPath(c);if(s+="_Click",!d)return void _(new Error("trackTreePath is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);if(d.length<1)return void _(new Error("trackTreePath is missing information"),"ta.placementNodeSelectorTracker",null,arguments);if(t=d[d.length-1],!t)return void _(new Error("placement is null/undefined"),"ta.placementNodeSelectorTracker",null,d);for(u=d.length-1;u>=0;u--)if(l=d[u],l&&0===l.indexOf("N:")){n=l;break}if("HH_MainList"===t||"Maps_MetaBlock"===t)n="N:1";else if(!n)return void _(new Error("positionNode is null/undefined"),"ta.placementNodeSelectorTracker",null,d);if(r=n.split(":"),!r||2!==r.length)return void _(new Error("positionSplit appears to be incorrect"),"ta.placementNodeSelectorTracker",null,arguments);if(a=r[1],!a)return void _(new Error("position is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);var g=parseInt(a,10);if(isNaN(g))return void _(new Error("position is not a number"),"ta.placementNodeSelectorTracker",null,a);var f=te(t);if(f!==-1){a=g+f,t=ee(t);var v,p=document.querySelectorAll(".ui_tab_bar .ui_tab.selected");1===p.length&&(p=p[0],v=p.getAttribute("data-currentSort")),o.trackEventOnPage(t,s,v,a)}};var ee=function(e){if(!e)return e;if("Hotels"!==N())return"Clicks_"+e;var t;return"Hotels_MainList"===e||"Hotels_MainList_Sponsored"===e||"Hotels_MainList_Discovery_Sponsored_Listing"===e?t="Clicks_"+e:"hotels_list_short_cells2"===e?t="Clicks_Hotels_MainList":"sponsored_coupon_listing"===e&&(t="Clicks_Hotels_MainList_Sponsored"),document.getElementById("sponsoredCouponListingWrap")&&"Clicks_Hotels_MainList"===t&&(t+="_Sponsored"),t+=ta.widgets.calendar.getCheckRatesData()?"_PostDates":"_PreDates"},te=function(e){if(!e)return _(new Error("placement is null/undefined"),"ta._shiftOrdinalsWithSponsoredPlacement",null,e),-1;if("Hotels"!==N())return 0;var t=0,r=n.retrieve("hac.offset");if(r&&r>0&&(t=r),!document.getElementById("sponsoredCouponListingWrap"))return t;var a,i=document.querySelector("#HAC_RESULTS .pageNumbers .current");if(i){var o=i.getAttribute("data-page-number");if(a=parseInt(o,10),isNaN(a)||!a)return _(new Error("pageNumber is not a number"),"ta._shiftOrdinalsWithSponsoredPlacement",null,o),-1}return"hotels_list_short_cells2"===e||"Hotels_MainList"===e?t+=a:(r&&r>0&&("sponsored_coupon_listing"===e||"Hotels_MainList_Sponsored"===e||"Hotels_MainList_Discovery_Sponsored_Listing"===e)&&(t+=a-1),t)};o.getRecentTARecords=function(){return k},o.addTypeAheadMevt=function(e){return e.t="ta",j(e)},o.addGARecordMevt=function(e,t,r,a,o){try{var l=i._validatedTrackEventArray(e,t,r,a,!1),u={t:"ga",gac:l[1],gaa:l[2],gal:l[3],gav:l[4],gani:l[5],gass:N(),gasl:M(document.location.href),gads:A(o),gadl:M(o),gapu:ta.uid,gams:L()},c=x();if(!u.gass)throw new Error("Src servlet undefined, gac:"+u.gac+", gaa:"+u.gaa+", gal:"+u.gal);if(!u.gads)throw new Error("Dst servlet undefined. gac:"+u.gac+", gaa:"+u.gaa+", gal:"+u.gal);if(n.has("gatt")&&(u.gatt=n.retrieve("gatt")),c&&(u.bsid=c),j(u),require.defined("ta/common/behavior/dmp/DMP")){var s=require("ta/common/behavior/dmp/DMP");s.isEnabled()&&s.sendEventBehavior(e,t,r,a,V())}}catch(e){_(e,"ta.addGARecordMevt",null,arguments)}};var ne=!1,re=function(e,t){return ne||(ne=require.defined("page-model")?require("page-model").session:{}),!!ne.useERUserTracking&&!(ne.ERUserTrackingEventNames&&ne.ERUserTrackingEventNames.length>0&&ne.ERUserTrackingEventNames.indexOf(e)<0)},ae=function(e,t,n){if(re(e,t)){var r={event_name:e,event_type:t,attr:JSON.stringify(n)},a={get:function(){setTimeout(function(){var e=new XMLHttpRequest;e.open("GET","/UserTrackingRecord?"+U(r),!0),e.send(null)},1)}};return a.get()}n.event_name=e,o.trackEventOnPage(f,t,JSON.stringify(n))};o.trackImpressionWithJson=function(e,t){ae(e,v,t)},o.trackActionWithJson=function(e,t){ae(e,p,t)},o.trackPageviewWithJson=function(e,t){ae(e,m,t)},o.trackSearchWithJson=function(e,t){ae(e,h,t)},o.trackUnifiedEvent=ae,t.createNs(i,"ta","analytics"),t.exportTo(o,"ta");var ie={};return t.exportTo(i,ie),t.exportTo(o,ie),ie});
define("utils/ajax",["lib/jquery-amd","ta/Core/TA.Record","utils/form-to-json"],function(e,t,i){function n(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}return function(r,a){r.substr||(a=r);var s=e.extend({},a,{dataFilter:function(e,t){return"json"==t&&(e=e.replace(/^\s*while\s*\([^)]*\);?/,"")),a&&a.dataFilter&&a.dataFilter.call(this,e,t),e}});s.xhrFields=s.xhrFields||{},s.xhrFields.withCredentials=!0,n(s.data)&&(s.data=i(s.data));var c=s.trackEvent;return c&&(e.extend(s,t._toEvtParams(c)),s.complete=function(){t._trackEventAfterAjax(c),a&&a.complete&&a.complete.apply(this,arguments)}),s.evalScripts&&(s.success=function(t,i,n){if(t&&t.substr){var r,s;e.parseHTML?(r=e(e.parseHTML(t,document,!0)),s=r.filter("script").add(r.find("script"))):(r=e("<div>"+t+"</div>"),s=r.find("script")),s.each(function(e,t){if(t.innerHTML)if(window.execScript)window.execScript(t.innerHTML);else if(window.eval)window.eval(t.innerHTML);else{var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.text=t.innerHTML,document.head.appendChild(i),document.head.removeChild(i)}})}a&&a.success&&a.success.apply(this,arguments)}),r.substr?e.ajax(r,s):e.ajax(s)}});
define("ta/util/Cookie",["vanillajs","ns-exporter"],function(e,o){var t=0,n=5e3,i={cookiePIDName:"NPID",ONE_DAY:864e5,ONE_HOUR:36e5,setPIDCookie:function(e){i.write(i.cookiePIDName,e,n,"/",window.cookieDomain)},removePIDCookie:function(){try{i.write(i.cookiePIDName,"",t,"/",window.cookieDomain)}catch(e){}},canSet:function(){return document.cookie="SessionTest=true",!!document.cookie.match("(^|;)\\s*SessionTest=true\\s*(;|$)")&&(document.cookie="SessionTest=; expires=Thu, 01 Jan 1970 00:00:01 GMT",!0)},readRaw:function(e){e=e.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1");var o=document.cookie.match(new RegExp("(?:^|;)\\s*"+e+"=([^;]*)"));return!!o&&o[1]},remove:function(e,o,t){i.write(e,"",new Date(1e3),o,t)},write:function(e,o,t,n,i){"number"==typeof t&&(t=new Date(Date.now()+t)),document.cookie=e+"="+o+(t?"; expires="+t.toUTCString():"")+(n?"; path="+n:"")+(i?"; domain="+i:"")},setOneTimeCookieOnFQDN:function(e,o){return i.write(e,o,5e3),!0},setOneTimeCookie:function(e,o){return i.write(e,o,5e3,null,window.cookieDomain),!0}};return o.exportTo({setPID:i.setPIDCookie}),o.createNs(i,"ta.util","cookie"),i});
define("pages/reviews",["vanillajs","ns-exporter","utils/ajax","ta/util/Cookie"],function(o,i,e,n){var t={};t.checkEmailAction=function(o,i,n,t,c){window.location="mailto:"+o+n+c+"?subject="+t,e("/ActionRecord?excludeFromVS=false&action=BusinessListingsEmail&d="+i)},t.makeCouponLink=function(o,i,e,n,t){window.open(t+i+o+n+"&excludeFromVS=false&odc=BLSpecialOfferUrl&d="+e)},t.onLPAttributionClick=function(){n.setPIDCookie(25174),window.open("http://apps.facebook.com/localpicks")},i.exportTo(t,window)});
function iapToggleSuspiciousReason(){var e=document.getElementById("reasonSelect"),n=[9,18,19,20];for(i=0;i<n.length;i++)document.getElementById("reason"+n[i]+"msg").style.display=e.value==n[i]?"inline":"none";var t=9==e.value||18==e.value||19==e.value||20==e.value?"inline":"none";document.getElementById("reasonExplanation").style.display=t,document.getElementById("iapSubmitButton").style.display=t,document.getElementById("errorMsg").style.display="none"}function closeIAPConfirmBoxInXSeconds(e,n){setTimeout(_closeIAPConfirmBox,n),document.getElementById("ReportIAP_"+e).style.display="none",document.getElementById("ReportIAP_ThankYou_"+e).style.display="inline"}function _closeIAPConfirmBox(){var e=ta.retrieve("overlays.current");e&&e.hide()}function validateExplanation(){window.validateiap_explanationsuspicious=function(e){return e.comment.value?e.comment.value.length>200?(document.getElementById("explanationTooLongErrorMsg").style.display="inline",document.getElementById("errorMsg").style.display="none",!1):(document.getElementById("submitLink").setAttribute("onclick","return false;"),closeIAPConfirmBoxInXSeconds(e.reviewid.value,1e4),!0):(document.getElementById("errorMsg").style.display="inline",document.getElementById("explanationTooLongErrorMsg").style.display="none",!1)},window.validateiap_explanation=function(e){return e.comment.value&&e.comment.value.length>200?(document.getElementById("explanationTooLongErrorMsg").style.display="inline",!1):(document.getElementById("submitLink").setAttribute("onclick","return false;"),closeIAPConfirmBoxInXSeconds(e.reviewid.value,1e4),!0)},window.validateiap_explanation_owner_response=function(e){if(e.comment.value&&e.comment.value.length>200)return document.getElementById("explanationTooLongErrorMsgOwnerResponse").style.display="inline",!1;var n=ta.retrieve("iapFlyout");n&&n.hide(),setTimeout(_closeIAPConfirmBox,1e4);try{document.getElementById("ReportIAP_OR_"+e.reviewid.value).style.display="none",document.getElementById("ReportIAP_OR_ThankYou_"+e.reviewid.value).style.display="inline"}catch(e){}return!0}}function setUpFootprint(e,n){try{var t=TALSO.get("CookieId");""==t&&(TALSO.set("CookieId",n),t=TALSO.get("CookieId")),""==t||e.href.contains("footprint")||(e.href=e.href+"&fp="+t)}catch(e){document.getElementById("LsoId")&&(document.getElementById("LsoId").value="")}return!0}
!function(window){function _postInjektCall(){if(ta.has("reviews.ajax.post")){var e,r=ta.remove("reviews.ajax.post");for(e=0;e<r.length;e++)r[e]()}}function _callBeforePIC(e){var r=function(){var r=e.apply(this,arguments);return _postInjektCall(),r};return r}function _callAjaxFunByType(e,r){if(null==r)return void ta.util.error.ajaxFailure.partial("reviews:_callAjaxFunByType - null stype");var i=r.split(":");return 3==i.length?showReviewBlock(e,i[0],i[1],i[2]):void("reviewWithAnswers"==r||"reviewWithAnswersTrans"==r?_showReviewWithAnswers(e,"16",r):showReview(e,r))}function _fixMTHelpfulUrl2(e,r){var i=ta.id(e);if(null!=i){var n=i.getElement("input[name=returnTo]");if(n){var t=document.location.href;t.indexOf("#")>=0&&(t=t.substring(0,t.indexOf("#"))),n.value=t+"#mtreview_"+r}}}function _alignFirstReview(e,r){try{if(e.hasClass("first_aph"))e.removeClass("first_aph");else{var i=r.getElementsByClassName("inlineReviewUpdate");if(i&&i.length>0){var n=i[0];n.hasClass("first")&&n.removeClass("first")}}}catch(e){}}function _getAllElementsById(e,r){var i=new Array,n=document.getElementById(e);if(n){if(i.push(n),r.hasOwnProperty(e)){var t=n.id;n.id=n.id+"_NN";var a=document.getElementById(e);a&&i.push(a),n.id=t}}else ta.util.error.ajaxFailure.partial("reviews:_rpcParseReviewsBlock - element not found "+e);return i}function _rpcParseReviewsBlock(e){function r(){var e={};if(ta.has(NONNATIVE_DUP_LIST)){var r=ta.retrieve(NONNATIVE_DUP_LIST);for(var i in r)r[i]>1&&(e["review_"+i]=r[i])}return e}try{var i=document.createElement("div");i.innerHTML=e;for(var n=new Array,t=0;t<i.childNodes.length;t++){var a=i.childNodes[t];null!=a&&null!=a.id&&0==a.id.indexOf("review_")&&n.push(a)}0==n.length&&i.getElements("li").each(function(e){null!=e.id&&0==e.id.indexOf("review_")&&n.push(e)});for(var s=!1,l=r(),t=0;t<n.length;t++){var a=n[t],o=a.id,v=o.split("_");2==v.length&&isFinite(v[1])&&_fixMTHelpfulUrl2(a,v[1]),_getAllElementsById(a.id,l).each(function(e){s||(_alignFirstReview(e,a),s=!0),e.innerHTML=a.innerHTML})}}catch(e){ta.util.error.record(e,"_rpcParseReviewsBlock")}}function _updateResponseText(e,r){if(r&&""!=r){var i=document.getElementById("response_"+e);i&&(i.innerHTML=r)}}function _rpcParseReviews(reply){try{var reviews=eval("("+reply+")");if(reviews)for(var reviewCnt=reviews.length,i=0;i<reviewCnt;++i){var rid=reviews[i].id,r=ta.id("review_text_"+rid);if(r){r.set("html",reviews[i].body);var reviewTitle=ta.id("rn"+rid);reviewTitle||(reviewTitle=ta.id("r"+rid)),reviewTitle&&reviewTitle.set("html",reviews[i].title);var disclaimerTxt=reviews[i].disclaimer;""!=disclaimerTxt&&(elm=document.getElementById("disclaimer_"+rid+"_more"),elm&&(elm.innerHTML="<br />"+disclaimerTxt)),_updateResponseText(rid,reviews[i].response)}}}catch(e){ta.util.error.record(e,"rpcParseReviews",null,{"reviewCnt":reviewCnt})}}function _rpcParseReviewWithAnswers(reply){for(var reviewAnswers=eval("("+reply+")"),reviewAnswerCnt=reviewAnswers.length,i=0;i<reviewAnswerCnt;++i){var typeId=reviewAnswers[i].typeid;if(0==typeId){var rid=reviewAnswers[i].id,elm=document.getElementById("review_text_"+rid);elm.innerHTML=reviewAnswers[i].body;var disclaimerTxt=reviewAnswers[i].disclaimer;""!=disclaimerTxt&&(elm=document.getElementById("disclaimer_"+rid+"_more"),elm.innerHTML="<br />"+disclaimerTxt);var name=document.getElementById("review_quote_"+rid);name&&"undefined"!=typeof reviewAnswers[i].name&&reviewAnswers[i].name&&(name.innerHTML="&#x201c;"+reviewAnswers[i].name+"&#x201d;"),_updateResponseText(rid,reviewAnswers[i].response)}else{var rid=reviewAnswers[i].reviewid,qid=reviewAnswers[i].questionid,elm=document.getElementById("review_"+rid+"_answer_"+qid);elm.innerHTML=reviewAnswers[i].answer}}}function _showReviewWithAnswers(e,r,i){new Request({url:"/UserReviewController?a="+i+"&r="+e+"&n="+r,onSuccess:_callBeforePIC(_rpcParseReviewWithAnswers),onFailure:_callBeforePIC(function(e){408!==e.status&&ta.util.error.ajaxFailure("reviews:showReviewWithAnswers",e)})}).get()}function _showAffiliateProviderName(reply){var result=eval("("+reply+")"),providerDiv=ta.id("affilProvider");providerDiv.innerHTML=result.provider}var DELAYED_INJECT_LIST="reviews.delayed_inj",NONNATIVE_INJECT_LIST="reviews.nonnative_inj",NONNATIVE_DUP_LIST="reviews.nonnative_dup";window.initInjektReviewsContent=function(){var e={};ta.store(NONNATIVE_INJECT_LIST,e);var r={};ta.store(NONNATIVE_DUP_LIST,r);var i={};ta.store(DELAYED_INJECT_LIST,i)},window.injShowReview=function(e,r){if(!ta.has(NONNATIVE_INJECT_LIST))return void _callAjaxFunByType(e,r);var i=ta.retrieve(NONNATIVE_INJECT_LIST);if(i.hasOwnProperty(r)){var n=i[r]+":"+e;i[r]=n}else i[r]=e},window.injShowReviewBlock=function(e,r,i,n,t){function a(e){if(null!=e&&ta.has(NONNATIVE_DUP_LIST)&&"string"==typeof e){var r=e.split("-")[0],i=ta.retrieve(NONNATIVE_DUP_LIST);i.hasOwnProperty(r)?i[r]=i[r]+1:i[r]=1}}ta.has(NONNATIVE_INJECT_LIST)||initInjektReviewsContent();var s=ta.retrieve(NONNATIVE_INJECT_LIST),l=r+":"+i+":"+n;if(a(e),s.hasOwnProperty(l)){var o=s[l]+":"+e;s[l]=o}else s[l]=e},window.injektReviewsContent=function(){if(ta.has(NONNATIVE_INJECT_LIST)){var e=!1,r=ta.retrieve(NONNATIVE_INJECT_LIST);for(var i in r)_callAjaxFunByType(r[i],i),e=!0;e||_postInjektCall(),ta.remove(NONNATIVE_INJECT_LIST)}},window.injectExternalProviderMemberNames=function(e,r,i,n){(e||i)&&r&&(reviewDiv=$(n).querySelector("#nonTAReviewer_"+e),reviewDiv.innerHTML=r)},window.getAffiliateProviderName=function(e){new Request({url:"/UserReviewController?a=affiliateStr&pr="+e,onSuccess:_callBeforePIC(function(e){_showAffiliateProviderName(e)}),onFailure:_callBeforePIC(function(){ta.util.error.ajaxFailure("reviews:getAffiliateProviderName")})}).get()},window.showReviewBlock=function(e,r,i,n,t){var a="/UserReviewController?a="+r+"&r="+e+"&type="+i+"&tr="+n+"&n=16";"undefined"!=typeof t&&t&&(a+="&l="+t.toString()),"undefined"!=typeof modelLocId&&modelLocId&&(a+="&d="+modelLocId),new Request({url:a,onSuccess:_callBeforePIC(_rpcParseReviewsBlock),onFailure:function(){var e=new Request({url:a,onSuccess:_callBeforePIC(function(e){_rpcParseReviewsBlock(e)}),onFailure:_callBeforePIC(ta.util.error.ajaxFailure.partial("reviews:showReview - second fail"))});e.get.delay(1e3,e)}}).get()},window.showReview=function(e,r,i){var n="/UserReviewController?a="+r+"&r="+e;new Request({url:n,onSuccess:i?i:_callBeforePIC(_rpcParseReviews),onFailure:function(){var e=new Request({url:n,onSuccess:i?i:_callBeforePIC(function(e){_rpcParseReviews(e)}),onFailure:i?i:_callBeforePIC(ta.util.error.ajaxFailure.partial("reviews:showReview - second fail"))});e.get.delay(1e3,e)}}).get()},window.expandDupReviewItems=function(e,r){document.getElementById(e).style.display="block",document.getElementById(r).style.display="none"}}(window);
define("amdloaders",["utils/to-array"],function(e){var t=[],n=[],r=[],o=[],d=[],u=null,a=null,i={},s={},c={},l={},f=null,p=!1,h=!1,m={},v=function(e,t,r){i[e]||(i[e]=!0,n.push(e)),d.push(function(n){n||!t.parsed||t.parsed(e)||(n=new Error("Dynamic load failed to define module '"+e+"'")),n&&r.error&&r.error(n)}),L()},g=function(e,t,r){i[e]||(i[e]=!0,s[e]||t.specified(e)||n.push(e)),d.push(function(n){var o=t.parsed(e);n||s[e]||o||(n=new Error("Dynamic load failed to define '"+e+"'")),n?r.error&&r.error(n):o||define(e,[],H(!0))}),t([e],r,r.error),L()},w=function(e,n,r){t.push(e),d.push(function(e){e?r.error&&r.error(e):r(!0)}),L()},y=function(e,t,n){r.push(e),d.push(function(r){r||t.specified("trhtml!"+e)||(r=new Error("Dynamic load failed to define content '"+e+"'")),r&&n.error&&n.error(r)}),L()},C=function(e,t,n){c[e]||(c[e]=!0,l[e]||o.push(e)),d.push(function(e){e?n.error&&n.error(e):n(!0)}),L()},C=function(e,t,n){c[e]||(c[e]=!0,l[e]||o.push(e)),d.push(function(e){e?n.error&&n.error(e):n(!0)}),L()},L=function(){!f&&p&&!h&&(d.length||t.length||n.length||r.length||o.length)&&(f=setTimeout(T,0))},S=function(e,t){var n=e.getAttribute("data-rup");if(n){var r;n=n.split(",");for(var o=0;o<n.length;o++)r=n[o].trim(),r&&t(r)}},R=m.getJSRollupsLoaded=function(){var t=a||e(document.getElementsByTagName("SCRIPT")).reduce(function(e,t){return t.hasAttribute("data-is-dust")||S(t,function(t){e.dedup[t]||(e.rups.push(t),i[t]=s[t]=e.dedup[t]=!0)}),e},{rups:[],dedup:{}}).rups;return!a&&p&&(a=t),t},E=m.getCSSRollupsLoaded=function(){var t=u||(document.head?e(document.head.querySelectorAll("LINK, STYLE")).reduce(function(e,t){return S(t,function(t){e.dedup[t]||(e.rups.push(t),e.dedup[t]=!0)}),e},{rups:[],dedup:{}}).rups:[]);return!u&&p&&(u=t),t},A=m.getLoadedFilesParams=function(){return{haveJses:String(R()),haveCsses:String(E())}},T=function(){if(f=null,p&&!h){var e=t,u=d,a=r,i=o,c=A(),l=n.filter(function(e){return e&&!s[e]&&!require.parsed(e)});if(d=[],t=[],n=[],r=[],o=[],!(l.length||e.length||a.length||i.length))return void I(u);var m="haveJses="+encodeURIComponent(c.haveJses)+"&haveCsses="+encodeURIComponent(c.haveCsses)+"&needJses="+encodeURIComponent(String(l||""))+"&needCsses="+encodeURIComponent(String(e||""))+"&needDusts="+encodeURIComponent(String(i||""));a.length>0&&(m+="&needContent="+encodeURIComponent(String(a))),window.pageServlet&&(m+="&metaReferer="+encodeURIComponent(window.pageServlet));var v=null;try{v=new XMLHttpRequest}catch(e){try{v=new ActiveXObject("MSXML2.XMLHTTP")}catch(e){try{v=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Can't create XMLHttpRequest or similar")}}}var g=!1;v.onreadystatechange=function(){g||4!==v.readyState||(g=!0,v.status>=200&&v.status<=299?q(u,v.responseText):I(u,new Error("XHR returned "+v.status)))},v.open("POST","/DemandLoadAjax",!0);try{v.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(e){}try{v.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(e){}try{v.setRequestHeader("Accept","text/html, */*")}catch(e){}h=!0,v.send(m)}},I=function(e,t){if(h=!1,L(),e.length)for(var n=0;n<e.length;++n)try{e[n](t)}catch(e){window.IS_DEBUG&&console.error&&console.error("Error in async callback: ",e)}},b=m.installStyles=function(e){document.head.appendChild(e.reduce(function(e,t){return S(t,function(e){u.push(e),define("trcss!"+e,[],H(void 0))}),e.appendChild(t),e},document.createDocumentFragment()))},D=m.installScripts=function(e){return Promise.all(e.map(function(e){return S(e,function(t){e.hasAttribute("data-is-dust")?l[t]=!0:(a&&a.push(t),s[t]=!0)}),new Promise(function(t){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("data-rup",e.getAttribute("data-rup")),e.src?(n.src=e.src,n.async=!0,n.onload=n.onerror=t,document.head.appendChild(n)):e.text&&(n.text=e.text,document.head.appendChild(n),document.head.removeChild(n),t())})}))},q=function(t,n){if(!n||!n.substr)return void I(t,new Error("no data returned from /DemandLoadAjax"));var r,o=Promise.resolve();try{var d=document.createElement("DIV");d.innerHTML=n,b(e(d.querySelectorAll("STYLE, LINK"))),o=D(e(d.getElementsByTagName("SCRIPT")));for(var u,a;u=d.firstChild;)d.removeChild(u),1===u.nodeType&&(a=u.getAttribute("data-content"),a&&define("trhtml!"+a,[],H(u)))}catch(e){r=e}o.then(I.bind(null,t,r))},H=function(e){return function(){return e}},M=m.activate=function(){p||(p=!0,define.depLoader&&!define.depLoader.isDefault||(define.depLoader=v),L())};return define("trjs",[],function(){return{load:g}}),define("trcss",[],function(){return{load:w}}),define("trhtml",[],function(){return{load:y}}),define("trdust",[],function(){return{load:C}}),"undefined"!=typeof window&&(document.addEventListener&&!window.taRollupsAreAsync&&document.addEventListener("DOMContentLoaded",M,!1),window.addEventListener?window.addEventListener("load",M,!1):window.attachEvent&&window.attachEvent("onload",M)),m});
define("common/trackingStreams",["vanillajs","amdloaders"],function(){function l(l,e,t){if(e=Array.prototype.slice.call(e),l.handler)try{l.handler.apply(null,e),t()}catch(l){}else if(l.list){l.list.length>=l.limit&&(l.list=l.list.slice(0,l.list.length-1),l.callbacks=l.callbacks.slice(0,l.callbacks.length-1)),l.list.unshift(e),l.callbacks.unshift(t);var r=l.handlerModule;r&&l.handlerMethod&&(l.handlerModule=null,require([r],function(e){n(l,e[l.handlerMethod],0)}))}}function e(l,e){if(e=Array.prototype.slice.call(e),l.handler)try{l.handler.apply(null,e)}catch(l){}else if(l.list&&l.list.length<l.limit&&(l.list.push(e),l.handlerModule&&l.handlerMethod)){var t=l.handlerModule;l.handlerModule=null,require([t],function(e){n(l,e[l.handlerMethod],0)})}}function n(l,n,t){if(t=t||0,l.handler&&l.priority>=t)return!1;l.handler=n,l.priority=t;var a=l.list;l.list=null;for(var i=0;i<a.length;++i)try{n.apply(null,a[i]),l.callbacks&&l.callbacks[i]&&l.callbacks[i]()}catch(n){l!==r&&e(r,[n,l.name+" dispatch error"])}}var t="trjs!ta/Core/TA.Record",r={name:"errorQ",limit:3,handler:null,handlerModule:"trjs!ta/util/Error",handlerMethod:"record",list:[]},a={name:"GARecordQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackEventOnPage",list:[]},i={name:"GARecordOnPageOnceQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackEventOnPageOnce",list:[]},d={name:"SetCookieQ",limit:100,handler:null,handlerModule:"trjs!ta/Core/TA.Record",handlerMethod:"setEvtCookie",list:[]},o={name:"UnifiedUserTrackingQ",limit:100,handler:null,handlerModule:t,handlerMethod:"trackUnifiedEvent",list:[]},c={name:"redirectCallback",limit:1,handler:null,handlerModule:t,handlerMethod:"setEvtCookie",list:[],callbacks:[]};return{error:function(){e(r,arguments)},setErrorHandler:function(l,e){n(r,l,e)},trackEvent:function(){e(a,arguments)},trackEventOnPageOnce:function(){e(i,arguments)},setTrackEventHandler:function(l,e){n(a,l,e)},setEvtCookie:function(){e(d,arguments)},trackUnifiedEvent:function(l,n,t){e(o,arguments)},redirectWithEvt:function(){var e=Array.prototype.slice.call(arguments);e.length>0&&"function"==typeof e[0]&&l(c,e.slice(1),e[0])}}});
define("ta/Core/TA.FireEvent",["vanillajs"],function(){var n={},e={};return n.on=function(n,t){var r=e[n];r||(r=e[n]=[]),r.push(t)},n.fireEvent=function(n,t){var r=Array.prototype.slice.call(arguments),i=e[n];r.shift(),i&&i.slice(0).forEach(function(n){try{n.apply(null,r)}catch(n){}})},n.off=function(n,t){if(t){var r,i=e[n];i instanceof Array&&(r=i.indexOf(t),r>=0&&i.splice(r,1))}else delete e[n]},n.hasEventListener=function(n){return!!e[n]},n});
define("ta/Core/TA.Event",["vanillajs","common/trackingStreams","ns-exporter","ta/Core/TA.FireEvent"],function(vanilla,tracks,nsExporter,fireEvent){function _makeClosure(e,t){var n=this;return t=Array.prototype.slice.call(t),function(){e.apply(n,t)}}function QueueTimer(e,t){var n=0,r=0,o=[],a=0,u=!1;this.start=function(){n&&clearTimeout(n),a=Date.now()},this.end=function(i){var c=Date.now(),f=c-a;r+=f;var l=""+f+"ms ["+(i||"")+"]",s=e+(t?"-after":"");u?console.error("Straggler for "+s+": "+l):(o.push(l),n=setTimeout(function(){console.error("Timing for "+s+": "+r+"ms\n"+o.sort(function(e,t){return parseInt(e)-parseInt(t)}).join("\n")),u=!0},2e3))}}var exports={on:fireEvent.on,off:fireEvent.off,fireEvent:fireEvent.fireEvent,hasEventListener:fireEvent.hasEventListener};exports.call=function(e,t,n,r){if(null==t)return IS_DEBUG&&alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);"),!1;if(null==e)return IS_DEBUG&&alert("ta.call of undefined function"),!1;var o=e;if("function"==typeof e)e="<func>";else if(!/^ta\.[\w\d\.]+$/.test(e))return IS_DEBUG&&alert("Invalid function name. Must be of the form: ta.namespace.Class.function"),!1;var a=t||window.event;["stopPropagation","preventDefault"].forEach(function(e){a[e]||(a[e]=function(){})}),a.stop||(a.stop=function(){a.preventDefault(),a.stopPropagation()}),n||(n=a.target||a.srcElement),n||tracks.error(null,"ta.call re-wrap fail (non-DOM element) - "+e,t,{"funcName":e});var u=arguments,i=Array.prototype.slice.call(u,3);i.splice(0,0,a,n);try{return i.unshift({callback:_ta_call_defer,evt:a}),i.unshift(o),exports.run.apply(null,i)}catch(n){tracks.error(n,"ta.call - "+e,t)}return!1};var _ta_call_defer=function(e,t){t&&delete t.evt,exports.run.apply(null,arguments)};exports.run=function(e,t){var n=arguments,r=Array.prototype.slice.call(n,2);try{var o=exports.fn(e);if("function"==typeof o){var a=o.apply(window,Array.prototype.slice.call(r));if(t&&t.onComplete){var u=exports.fn(t.onComplete);u&&u(a)}return a}t&&t.evt&&(t.evt.stopPropagation?t.evt.stopPropagation():t.evt.cancelBubble=!0,t.evt.preventDefault?t.evt.preventDefault():t.evt.returnValue=!1);var i=_makeClosure(t&&t.callback||exports.run,arguments);require(["trjs!ta/Core/TA.Load"],function(t){try{t.load(e,i)}catch(t){tracks.error(t,"ta.run - "+e)}})}catch(t){tracks.error(t,"ta.run - "+e)}return!1};var OneTimeFunctionQueue=function(e,t,n){function r(){u=!0,c()}var o,a=[],u=!!n,i=function(n,r){o&&o.start();try{n()}catch(n){try{tracks.error(n,"OneTimeFunctionQueue "+e+(t?"-after":"")+(r?"-"+r:""))}catch(e){}}o&&o.end(r)},c=function(){if(a.sort(function(e,t){return e.priority-t.priority||e.subpriority-t.subpriority}),t){var e=1;a.forEach(function(t){setTimeout(i.bind(null,t.func,t.name),e++)})}else a.forEach(function(e){i(e.func,e.name)});a=[]};null!=e&&(window.addEventListener?window.addEventListener(e,r,!1):window.attachEvent&&("DOMContentLoaded"==e?window.attachEvent("onload",r):"load"==e?window.attachEvent("on"+e,function(){setTimeout(r,1)}):window.attachEvent("on"+e,r))),this.addToQueue=function(t,n,r){return t?("string"==typeof n&&(r=n,n=!1),void(u?i(t,r):(n=n||100+a.length,a.push({func:t,priority:n,name:r,subpriority:a.length})))):void tracks.error(null,"addToQueue for "+e+" queue - no function")},this.executeQueue=function(){c()}},loaded="undefined"!=typeof document&&"complete"===document.readyState,ready="undefined"!=typeof document&&"interactive"===document.readyState||loaded,_readyQ=new OneTimeFunctionQueue("DOMContentLoaded",!1,ready),_loadQ=new OneTimeFunctionQueue("load",!1,loaded),_afterLoadQ=new OneTimeFunctionQueue("load",!0);ready||_loadQ.addToQueue(function(){_readyQ.executeQueue()},-999999999,"checkReadyQueue"),_loadQ.addToQueue(function(){_afterLoadQ.executeQueue()},999999999,"afterLoadQueue"),exports.queueForReady=function(e,t,n){_readyQ.addToQueue(e,t,n)},exports.queueForLoad=function(e,t,n){_loadQ.addToQueue(e,t,n)},exports.queueForAfterLoad=function(e,t){_afterLoadQ.addToQueue(e,0,t)},exports.fn=function(fn){switch(typeof fn){case"function":return fn;case"string":var f=!1;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join(".")),f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&"function"==typeof f)return f}return null},exports.fireClick=function(e){if(document.createEvent){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1),e.dispatchEvent(t)}else document.createEventObject?e.fireEvent("onclick"):"function"==typeof e.onclick&&e.onclick()},exports.throttle=function(e,t,n,r){function o(){delete m_throttles[t],a.cb()}var a,u=(new Date).getTime();if(t in m_throttles){if(a=m_throttles[t],u-a.lastReset<a.minResolution)return void(a.cb=e)}else a=m_throttles[t]={start:u,minResolution:Math.max(Math.floor(n/10),50)};a.cb=e,a.timeout&&clearTimeout(a.timeout),r&&u-a.start>r?o():(a.lastReset=u,a.timeout=setTimeout(o,n))};var m_throttles={};return nsExporter.exportTo(exports,ta),exports});
define("ta/util/Error",["vanillajs","api-mod","utils/ajax","ns-exporter","mixins/Events","utils/browserutils","ta/util/Cookie","ta"],function(r,e,t,o,n,a,i,c){function s(r,t){var o="_extraInfoError_:Problem storing extra info.",n={},a="";try{if(Array.isArray(t)||"[object Arguments]"===Object.prototype.toString.call(t)){for(var i={},c=0;c<t.length;c++){var s=t[c],l=typeof s;"string"===l||"number"===l||"boolean"===l?i[c]=s:i[c]=l}t=i}e.merge(n,r,t)}catch(e){n=r}try{if(a=JSON.stringify(n))return a.length>y&&(a=a.substring(0,y)),a.replace(/[\r\n]/g,"")}catch(r){}return o}function l(r){return"undefined"!=typeof r&&null!==r?r.toString().replace(/[\r\n]/g,""):"null or undefined"}function u(r,e,t){var o,n="";if(r&&r.stack)try{var a,i,c=r.stack.split("\n"),s=[],l=0;c[1]&&c[1].match(/\.record /)&&c.splice(1,1);for(var u=0;u<c.length;u++){var f=c[u];if(!(f.indexOf(r.message)>=0)){var d=!!f.match(/\/jquery-|\/mootools|\(native\)|\(native code\)|\[native code]/);f=f.replace(/^(.*)http.+\/([^\/]*)/,"$1$2").replace(/(\?.{20})[^:)]+/,"$1...").replace(/^(?:\s+\w+\s*([^\s]+)|([^\s]+)@)\s*\(?([^)]*)\)?$/,"$1$2 ($3)").replace(/\s*\(\)/,""),a&&d?i||(s.push("..."),i=!0,l++):(s.push(f),d&&l++),d||(i=!1),a=d}}s.length-l<=w&&(o=!0),n=s.join()}catch(r){h&&(console.error("Debug: error.stack handler failed "),console.error(r))}if(!n&&t)try{for(var g=[],m=t.caller,v=0;m&&v++<20;){var p=m.toString(),y=p.replace(/^function\s+([^(\s]+).*/,"$1")||"anonymous";if(!y.match(/onErrorFunc|_getErrorStack/)){var E=Math.min(p.length,100),R=p.substring(0,E).replace(/(\n|\r|\'|\")/g," ");g.push(R)}m=m.caller}g.length<5&&(o=!0),n=g.join(" :: ")}catch(r){h&&console.error("Debug: exception getting callee stack "+r)}if(!n&&r&&r.filename&&(n=r.filename.replace(/^.*\/([^\/]+)$/,"$1"),r.lineno&&(n+=":"+r.lineno),r.colno&&(n+=":"+r.colno)),e&&o){var b=S.getSelectorString(e);b&&(n&&(n+=", "),n+="DOM_STACK: "+b)}return n?n:"failed to get stack"}function f(){var r=[];return[].forEach.call(document.getElementsByTagName("script"),function(e){var t=e.src;d(t)&&r.push(t.substring(t.indexOf("/js")+1))}),r.join(", ").substring(0,y)}function d(r){if(!r||!r.indexOf)return!1;var e=window.CDNHOST||"";return h&&""==e?null!=r.match(/(js3\/|js\/)/):0==r.indexOf(e)}function g(r){if(!r||!r.indexOf)return!1;var e="noPage";try{e=window.location.href}catch(r){}return r===e}function m(){var r=(a.Platform.ios||a.Platform.android)&&!window.isTabletOnFullSite,e=document.cookie.indexOf("TAmobilemode=main")>=0;return r&&!e}function v(r){if(m()){var e={eMsg:"msg",eStak:"stack",eUrl:"url"};for(var t in e){var o=e[t];r[o]=r[t]}r.file=r.url||document.URL,r.site=window.SITE_VERSION,r.loaded=O?"dom_ready":"not_loaded"}}var S={},p=new n("error","beforeSend"),h=window.IS_DEBUG,y=3e3,E=h?100:10,w=4,R="unset",b=0,O=!1;return S.record=function(r,e,o,n,a,y){y=y||{},r?"string"==typeof r&&(r=new Error(r)):r=new Error("Stub error to build stack.");var w=!1;try{var O=Object.prototype.toString.call(r);w=O===Object.prototype.toString.call(new Error)||O.match(/\[object Error[\w]*]/)}catch(r){}if(w&&!r.stack)try{throw r}catch(e){e&&e.stack&&(r=e)}o=o||window.event||{};var N=o.target;if(b>=E)return void(h&&console.error("Maximum JS errors reached. Not reporting."));b++;var _=!1;try{_=document.body.className.match(/\bjs_logging\b/)||m()}catch(r){}if(_){var j=!0;n&&n.hasOwnProperty("error_script")&&!d(n.error_script)&&!g(n.error_script)&&(j=!1);var k={};if(N)try{k.eTarg=S.getSelectorString(N)}catch(r){}"undefined"!=typeof debugCacheKey&&(k.key=debugCacheKey);var T=window.pageServlet;T||(T="unknown"),k.servlet=T,a&&"string"==typeof a||(a="ERROR"),j?!IS_DEBUG&&b>1&&(a="WARN",k.warnReason="notFirstJSError"):(a="WARN",k.warnReason="externalError");var x={"extraInfoError":"Problem storing extra info"},A={};try{var D="",I="";N&&("function"!=typeof N.id&&(D=N.id),I=N.className);var L=window.serverPool||"",P="";window.MooTools&&(P+="MooTools "),require.defined("lib/jquery-amd")&&(P+="jQuery "),A={"TARGET_ID":D,"TARGET_CLASS":I,"PAGE_UID":c&&c.uid,"INTERNAL_JS":f(),"CLIENT_POOL":L,"COOKIES_ENABLED":i.canSet(),"JS_LIBS":P},j||(A.INTERNAL_ERROR="false"),b>1&&(A.PRIOR_JS_PAGE_ERRORS=b-1)}catch(r){n=x}k.xInfo=s(A,n);try{k.eUrl=window.location.href}catch(r){}try{var J=c.page.getDates("STAYDATES");J?k.eDates=J[0].toLocaleDateString("en-US")+" - "+J[1].toLocaleDateString("en-US"):k.eDates="No dates set"}catch(r){}var $="No Error";try{if(w)$=r.name+"-"+r.message;else if("object"==typeof r)if(r.name&&r.message)$=r.name+"-"+r.message;else{$="non-Error object "+Object.prototype.toString.call(r)+" passed, sample properties - ";var M=0;for(var U in r)if(r.hasOwnProperty(U)&&($+=U.substring(0,30)+": "+(r[U]&&r[U].toString?r[U].toString().substring(0,20):r[U])+", ",++M>4))break}else $="non-Object error passed: "+(""+r).substring(0,60);$=$.replace(/[\r\n]/g,"")}catch(r){}k.eMsg=$;try{k.eBlk=l(e).substring(0,150)}catch(r){}var C;if(!r.stack)try{C=o&&o.callee||arguments&&arguments.callee}catch(r){}var B=u(r,N,C);B&&(k.eStak=B);try{p.emit("beforeSend",k)}catch(r){}k.eLogLevel=a,v(k),h&&!y.isglobal&&(console.error("/JSErrorRecord:"),r.stack?console.error(r.stack):B?console.error(B):console.error("No stack"));try{t({url:"/JSErrorRecord",data:k,method:"POST",type:"POST"})}catch(r){k={"eBlk":"JSErrorRecord Error","servlet":T,"eLogLevel":"ERROR","eMsg":"no error retrieved"},t({url:"/JSErrorRecord",data:k})}if(h&&(window.ERRORS||(window.ERRORS=[])).push(k),p.emit("error",$,e,a,k.eStak),"unset"==R&&(R=i.readRaw("JS_ERROR_HANDLING")),R){if(R.match(/alert/)){var G="";for(var F in k)k.hasOwnProperty(F)&&(G=G+F+": "+k[F]+"\n");alert(G)}R.match(/console/)&&window.console&&console.error(k)}}},S.getSelectorString=function(r){for(var e=[];r&&"HTML"!=r.tagName&&r!=document;r=r.parentNode){var t=r.tagName;r.id&&(t+="#"+r.id),r.className&&(t+="."+r.className.trim().replace(/\s+/g,".")),e.unshift(t)}return e.join(">")},S.ajaxFailure=function(r,t,o,n){S.record(null,r,null,e.merge({status:t.status},o),n||"ERROR")},S.enableDomReadyParam=function(){O=!0},S.on=p.on.bind(p),S.off=p.off.bind(p),(a.firefox&&a.version<5||a.ie&&a.version<8)&&(S.record=function(){window.console&&console.error("Unreported error: "+[].slice.call(arguments).join(", "))}),o.createNs(S,"ta.util","error"),S});
define("ta/common/behavior/ScrollAd",["lib/jquery-amd","api-mod","ns-exporter","ta/Core/TA.Event","ta/Core/TA.Store","ta/util/Error","utils/throttle"],function(t,o,e,r,l,n,s){"use strict";function a(o){var e=t(o).find(".gptAd:not(.inactive, .hidden)").toArray();e.sort(function(o,e){return o=t(o),e=t(e),o.offset().top===e.offset().top?0:o.offset().top<e.offset().top?1:-1});for(var r=0;r<e.length;r++)if(e[r].offsetHeight>O)return H=t(e[r]).parent('div[class*="iab_"]')[0],e[r];return null}function i(){if(b&&H){var t=A[Math.round(b.offsetHeight/300)];t>0&&(C=t,document.all&&(H.style.zoom="1",b.style.position="static"),o.addClass(H,"reserveH"),H.style.height=t+"px",E=!0)}}function d(t){for(var e=null,r=0;r<x.length;r++){var l=o.getCoords(x[r]);if(t+y>l.top&&t+y+C<l.bottom){e=x[r];break}}return e}function u(){o.removeEvent(window,"scroll",D),b&&H&&(o.removeClass(b,"scrollAd"),o.removeClass(H,"reserveH"),H.setAttribute("style",""),b.style.left="auto")}function c(t,e){var r,l,n=!1,s=document.querySelector(t);return s&&null!=C&&null!=y&&null!=e&&(l=o.getCoords(s),r=l.top,null!=r&&(n=e+C+y>r&&e<r+s.offsetHeight)),n}function f(t){return c("#HSCS.similar_tab_rhr",t)}function p(t){t&&parseInt(t.height,10)&&(y=_+parseInt(t.height,10))}function v(){return t(".scrollAdSidebar, #BODYCON .gridA .sidebar")[0]}var h={};r.queueForLoad(function(){l.has("ads.no_scroll_ad")||(r.on("scrollingTabs_updateTabBar",p),r.on("scrollingTabs_updateTabBar",p),r.on("onHACUpdate",h.resetScrollAd),r.on("onHACUpdateComplete",h.addScrollHandler))},"ScrollAd");var m=10,g=0,A=[0,250,600],b=null,C=null,_=15,y=_,S=null,H=null,E=!1,T=null,B=null,w=1e3,O=100,x=o.select(".sidebar_ad_parent"),I=x.length>0,q=1e3,Y=null,k=!1,D=s(function(){function t(){return o.find("#EATERY_OVERVIEW_BOX")}function e(){var t=o.find(".ppr_priv_restaurant_filters");return t?o.getCoords(t).bottom:null}try{if(T||(T=o.find(".scrollAdMain")||o.find("#BODYCON .gridA .balance")||t()),B||(B=v()),b&&document.getElementById(b.id)||(b=a(B),b&&(b.style.top=y+"px",i())),b&&B&&T){if(g>m&&!I)return void u();var r=o.getCoords(T).bottom,s=e()||o.getCoords(B).bottom,c=s-y,p=r-C-y,h=r-s-C>0,A=o.scrollTop(),_=function(){o.addClass(b,"scrollAd"),S&&(b.style.left=S+"px")},H=function(){o.removeClass(b,"scrollAd"),b.style.left="auto"};if(A<p)h?A>c&&!f(A)?(_(),g=0):H():g++;else if(I&&l.has("ads.contentBlocks")){if(Y){var E=o.getCoords(Y);(A<E.top+y||A+y+C>E.bottom)&&(Y=d(A))}else Y=d(A);Y&&Y.offsetHeight>q?_():H()}else H(),h||(g+=m)}else u()}catch(t){u(),n.record(t,"ta.common.scrollAd:handleScroll")}},300);return h.addScrollHandler=function(){if(!l.has("ads.no_scroll_ad"))try{setTimeout(function(){o.removeEvent(window,"scroll",D),o.addEvent(window,"scroll",D),D()},w),k=!1}catch(t){n.record(t,"unable to init scrolling ad")}},h.resetScrollAd=function(){if(!l.has("ads.no_scroll_ad"))try{if(k)return;u(),b=null,C=null,H=null,T=null,B=null,E=!1,g=0,k=!0}catch(t){n.record(t,"error resetting scrolling ad")}},e.exportTo(h,"ta.common.scrollAd"),h});
ta.servlet.GeoCheckRates={checkBoxToggle:function(e,c){var a=$(c.parentNode);c.checked?a.addClass("checked"):a.removeClass("checked")}};
define("overlays/loading-spinner",["vanillajs"],function(){"use strict";function i(i){return'<div style="padding:36px; min-width: 100px; min-height: 100px">'+i+"</div>"}function n(){for(var i='<div class="cssLoadingSpinner" style="display:block">'+e(),n=1;n<=8;n++)i+='<div class="cssLoadingSpinner_step'+n+'"></div>';return i+"</div>"}function e(){var i=window.CDNHOST||require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("CDNHOST");return'<div class="spinnerImage" style="position: absolute; top: 50%; left: 50%; width: 32px; height: 32px; margin-top: -16px; margin-left: -16px; background:url('+i+'/img2/generic/site/ajax-loader.gif)"></div>'}return function(r){var t=window.AnimationEvent?n():e();return r?t:i(t)}});
define("overlays/utils",["vanillajs","overlays/loading-spinner","api-mod"],function(t,e,n){"use strict";var r={};return r.arrowDir={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"right",rightEvenInRtl:"left",bottomRight:"top",bottomLeft:"top"},r.arrowDirRtl={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"left",rightEvenInRtl:"right",bottomRight:"top",bottomLeft:"top"},r.getArrowDir=function(t,e,i){var o=n.hasClass(document.body,"rtl")?r.arrowDirRtl:r.arrowDir;if("wideside"===t&&e&&i){var l=n.getSize(e),a=n.getPosition(e),f=n.getSize(i);return a.left>f.x-a.left-l.x?o.left:o.right}return o[t]},r.injectContent=function(t,e,r,i,o){n.isElement(r)?n.adopt(t,r):i?(r=n.find(i,e),n.removeClass(r,"hidden"),n.adopt(t,r)):o?(r=n.find(o),r&&(t.innerHTML+=r.innerHTML)):t.innerHTML+=r},r.injectContentWithDataAttrs=function(t,e,n,i,o){n=n||e&&e.getAttribute("data-content")||"",i=i||e&&e.getAttribute("data-element")||"",o=o||e&&e.getAttribute("data-element-copy")||"",r.injectContent(t,e,n,i,o)},r.parseOffsets=function(t){return t&&t.length?{x:t[0]&&parseInt(t[0],10)||0,y:t[1]&&parseInt(t[1],10)||0}:{x:0,y:0}},r.loadingSpinnerHtml=e,r});
define("utils/array/flatten",["vanillajs"],function(){return function n(r){return r.reduce(function(r,t){return r.concat(Array.isArray(t)?n(t):t)},[])}});
define("overlays/Overlay",["api-mod","mixins/Events","overlays/utils","utils/array/flatten"],function(t,e,i,n){"use strict";var o=function(i,o){this.sourceElement=i,this.domParent=document.body,this.container=null,this.contentElement=null,t.mixin(this,new e("show","hide","destroy","positionDirty","hover","contentsUpdated")),t.bindAll(this,"show","hide","destroy"),n(Array.prototype.slice.call(arguments,1)).filter(function(t){return"function"==typeof t}).forEach(function(t){t.call(this)}.bind(this))};return o.prototype.isOpen=function(){return t.inDocument(this.container)},o.prototype.show=function(){return t.inDocument(this.container)?this:(this.domParent.appendChild(this.container),this.container.overlay=this,this.emit("append"),this.emit("show"),this)},o.prototype.hide=function(e){return t.inDocument(this.container)?(delete this.container.overlay,this.domParent.removeChild(this.container),this.emit("hide",{trigger:e}),this):this},o.prototype.destroy=function(t){return this.hide(t),this.emit("destroy",{trigger:t}),this.sourceElement=null,this.contentElement=null,this},o.prototype.reposition=function(){return this.emit("positionDirty"),this},o.prototype.updateContent=function(t){return this.contentElement.innerHTML="",i.injectContentWithDataAttrs(this.contentElement,this.sourceElement,t),this.emit("contentsUpdated"),this.reposition(),this},o});
define("overlays/styles/modal",["vanillajs","api-mod"],function(e,t){"use strict";function i(e,i,n,s,a){this.container=t.createElement(a||"span",{"class":"ui_overlay ui_modal "+i}),n&&(this.header=t.createElement("div",{"class":"header_text"}),this.header.innerHTML=n,this.container.appendChild(this.header)),s&&(this.subheader=t.createElement("div",{"class":"subheader_text"}),this.subheader.innerHTML=s,this.container.appendChild(this.subheader)),this.inner=t.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner,this.close=t.createElement("div",{"class":"ui_close_x"}),this.container.appendChild(this.close)}var n=function(e,n,s,a,h,d,r){return s=s||e&&e.getAttribute("data-modal")||"",a=a||e&&e.getAttribute("data-header")||"",h=h||e&&e.getAttribute("data-subheader")||"",function(){i.call(this,n,s,a,h,r),this.updateContent(d),t.addEvent(this.close,"click",t.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return n});
define("overlays/styles/windowshade",["vanillajs","api-mod"],function(t,i){"use strict";var e=function(t,e){return function(){this.shade=i.createElement("div",{"class":"ui_backdrop "+(t||"dark"),"onclick":""}),e&&(this.shade.style.top=e+"px",this.shade.style.position="absolute",this.shade.style.height=document.body.clientHeight-e+"px"),this.on("show",function(){this.domParent.appendChild(this.shade)});var s=this.hide;this.hide=function(){i.inDocument(this.shade)&&this.domParent.removeChild(this.shade),s.apply(this,arguments)}}};return e});
define("overlays/position/base",[],function(){"use strict";return function(){return function i(){var o=i.onPosition&&i.onPosition.bind(this);this.on("show",function(){o&&(this.on("positionDirty",o),o())}.bind(this)),this.on("hide",function(){o&&this.off("positionDirty",o),i.offPosition&&i.offPosition.call(this)}.bind(this))}}});
define("overlays/position/centerWithGutters",["lib/jquery-amd","overlays/position/base"],function(t,e){"use strict";return function(i,n){var o=e();return i=i||0,n=n||0,o.onPosition=function(){var e=t(this.container);e.css({"position":"fixed","left":0,"right":"auto","top":0,"bottom":"auto"});var o=document.documentElement.clientWidth-this.container.clientWidth;e.css({"left":o>2*i?o/2:i,"right":o>2*i?"auto":i});var c=document.documentElement.clientHeight-this.container.clientHeight;e.css({"top":c>2*n?c/2:n,"bottom":c>2*n?"auto":n})},o}});
define("overlays/options/closeOnEscape",["vanillajs","api-mod"],function(n,e){"use strict";function o(n){27===n.keyCode&&(n.preventDefault(),this.hide("escape"))}var t=function(){var n=e.bind(o,this);this.on("show",function(){e.addEvent(document,"keydown",n)}).on("hide",function(){e.removeEvent(document,"keydown",n)})};return t});
define("overlays/options/closeOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(n,t){"use strict";function o(){this.hide("on-event")}return function(n){return function(){var i=o.bind(this);this.on("show",function(){t.on(n,i)}).on("hide",function(){t.off(n,i)})}}});
define("overlays/options/closeOnWindowshadeClick",["vanillajs","api-mod"],function(i,n){"use strict";return function(){var i=this;n.addEvent(this.shade,"click",function(){i.hide("windowshade")})}});
define("overlays/options/repositionOnEvent",["vanillajs","api-mod"],function(n,i){"use strict";function t(){this.emit("positionDirty")}return function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(t,this);this.on("show",function(){e.forEach(function(t){i.addEvent(n,t,c)})}).on("hide",function(){e.forEach(function(t){i.removeEvent(n,t,c)})})}}});
define("utils/object/set-props",["vanillajs"],function(){"use strict";return function(n,r){for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);return n}});
define("utils/object/shallow-copy",["utils/object/set-props","vanillajs"],function(t){"use strict";return function(r){var e;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){e=[];for(var n=0;n<r.length;++n)e.push(r[n])}else e=t({},r);return e}});
define("utils/AjaxData",["ta","mixins/Events","lib/jquery-amd"],function(t,e,n){"use strict";function i(){}function a(t){function a(){return null!==s||null!==l}function r(){var t=a(),e=d,n=l;if(d=null,s=null,l=null,null!==n)try{n.abort()}catch(t){}return null!==e&&clearTimeout(e),t}function o(){var t=s;if(s=null,t){var e;t.success=function(n){l==e&&(l=null,v&&(y=n),f.data=n,f.error=void 0,f.dataVersion=++p,h(f,e,t.data),u.emit("update"))},t.error=function(n,i,a){l==e&&(l=null,f.data=y,f.dataVersion=++p,f.error={type:i,error:a,status:n.status,responseText:n.responseText},h(f,e,t.data),u.emit("update"))},e=c(t),l=e,u.emit("update")}}t=t||{};var u=new e("update"),d=null,s=null,l=null,f=this,p=0,c=t.ajaxFunc||n.ajax,h=t.transformer||i,m=t.dataType||"html",v=!!t.holdData,y=void 0;this.dataVersion=0,this.on=u.on.bind(u),this.off=u.off.bind(u),this.removeListener=u.removeListener.bind(u),this.isDone=function(){return!a()},this.isBusy=function(){return a()},this.clear=function(){var t=a()||"undefined"!=typeof this.data||"undefined"!=typeof this.error;r(),y=void 0,f.data=void 0,f.error=void 0,f.dataVersion=0,h(f),t&&u.emit("update")},this.refresh=function(t,e,n,i,a){r(),(!i||i<0)&&(i=0),s={type:t,url:e,data:n,dataType:m,xhrFields:{withCredentials:!0}},"undefined"!=typeof a&&(s.timeout=a),d=setTimeout(o,i),f.error=void 0,v||(f.data=void 0,h(f)),u.emit("update")},this.postJson=function(t,e,n,i){r(),n=n||0,n<0&&(n=0),s={beforeSend:function(t){t.setRequestHeader("Content-Type","application/json")},type:"POST",url:t,contentType:"application/json",data:JSON.stringify(e),dataType:m,xhrFields:{withCredentials:!0}},"undefined"!=typeof i&&(s.timeout=i),d=setTimeout(o,n),f.error=void 0,v||(f.data=void 0,h(f)),u.emit("update")}}return a});
define("utils/resourceLoader",["vanillajs"],function(e){"use strict";function r(){function e(){try{if(navigator.userAgent.match(/ Safari[\/]/)&&!navigator.userAgent.match(/ Chrom/)&&navigator.userAgent.match(/ Version\/5\./))return!1;var e=navigator.userAgent.match(/\ AppleWebKit\/(\d+)\.(\d+)/);if(e){e.shift();var r=parseInt(e[0]),t=parseInt(e[1]);if(r<535||535==r&&t<23)return!1}return"onload"in document.createElement("link")}catch(e){return!1}}function r(e,r,t){u++,(u==c.length||l)&&r(t),t?require.defined("ta/util/Error")&&require("ta/util/Error").record(new Error(e),"utils/resourceLoader: failed to load file ["+e+"]"):n[e]=1}function o(e){return e.match(/\.css$/)?"css":e.match(/\.js$/)?"js":""}function a(t,n,u){var c=n||o(u);if(c){var l,s,f;"css"==c?(l=document.createElement("link"),l.rel="stylesheet",l.type="text/css",f="href",s=e()):"js"==c&&(l=document.createElement("script"),l.type="text/javascript",f="src",s="onload"in l),s?(l.onload=r.bind(null,u,t,!1),"onerror"in l&&(l.onerror=function(){i[u]?r(u,t,!0):(i[u]=!0,a(t,n,u))})):r(u,t,!1),l[f]=u;var d=document.getElementsByTagName("head")[0];d.appendChild(l)}else require.defined("ta/util/Error")&&require("ta/util/Error").record(new Error(u),"utils/resourceLoader: unknown file type for ["+u+"]"),r(u,t,!0)}var u,c,l;this.load=function(e,r,n){if("function"==typeof r&&(n=r,r={}),u=0,c=t(e||null),n=n||function(){},r=r||{},l=r.serial,0==c.length)setTimeout(n,1);else if(l){var i,o=c.slice(),s=function(e){i=i&&e,0==o.length?n&&n(i):a(s,r.forceType,o.shift())};s()}else c.forEach(a.bind(null,n,r.forceType))}}function t(e){var r=[],t=function(e){!e||e in n||(e&&e.splice?e.forEach(t):r.push(e))};return t(e),r}var n={},i={};return{Loader:r,load:function(e,t,n){"function"==typeof t&&(n=t,t={}),(new r).load(e,t,n)},loaded:function(e){return 0==t(e).length}}});
define("overlays/ajaxUtil",["vanillajs","ta","utils/object/shallow-copy","utils/AjaxData","mixins/Events","overlays/loading-spinner","utils/resourceLoader","amdloaders"],function(e,t,r,a,n,i,o,s){"use strict";function d(e,t){var r,a=[];for(r in t)t[r]&&a.push(r);a.sort();for(var n=e,i=n.indexOf("?")>=0?"&":"?",o=0;o<a.length;++o)r=a[o],n+=i+encodeURIComponent(r)+"="+encodeURIComponent(String(t[r])),i="&";return n}function u(){for(var e=0,t={},r=[],a=h.length-1;a>=0;--a){var n=h[a],i=p[n];i&&!t[n]&&(i.hasClients()||++e<=f)&&(t[n]=i,r.push(n))}return r.reverse(),p=t,h=r,m=h.length+f,h}function l(e,i){function d(){t.page.datesToQueryString("STAYDATES");if(y){y=!1,u();for(var e=h.length-1;e>=0;--e){var r=p[h[e]];r.needsTravelInfo&&r.invalidate()}}}function l(e,r,a,n,i,s){if(n=n&&t.page&&t.page.usingUnifiedDates){y=!0;var u=t.page.datesToQueryString("STAYDATES");u&&(r+="&"+u),g||(g=!0,t.page.on("dateSelected",d),t.page.on("guestsSelected",d))}if(i>1){if(i>20)return;r+="&reqNum="+i,s>=0||(s=2e3)}else s=0;a?e.refresh("POST",r,a,s):e.refresh("GET",r,void 0,s),o.load(m,function(){C=!0,c()})}function c(){if(S.isBusy()||!C)return I&&clearTimeout(I),void(I=void 0);if(!S.data)return void(0!==S.dataVersion?A.error&&A.error===S.error||(A.error=S.error||"no content",I=I||setTimeout(f,0)):0!==V&&(L=b,V=S.dataVersion,P=[],E.hasListeners("update")&&(I=I||setTimeout(f,0))));if(V!==S.dataVersion){try{var e=document.createElement("div");e.innerHTML=S.data;var t=q,r=document.head||document.getElementsByTagName("head")[0];P=[],i.noScript||Array.prototype.forEach.call(e.querySelectorAll("script"),function(e){if(t){var a=document.createElement("script");a.setAttribute("type","text/javascript"),e.src&&(a.src=e.src),e.text&&(a.text=e.text),a.setAttribute("data-rup",e.getAttribute("data-rup")),r.appendChild(a),e.src||r.removeChild(a)}e.parentNode.removeChild(e)}),Array.prototype.forEach.call(e.querySelectorAll("style"),function(e){t?r.appendChild(e):e.parentNode.removeChild(e)}),Array.prototype.forEach.call(e.querySelectorAll("[data-targetEvent]"),function(e){P.push(e),e.parentNode.removeChild(e)}),t&&(q=!1,v[i.inlineResourceId]=!0),L=e.innerHTML,V=S.dataVersion,S.data=void 0}catch(e){A.error="invalid HTML"}I=I||setTimeout(f,0)}}function f(){var t,r=!E.hasListeners("update");for(I=void 0,A.data=L,A.dataVersion=V,E.emit("update");t=P.shift();){var a=t.getAttribute("data-targetEvent");if("repoll-required"===a){if(r)return P=[],A.data=L=b,void(A.dataVersion=V=0);++j>1||(j=2);var n=Number(t.getAttribute("data-delay"));l(S,e,i.reqParams,x,j,n)}else if("offerClickTrackingTree"===a)try{var o=require("commerce/impression-tracker");o&&o.onTrackingTreeElement(t)}catch(e){}else E.emit("data-targetEvent",a,t)}}var m,C,A=this,S=new a({dataType:"html",ajaxFunc:i.ajaxFunc}),E=new n("update","data-targetEvent"),b=i.loadingContent||T,q=!1,x=!!i.sendTravelInfo,I=void 0,L=b,V=S.dataVersion,P=[],j=0;this.error=void 0,this.loadingData=b,this.data=L,this.dataVersion=V,this.needsTravelInfo=x,this.on=E.on.bind(E),this.off=E.off.bind(E),this.removeListener=E.removeListener.bind(E),this.init=function(){S.on("update",c.bind(this))},this.isBusy=function(){return S.isBusy()||I},this.isDone=function(){return!S.isBusy()&&!I},this.invalidate=function(){S.clear(),j=0,this.hasClients()?l(S,e,i.reqParams,x,0,0):(A.data=L=b,A.dataVersion=V=0)},this.hasClients=function(){return E.hasListeners("update")},this.load=function(){if(!S.isBusy()){if(0!==S.dataVersion)return void setTimeout(function(){E.emit("update")},1);var t=i.reqParams,a=!i.isWidget||!i.inlineResourceId||!v[i.inlineResourceId];if(a){var n=s.getLoadedFilesParams();q=!0,t=t?r(t):{},t.haveJses=n.haveJses,t.haveCsses=n.haveCsses,i.isWidget&&(t.Action="install")}m=i.resources,j=0,l(S,e,t,x,0,0)}}}function c(e,t){var r=d(e,t.reqParams);r.length<128&&(e=r,t.reqParams=void 0);var a=p[r];return a||(a=new l(e,t),a.init(),t.noCache||(p[r]=a)),t.noCache||(h.push(r),h.length>m&&u()),a}var v={},f=10,h=[],p={},m=f,g=!1,y=!1,T=i();return{loadData:function(e,t){!t&&(t={});var r=c(e,t);return r.load(),r},loadOverlayWidget:function(e,t){var a="/OverlayWidgetAjax?Mode="+e;"string"==typeof crPageServlet&&(a+="&metaReferer="+encodeURIComponent(crPageServlet)),t=t?r(t):{},t.inlineResourceId=e,t.isWidget=!0;var n=c(a,t);return n.load(),n},cleanCache:u}});
define("overlays/options/ajax",["vanillajs","overlays/ajaxUtil"],function(t,e){"use strict";function i(t){return t&&t.match(/^((https?:)?(\/\/)?([\da-z\.\-\u00a1-\uffff]+)\.([a-z\.\u00a1-\uffff]{2,6}))?(\/[\w]+)*(\?[\/\w\.+%=\-#&\/!\u00a1-\uffff]+)?$/)}function n(t,n){function s(){if(this.sourceElement&&(t=t||this.sourceElement.getAttribute("data-url"),void 0===n.noCache&&(n.noCache=this.sourceElement.getAttribute("data-ajaxNoCache")),n.resources||(n.resources=this.sourceElement.getAttribute("data-resources"),n.resources&&(n.resources=n.resources.replace(/[\[\]]/g,"").split(/[ ,]+/)))),t){var s,a,r=0,o=function(){s.dataVersion!==r&&(this.contentElement.innerHTML=s.data,this.emit("contentsUpdated"),r=s.dataVersion,require.defined("ta/prwidgets")&&require("ta/prwidgets").initWidgets(this.contentElement)),this.reposition(),setTimeout(this.reposition.bind(this),1),this.emit("contentLoaded",s.error)}.bind(this),d=function(){return a==t?void this.reposition():(n.skipInvalidate||s&&s.invalidate(),a=t,s=e.loadData(t,n),this.contentElement.innerHTML=s.data,this.emit("contentsUpdated"),this.reposition(),r=s.dataVersion,require.defined("ta/prwidgets")&&require("ta/prwidgets").initWidgets(this.contentElement),s.on("update",o),void s.on("data-targetEvent",u))}.bind(this),u=this.emit.bind(this,"data-targetEvent");this.on("show",d),this.on("hide",function(){s&&(s.off("update",o),s.off("data-targetEvent",u),s=void 0)});var h=this.updateContent;this.updateContent=function(e){return e?i(e)?(t=e,this.isOpen()&&d(),this):(t="",h.apply(this,arguments)):(t="",e=this.sourceElement.getAttribute("data-url"),e?this.updateContent(e):h.apply(this,arguments))}}}return n||(n={}),s}return n});
define("utils/classnameUtils",["vanillajs"],function(){function s(s){return e[s]?e[s].lastIndex=0:e[s]=new RegExp("(\\s|^)"+s+"(\\s|$)","g"),e[s]}var a={},e={};return a.hasClass=function(a,e){return!!a&&(a.classList?a.classList.contains(e):s(e).test(a.className))},a.addClass=function(s,e){s&&(s.classList?s.classList.add(e):a.hasClass(s,e)||(s.className+=" "+e))},a.removeClass=function(a,e){a&&(a.classList?a.classList.remove(e):a.className=a.className.replace(s(e)," "))},a.toggleClass=function(s,e,n){s&&(n||void 0===n&&!a.hasClass(s,e)?a.addClass(s,e):a.removeClass(s,e))},a.getParentByClassname=function(s,e){for(var n=s&&s.parentNode;n;n=n.parentNode)if(a.hasClass(n,e))return n;return null},a});
define("ta/servlet/ShowSpecialOffer",["overlays/Overlay","overlays/styles/modal","overlays/styles/windowshade","overlays/position/centerWithGutters","overlays/options/closeOnEscape","overlays/options/closeOnTaEvent","overlays/options/closeOnWindowshadeClick","overlays/options/repositionOnEvent","overlays/options/ajax","ns-exporter","ta/util/Cookie","common/trackingStreams","utils/classnameUtils","ta/Core/TA.Store","ta/Core/TA.Event"],function(e,o,s,a,t,n,r,l,i,c,v,p,u,d,f){"use strict";var w,C={};return C.openCoupon=function(c,C,m,y,O,h,S,x,k,E){v.setPIDCookie(h),p.trackEvent("SpecialOffer","click",S||window.pageServlet);var g="/CouponAjax?"+(C?"couponId="+C+"&":"")+(m?"announcementId="+m+"&":"")+(x?"locale="+x+"&":"")+(k&&"false"!==k?"isAmex="+k+"&":"")+(E&&"false"!==E?"showLocs="+E+"&":"")+"locationId="+y+"&listing=true",A=k&&"false"!=k?"amex":"couponDetail";if(w)w.updateContent(g),u.removeClass(w.container,"couponDetail"),u.removeClass(w.container,"amex"),u.addClass(w.container,A),w.show();else{var I={act:c},T=S||window.pageServlet;T&&(I.act+="-"+T),w=new e(null,[o(null,"center",A,""),s(),a(16,16),t,n("closeCouponOverlay"),r,l(window,"resize"),i(g,{resources:[O],reqParams:I})]);var b=!1,D="suppressCalendarPop";d.retrieve(D)||(d.store(D,!0),b=!0),w.show(),w.on("hide",function(){b&&d.remove(D),f.fireEvent("specialOfferClosed"),ta.servlet&&ta.servlet.blcoupons&&ta.servlet.blcoupons.closeHandler&&ta.servlet.blcoupons.closeHandler()})}},c.exportTo(C,"ta.servlet.ShowSpecialOffer"),C});
(function(){Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:true},initialize:function(c,b){this.element=this.subject=document.id(c);this.parent(b);if(typeOf(this.element)!="element"){this.element=document.id(this.element.getDocument().body)}if(this.options.wheelStops){var d=this.element,e=this.cancel.pass(false,this);this.addEvent("start",function(){d.addEvent("mousewheel",e)},true);this.addEvent("complete",function(){d.removeEvent("mousewheel",e)},true)}},set:function(){var b=Array.flatten(arguments);if(Browser.firefox){b=[Math.round(b[0]),Math.round(b[1])]}this.element.scrollTo(b[0],b[1])},compute:function(d,c,b){return[0,1].map(function(e){return Fx.compute(d[e],c[e],b)})},start:function(c,d){if(!this.check(c,d)){return this}var b=this.element.getScroll();return this.parent([b.x,b.y],[c,d])},calculateScroll:function(g,f){var d=this.element,b=d.getScrollSize(),h=d.getScroll(),j=d.getSize(),c=this.options.offset,i={x:g,y:f};for(var e in i){if(!i[e]&&i[e]!==0){i[e]=h[e]}if(typeOf(i[e])!="number"){i[e]=b[e]-j[e]}i[e]+=c[e]}return[i.x,i.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(false,0))},toLeft:function(){return this.start.apply(this,this.calculateScroll(0,false))},toRight:function(){return this.start.apply(this,this.calculateScroll("right",false))},toBottom:function(){return this.start.apply(this,this.calculateScroll(false,"bottom"))},toElement:function(d){var c=document.id(d).getPosition(this.element),b=a(this.element)?{x:0,y:0}:this.element.getScroll();return this.start.apply(this,this.calculateScroll(c.x+b.x,c.y+b.y))},scrollIntoView:function(d,g,e){g=g?Array.from(g):["x","y"];d=document.id(d);var i={},f=d.getPosition(this.element),j=d.getSize(),h=this.element.getScroll(),b=this.element.getSize(),c={x:f.x+j.x,y:f.y+j.y};["x","y"].each(function(k){if(g.contains(k)){if(c[k]>h[k]+b[k]){i[k]=c[k]-b[k]}if(f[k]<h[k]){i[k]=f[k]}}if(i[k]==null){i[k]=h[k]}if(e&&e[k]){i[k]=i[k]+e[k]}},this);if(i.x!=h.x||i.y!=h.y){this.start(i.x,i.y)}return this},scrollToCenter:function(e,f,h){f=f?Array.from(f):["x","y"];e=document.id(e);var i={},c=e.getPosition(this.element),d=e.getSize(),b=this.element.getScroll(),g=this.element.getSize();["x","y"].each(function(j){if(f.contains(j)){i[j]=c[j]-(g[j]-d[j])/2}if(i[j]==null){i[j]=b[j]}if(h&&h[j]){i[j]=i[j]+h[j]}},this);if(i.x!=b.x||i.y!=b.y){this.start(i.x,i.y)}return this}});function a(b){return(/^(?:body|html)$/i).test(b.tagName)}})();
define("ta/maps/trackpixel",["vanillajs"],function(a){var r=[];return{storeTrackPixleSrc:function(a){a&&(a.splice?Array.prototype.push.apply(r,a):r.push(a))},loadSponsorTrackingPixel:function(a){r.forEach(function(a){var r=a.trim(),n=new Image;n.className="tracking",n.src=r}),a||(r=[])}}});
function scaleImage(t,e,i,a,o){var l={width:0,height:0,targetleft:0,targettop:0};if(t<=0||e<=0||i<=0||a<=0)return l;var h=i,n=e*i/t,r=t*a/e,f=a,o=!!o;return r>i==o?(l.width=Math.floor(h),l.height=Math.floor(n)):(l.width=Math.floor(r),l.height=Math.floor(f)),l.targetleft=Math.floor((i-l.width)/2),l.targettop=Math.floor((a-l.height)/2),l}function onImageLoad(t,e,i){var a=ta.id(t);if(a){var o=a.clientWidth,l=a.clientHeight,h=a.parentNode.offsetWidth,n=a.parentNode.offsetHeight,r=i?i+1:1;if(o<=1&&r<20)setTimeout(function(){onImageLoad(t,e,r)},300);else{var f=scaleImage(o,l,h,n,e);f.width>0&&(a.width=f.width,a.height=f.height,a.style[ta.util.i18n.isRtl()?"right":"left"]=f.targetleft+"px",a.style.top=f.targettop+"px")}}}!function(){function t(){if(this.clientWidth<=1){var e=this;return void setTimeout(function(){t.call(e)},50)}onImageLoad(this);var i=new Element(this).getParent(".flexible_photo_cell");i&&i.removeClass("invisible")}ta.select(".flexibleImage").each(function(e){e.complete?t.call(e):e.onload=t}),window.addEvent("resize",function(){ta.select(".flexibleImage").each(function(t){onImageLoad(t)})})}();
!function(t){t.queueForReady(function(){var e=t.select(".triplist-cta")||[];e.each(function(e){t.trackEventOnPage(e.getAttribute("data-category"),"show","",0,!0);var a=e.getElements("a")||[];a.each(function(e){var a=e.getAttribute("data-category"),n=e.getAttribute("data-event"),c=e.getAttribute("data-label"),r=e.getAttribute("data-value");e.addEvent("click",function(){t.setEvtCookie(a,n,c,r,e.href)})})});var a=t.select(".triplist-featured-in-cta")||[],n=[];a.each(function(e){var a=e.getAttribute("data-category");a&&!n.contains(a)&&(t.trackEventOnPage(a,"show","",0,!0),n.push(a))})})}(ta);
define("ta/Core/TA.Load",["vanillajs","ns-exporter","ta/Core/TA.Store","utils/resourceLoader"],function(e,r,o,a){function t(e){if("string"==typeof e&&VERSION_MAP){var r=!1;if(VERSION_MAP[e])r=e;else if(VERSION_MAP[e+".js"])r=e+".js";else for(var o=e.split("."),a=0;o&&o.length>1&&a<10;){o=o.slice(0,-1);var t=o.join("-")+".js";if(t&&VERSION_MAP[t]){r=t;break}a++}return r}}var n={};return n.load=function(e,r,n){var i=!1,s=t(e);s&&(i=VERSION_MAP[s]);var l=function(){var e=o.remove(f);e&&e.forEach(function(e){e&&e()})};if(i){var f=s+"_callback";if(o.has(f)){var c=o.retrieve(f);c.push(r),o.store(f,c)}else o.store(f,[function(){delete VERSION_MAP[s],r&&r()}]),"object"==typeof i?a.load(i,{serial:!0,forceType:"js"},l):a.load(i,{forceType:"js"},l)}else n&&a.loaded(i)&&(l(),r&&r());return i},n.loadInOrder=function(e,r){a.load(e,{serial:!0},r)},r.exportTo(n,"ta"),n});
define("answers/minimal",["vanillajs","ta/Core/TA.Load"],function(n,a){return{commonFocus:a.load.bind(a,"altsess.js",null)}});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"war_review_rating_pseudo","handlers",["handlers"]);t(["placement","lib/jquery-amd","ta/Core/TA.Record","utils/resourceLoader","ta/Core/TA.Event","ta/util/Cookie"],function(e,t,r,n,a,i){"use strict";function o(){var e=t("#taplc_prodp13n_hr_sur_review_keyword_search_0_reviewTag"),r=t("#taplc_prodp13n_hr_sur_review_keyword_search_0_q");if(!e.val()&&!r.val()){var n=document.getElementsByName("filterRating"),a=document.getElementsByName("filterSegment"),i=document.getElementsByName("filterSeasons");if(!(u(n)||u(a)||u(i))){var o=document.forms.REVIEW_FILTER_FORM;if(o){var _=o.filterSegment;if(_&&"0"!=_.value)return;var c=o.filterRating;if(c&&"0"!=c.value)return}d&&(l(),s())}}}function u(e){return t(e).is(":checked")}function l(){t("#war_rating_bubbles").removeClass("hidden")}var d=!0,_=function(){return"VacationRentalReview"===window.pageServlet},s=function(){r.trackEventOnPage("war_review_rating_pseudo","Bubble_Hover","");var n=t("#"+e.id),a=t(".rate",n).get(0),o=t("#overallRatingFlagText",n).get(0),u=require("ta/widgets/DynamicRating");new u(a,{prefix:"bubble_",prefixes:{},textNode:o,strings:window.RATING_STRINGS,ratingNode:o,ratingNodeClass:"noRating",update:t("input[name=qid10]",n).get(0),onSelect:function(){_()&&i.setPIDCookie(39914);var a=t("input[name=qid10]",n);a.length&&r.setEvtCookie("war_review_rating_pseudo","Bubble_Select","",a.val(),"/UserReviewEdit"),t("#SUBMIT","#"+e.id).click()}})};return a.on("prodp13n.review_filter_controls.languageChanged",function(){d=!1,o()}),a.queueForLoad(function(){n.load(t("#war_rating_bubbles").attr("data-deferredJs"),o)},e.name),{}})});
define("overlays/styles/dropdown",["vanillajs","api-mod"],function(t,n){"use strict";function e(t,e,i,o){this.container=n.createElement(o||"span",{"class":"ui_overlay ui_dropdown "+e,"style":i}),this.contentElement=this.container}var i=function(t,n,i,o,r,a){i=i||t.getAttribute("data-dropdown")||"";var s=r||t.getAttribute("style")||"";return function(){e.call(this,n,i,s,a),this.updateContent(o)}};return i});
define("overlays/position",["vanillajs","api-mod","overlays/utils","ta/Core/TA.Event","overlays/position/base"],function(t,n,e,o,r){"use strict";function i(t,o,i,u){return function(l,a,y,h){var x=r();return x.onPosition=function(){var r=n.getSize(this.arrow)||{x:0,y:0},x=s(l,this.sourceElement),p=x?n.getSize(x):{x:0,y:0},d=x?n.getPosition(x):{left:0,top:0},m=n.getSize(this.domParent),g=e.parseOffsets(f(l)),b=!x||a||c(this.sourceElement),v=e.parseOffsets(h);this.container.style.position=b&&!y?"fixed":"absolute";var L=n.getSize(this.container);x&&x.getAttribute("data-anchorWidth")&&(n.hasClass(document.body,"rtl")?(d.left+=p.x,p.x=Number(x.getAttribute("data-anchorWidth")),d.left-=p.x):p.x=Number(x.getAttribute("data-anchorWidth")));var C=function(t,n,e,o){if("function"==typeof t){var i=Math.floor(t(L,r,p,d,m,b))+n;return this.domParent===document.body&&(i=Math.max(i,e),i=Math.min(i,o)),i+"px"}return"auto"}.bind(this);t&&o&&i&&u&&!y&&(this.container.style.position="fixed");var T=Math.max(Math.min(v.x,(m.x-L.x)/2),0);this.container.style.left=C(t,g.x,T,Math.max(m.x-L.x-T,T)),this.container.style.right=C(i,g.x,T,Math.max(m.x-L.x-T,T)),this.container.style.top=C(o,g.y,-Number.MAX_VALUE,Number.MAX_VALUE),this.container.style.bottom=C(u,g.y,-Number.MAX_VALUE,Number.MAX_VALUE)},x}}function u(t,e){return function(){return function(){function o(){var o=n.getSize(this.container);this.container.style.position="fixed",t&&(n.hasClass(document.body,"rtl")?(this.container.style.right="50%",this.container.style.marginRight=-o.x/2+"px"):(this.container.style.left="50%",this.container.style.marginLeft=-o.x/2+"px")),e&&(this.container.style.top="50%",this.container.style.marginTop=-o.y/2+"px")}this.on("show",o),this.on("positionDirty",o)}}}function l(){return function(){return function(){function t(){n.addClass(this.container,"cssCentered")}this.on("show",t),this.on("positionDirty",t)}}}function s(t,e){return t&&t.length&&isNaN(t[0])?n.isElement(t[0])?t[0]:e&&n.find(t[0],e):e}function f(t){return t&&t.length&&isNaN(t[0])?t.slice(1):t}function c(t){for(;t;){if(t==document.body)return!1;if(t.style.position)return"fixed"==t.style.position;if(t.currentStyle&&"fixed"===t.currentStyle.position)return!0;if(window.getComputedStyle&&"fixed"===getComputedStyle(t).getPropertyValue("position"))return!0;t=t.parentNode}return!1}var a={};return a.above=i(function(t,e,o,r,i,u){return r.left+o.x/2-t.x/2-(u?n.scrollLeft():0)},function(t,e,o,r,i,u){return r.top-t.y-e.y-(u?n.scrollTop():0)}),a.below=i(function(t,e,o,r,i,u){return r.left+o.x/2-t.x/2-(u?n.scrollLeft():0)},function(t,e,o,r,i,u){return r.top+o.y+e.y-(u?n.scrollTop():0)}),a.bottomRight=i(function(t,e,o,r,i,u){return r.left-(u?n.scrollLeft():0)},function(t,e,o,r,i,u){return r.top+o.y+e.y-(u?n.scrollTop():0)}),a.bottomLeft=i(null,function(t,e,o,r,i,u){return r.top+o.y+e.y-(u?n.scrollTop():0)},function(t,e,o,r,i,u){return i.x-(r.left+o.x)+(u?n.scrollLeft():0)}),a.left=i(function(t,e,o,r,i,u){return r.left-t.x-e.x-(u?n.scrollLeft():0)},function(t,e,o,r,i,u){return r.top+o.y/2-t.y/2-(u?n.scrollTop():0)}),a.right=i(function(t,e,o,r,i,u){return r.left+o.x+e.x-(u?n.scrollLeft():0)},function(t,e,o,r,i,u){return r.top+o.y/2-t.y/2-(u?n.scrollTop():0)}),a.on=i(function(t,n,e,o,r){return r.x/2-t.x/2},function(t,e,o,r,i,u){return r.top+o.y/2-t.y/2-(u?n.scrollTop():0)}),a.wideside=i(function(t,e,o,r,i,u){return r.left>i.x-r.left-o.x?r.left-t.x-e.x-(u?n.scrollLeft():0):r.left+o.x+e.x-(u?n.scrollLeft():0)},function(t,e,o,r,i,u){return r.top+o.y/2-t.y/2-(u?n.scrollTop():0)}),a.center=i(function(t,n,e,o,r){return r.x/2-t.x/2},function(t,e,o,r,i,u){return i.y/2-t.y/2+(u?0:n.scrollTop())}),a.centerBelow=i(function(t,n,e,o,r){return r.x/2-t.x/2},function(t,e,o,r,i,u){return r.top+o.y+e.y-(u?n.scrollTop():0)}),a.topCenter=i(function(t,n,e,o,r){return r.x/2-t.x/2},function(t,n,e,o,r,i){return 0}),a.topLeft=i(null,function(t,e,o,r,i,u){return r.top-t.y-e.y-(u?n.scrollTop():0)},function(t,e,o,r,i,u){return i.x-(r.left+o.x)+(u?n.scrollLeft():0)}),a.movingCenter=u(!0,!0),a.movingCenterX=u(!0,!1),a.movingCenterY=u(!1,!0),a.cssCentered=l(),a.absolute=i(function(){return 0},function(){return 0}),a.framed=i(function(){return 0},function(){return 0},function(){return 0},function(){return 0}),a.offScreen=i(function(){return-1e4},function(){return-1e4}),a.noop=function(){return function(){}},o.queueForReady(function(){if(a.rightEvenInRtl=a.right,a.leftEvenInRtl=a.left,"undefined"!=typeof document&&n.hasClass(document.body,"rtl")){a.left=a.rightEvenInRtl,a.right=a.leftEvenInRtl;var t=a.bottomRight;a.bottomRight=a.bottomLeft,a.bottomLeft=t}},0,"initialize rtl position"),a});
define("overlays/options/closeOnDocClick",["vanillajs","api-mod"],function(t,e){"use strict";function n(t){this.sourceElement&&e.containsElement(this.sourceElement,t.target)||e.containsElement(this.container,t.target)||t.target&&("option"===t.target.tagName||e.hasClass(t.target,"ui_dropdown")||e.getParent(t.target,"ui_dropdown"))||e.checkBrowser("ie")&&t.target&&"select"==t.target.tagName&&e.containsEvent(t.target,t)&&e.select(this.container,"input").indexOf(t.target)||this.hide("doc-click")}function i(t){return function(){var i=e.bind(n,this);this.on("show",function(){setTimeout(function(){this.isOpen()&&(e.addEvent(document,"click",i),t&&e.addEvent(document,"touchstart",i))}.bind(this),1)}).on("hide",function(){e.removeEvent(document,"click",i),t&&e.removeEvent(document,"touchstart",i)})}}var o=i(!0);return o.withoutTouchEvents=i(!1),o});
define("overlays/options/autoReposition",["vanillajs","overlays/options/repositionOnEvent"],function(o,n){return n(window,["resize","scroll"])});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"location_review_filter_controls","handlers",["handlers"]);t(["placement","lib/jquery-amd","ta/Core/TA.Record","ta/Core/TA.Event","overlays/Overlay","overlays/styles/modal","overlays/styles/dropdown","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade"],function(e,t,r,a,i,n,l,o,d,p,s,c){function v(e,t,a,i){e&&r.trackEventOnPage(t,a,i,e.checked?1:0)}function g(r,i,n){var l=t("#"+e.id+"_form"),o=t("input[name=filterLang][checked]",l);!o.length||o.data("include")||o.is(":disabled")?o=void 0:o.prop("disabled","disabled"),f(l.get(0)),o&&o.prop("disabled",void 0),a.fireEvent("review_filters.filter_changed"),v(r,"Reviews_Controls","click_"+i,n)}function f(e,t){return ta.page&&ta.page.applyReviewFiltersForm?ta.page.applyReviewFiltersForm(e,t):void(ta.servlet.Reviews.filterReviews&&ta.servlet.Reviews.filterReviews(e,t))}function u(e,t,r){a.fireEvent("addFilterTag",{"filterType":e,"value":t,"label":r})}var _,h;return a.on("review_filters.toggle_rating",function(r){var a=e.id+"_filterRating_"+r,i=t("#"+a),n=t('label[for="'+a+'"] .row_label');t("#ratingFilter .filterInput:not(#"+a+")").prop("checked",!1),t("#ratingFilter .filterInput#"+a).prop("checked",!0),g(i.get(),"ta_rating",n.text()||"")}),{toggleFilterAndTrack:g,toggleLanguageAndTrack:function(r,i,n){r=t(r);var l=t("#"+e.id+"_filterLang_ALL");!r.prop("defaultChecked")||l.is(r)||l.is(":disabled")||(r.prop("checked",!1),l.prop("defaultChecked",!0),l.prop("checked",!0));var o=r.prop("checked");if(r.prop("defaultChecked")!==o){r.prop("defaultChecked",o),r.data("include",!0);var d;d="filterLang"===r.prop("name")?"filterLang_more":"filterLang",t("#"+e.id+" input[name="+d+"][value="+r.val()+"]").prop("defaultChecked",o).prop("checked",o),_&&(h=_.hide.delay(500,_)),a.fireEvent("prodp13n.review_filter_controls.languageChanged"),f(t("#"+e.id+"_form").get(0),{whiteBoxTopElmt:t(".ratings_and_types .ppr_rup",t("#REVIEWS")).get(0),loadingBoxTopElmt:e.id}),v(r,"Reviews_Controls","click_"+i,n)}},moreLanguages:function(a){function l(){var r=t("#"+e.id+"_moreLanguages");_?_.updateContent(r.html()):_=new i(null,n(null,"center","","","",r.html()),o.center(),d,p,s,c()),_.show(),h&&(clearTimeout(h),h=void 0)}return r.trackEventOnPage("Reviews_Controls","language_more"),l(),!1},addFilterTag:u}})});
require(["ta/p13n/placements"],function(e){var l=e.define.bind(e,"location_review_filter_controls_modal","handlers",["handlers"]);l(["placement","lib/jquery-amd","ta/Core/TA.Record","ta/Core/TA.Event","overlays/Overlay","overlays/styles/modal","overlays/styles/dropdown","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade"],function(e,l,a,i,t,r,n,o,s,p,d,f){function c(a,t,r,n){var o=l("#"+e.id+"_modal_form"),s=l("input[name=filterLang][checked]",o);!s.length||s.data("include")||s.is(":disabled")||s.prop("disabled","disabled");var p=!0;C.forEach(function(a,i){a.filterType==t&&a.value==r&&(C.splice(i,1),l("#"+e.id+"_"+t+"_"+r).prop("checked",!1),p=!1)}),p&&C.push({"filterType":t,"value":r,"label":n}),h(o[0]),s.prop("disabled",void 0),i.fireEvent("review_filters.filter_changed")}function u(a){var t=l("#"+e.id+"_modal_form");a=l(a);var r=l("#"+e.id+"_filterLang_ALL");!a.prop("defaultChecked")||r.is(a)||r.is(":disabled")||(a.prop("checked",!1),r.prop("defaultChecked",!0),r.prop("checked",!0));var n=a.prop("checked");a.prop("defaultChecked")!==n&&(a.prop("defaultChecked",n),a.data("include",!0),i.fireEvent("prodp13n.review_filter_controls.languageChanged"),h(t[0],{whiteBoxTopElmt:l(".ratings_and_types .ppr_rup",l("#REVIEWS")).get(0),loadingBoxTopElmt:e.id}))}function v(e,a,i){var t=[];t.push('<span class="filterTag" data-filter-type="'+e+'" data-filter-value="'+a+'" data-filter-label="'+i+'">'),t.push('<span class="filterTagText">'+i+"</span>"),t.push('<span class="ui_icon times"></span>'),t.push("</span>");var r=t.join("");l("#filtersContainer").append(r);var n=l("."+e+" .appliedFilters"),o=n.html();n.html((o?o+", ":"")+i)}function h(e,l){return ta.page&&ta.page.applyReviewFiltersForm?ta.page.applyReviewFiltersForm(e,l):void(ta.servlet.Reviews.filterReviews&&ta.servlet.Reviews.filterReviews(e,l))}function g(e){var l=e.filterType,a=e.value,i=e.label,t=!0;l==k?m():C.forEach(function(e,r){l==e.filterType&&a==e.value&&i==e.label&&(C.splice(r,1),t=!1)}),t&&C.push({"filterType":l,"value":a,"label":i}),b(),_()}function y(e){var l=e.filterType,a=e.value,t=e.label;l==k?m():C.forEach(function(e,i){l==e.filterType&&a==e.value&&t==e.label&&C.splice(i,1)}),b(),_(),i.off("removeFilterTag",y)}function T(){var e=l(E)[0];if(e){var a=e.getAttribute("data-div-classes");w=new t(null,r(null,null,"right no_padding "+a,null,null,e,"div"),o.framed(null,!0),s,p,f("light"))}w.show()}function _(){C.forEach(function(e){v(e.filterType,e.value,e.label)}),l(".filterTag .ui_icon.times").click(function(){var e=l(this).closest(".filterTag"),a=e.data("filterType"),t=e.data("filterValue"),r=e.data("filterLabel");a==k?(C.forEach(function(e,l){e.filterType==a&&e.value==t&&e.label==r&&C.splice(l,1)}),i.fireEvent("filterTagCleared",r)):c(this,a,t,r),e.hide()})}function m(){C.forEach(function(e,l){e.filterType==k&&C.splice(l,1)})}function b(){l(".filterTag").hide()}var w,E=".filter_overlay_content",k="keywordSearch",C=[];return i.on("addFilterTag",g),i.on("removeFilterTag",y),i.on("reviewListUpdated",function(){w&&w.hide(),b(),_()}),{toggleFilter:c,toggleLanguageAndTrack:u,showFilterOverlay:T}})});
define("ta/util/Deferred",["vanillajs","ns-exporter"],function(e,r){"use strict";function t(e){l.prototype[e]=function(r,t){return i(this,e,t?r.bind(t):r)}}for(var n=["success","failure","always","progress"],u={resolved:["success","always"],rejected:["failure","always"]},l=function(){},a=0;a<n.length;a++)t(n[a]);l.prototype.then=function(e,r){var t=this.success(e);return r?t.failure(r):t};var o=function(e){var r="pending",t=new l;t.queue=[],t.args=null,t.aplus="boolean"==typeof e&&e,t.status=function(){return r};var n={notify:function(){if(s(r))throw new Error("Promise has already been fulfilled.");var e,n,u,l=Array.prototype.slice.call(arguments);for(n=0,u=t.queue.length;n<u;n++)e=t.queue[n],"progress"===e.hook&&e.callback.apply(null,l);return t},resolve:function(){if(s(r))throw new Error("Promise has already been fulfilled.");return r="resolved",t.args=Array.prototype.slice.call(arguments),f(t)},reject:function(){if(s(r))throw new Error("Promise has already been fulfilled.");return r="rejected",t.args=Array.prototype.slice.call(arguments),f(t)},isFulfilled:function(){return s(r)},promise:function(){return t}};return n},s=function(e){return"resolved"===e||"rejected"===e},i=function(e,r,t){return e.fwd?i(e.fwd,r,t):(e.queue.push({hook:r,callback:t}),f(e))},f=function(e){if(e.fwd)return f(e.fwd);for(var r,t;s(e.status())&&(r=e.queue.shift());)~u[e.status()].indexOf(r.hook)&&(t=r.callback.apply(null,e.args),t instanceof l?(t.queue=t.queue.concat(e.queue.splice(0)),e=e.fwd=t):t&&e.aplus&&(e.args=[t]));return e};return r.createNs(o,"ta.util","Deferred"),o});
define("overlays/options/disablePageScroll",["vanillajs"],function(o){"use strict";return function(){function o(){document.body.style.position="absolute",document.body.style.overflow="hidden",document.body.style.width="100%"}function t(){document.body.style.position="relative",document.body.style.overflow="auto",document.body.style.width="auto"}this.on("show",o),this.on("hide",t)}});
define("utils/objutils",["utils/object/set-props","utils/object/shallow-copy","vanillajs"],function(r,t){"use strict";function e(){var r,t,n,o,i,f,u=arguments[0]||{},c=1,l=arguments.length,a=!1;for("boolean"==typeof u&&(a=u,u=arguments[c]||{},c++),"object"==typeof u||h(u)||(u={});c<l;c++)if(null!=(r=arguments[c]))for(t in r)n=u[t],o=r[t],u!==o&&(a&&o&&(j(o)||(i=y(o)))?(i?(i=!1,f=n&&y(n)?n:[]):f=n&&j(n)?n:{},u[t]=e(a,f,o)):void 0!==o&&(u[t]=o));return u}function n(r){if("object"!=typeof r||null===r||w(r))return r;for(var t in r)r.hasOwnProperty(t)&&(r[t]=n(r[t]));return d(r)}function o(r){if("object"!=typeof r||null===r)return r;for(var t in r)if(r.hasOwnProperty(t)){var e=r[t];null===e?delete r[t]:o(e)}return r}function i(r){var t;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){t=[];for(var e=0;e<r.length;++e)t.push(i(r[e]))}else{t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=i(r[n]))}return d(t)}function f(r){var t;if("object"!=typeof r||null===r)return r;if(r.constructor===Array){t=[];for(var e=0;e<r.length;++e)t.push(f(r[e]))}else{t={};for(var n in r)r.hasOwnProperty(n)&&(t[n]=f(r[n]))}return t}function u(r){var t;if("object"!=typeof r||null===r)return r;if(t=r,r.constructor===Array){P(r)&&(t=[],t.length=r.length);for(var e=0;e<r.length;++e)t[e]=u(r[e])}else{P(r)&&(t={});for(var n in r)r.hasOwnProperty(n)&&(t[n]=u(r[n]))}return t}function c(r,t){if(r!==t){if(!r)return!t;if(!t||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1}return!0}function l(r,t){if(r!==t){if(!r)return!t;if(!t)return!1;if(y(r)&&y(t))return c(r,t);var e=Object.keys(r);if(!c(e,Object.keys(t)))return!1;for(var n=0;n<e.length;n++)if(r[e[n]]!==t[e[n]])return!1}return!0}function a(r,t){var e,n,o={};for(e=0;e<r.length;++e)n=r[e],o[n[t]]=n;return o}function s(r,t){var e=r[t];if(!e&&!r.propertyIsEnumerable(t))throw"missing property: "+t;return e}function p(r,t){for(var e in r)r.hasOwnProperty(e)&&!t(r,r[e])&&delete r[e];return r}function y(r){return Array.isArray?Array.isArray(r):"[object Array]"===Object.prototype.toString.call(r)}function b(r,t,e){var n;if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,r,e);for(n=t.length,e=e?e<0?Math.max(0,n+e):e:0;e<n;e++)if(e in t&&t[e]===r)return e}return-1}function h(r){var t={};return r&&"[object Function]"===t.toString.call(r)}function j(r){var t,e;return!(!r||"[object Object]"!==Object.prototype.toString.call(r))&&(!(t=Object.getPrototypeOf(r))||(e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor,"function"==typeof e&&Object.toString.call(e)===Object.toString.call(Object)))}function v(r){var t=[];for(var e in r)r.hasOwnProperty(e)&&t.push(e);return t}function O(r,t){for(var e in r)if(r.hasOwnProperty(e)&&t(r[e],e,r))return r[e]}function g(r,t,e){var n,o=0,i=r.length,f=void 0===i||h(r);if(e)if(f){for(n in r)if(t.apply(r[n],e)===!1)break}else for(;o<i&&t.apply(r[o++],e)!==!1;);else if(f){for(n in r)if(t.call(r[n],n,r[n])===!1)break}else for(;o<i&&t.call(r[o],o,r[o++])!==!1;);return r}var d=function(r){return r},w=function(r){return!0},P=function(r){return!1};return"function"==typeof Object.freeze&&(d=Object.freeze.bind(Object),P=Object.isFrozen.bind(Object),w=Object.isFrozen.bind(Object)),{setProps:r,deepFreeze:n,deepFreezeCopy:i,unfreezeForDust:u,undefineNulls:o,shallowCopy:t,deepCopy:f,shallowEquals:l,index:a,need:s,filterProps:p,keys:v,isArray:y,inArray:b,isFunction:h,isPlainObject:j,each:g,extend:e,find:O}});
define("ta/common/Repoll",["vanillajs","utils/objutils","utils/urlutils","common/trackingStreams","ta/Core/TA.FireEvent"],function(e,t,n,r,a){var o=function(e){function o(e){if(e){var t=e.querySelectorAll("[data-targetEvent]");if(t){var n;try{n=Array.prototype.slice.call(t)}catch(e){n=[];for(var o=0;o<t.length;o++)n.push(t[o])}n.forEach(function(e){var t=e.getAttribute("data-targetEvent");if(t)try{a.fireEvent(t,e)}catch(e){r.error(e,{errorMessage:"ERROR in handler for "+t})}})}}}function i(){if(m==this&&4===this.readyState){if(M>0)return f=f||[],f.push(i.bind(this)),void(window.console&&console.log&&console.log("update held while updates are paused"));this.status>=200&&this.status<=299?K(this.response):D()}}function c(){switch(h||0){case 0:return 10;case 1:case 2:case 3:case 4:return 1e3;case 5:case 6:case 7:return 1500;case 8:case 9:case 10:return 2e3;case 11:return 5e3;case 12:return 9e3;case 13:return 1e4;case 14:return 11e3;case 15:return 12e3;default:return-1}}function s(){var e=A+"-changes-pending";w||m?a.fireEvent(e,t.extend({},T,g),m&&h>0?h:h+1):(a.fireEvent(e,{},-1),a.fireEvent(A+"-polling-complete"))}function l(){M=M>0?M+1:1}function u(){if(M>1)return void(M-=1);M=0;var e=f||[];f=null;for(var t;t=e.shift();)try{t()}catch(e){}}e=e||{};var d,p,f,h=1,v=0,m=null,g={},w=!1,y={},E={},T={},x=!!e.evaluateScripts,A=e.placement||"page",M=0,S=function(e){return e?decodeURIComponent(e.replace(/\+/g," ")):e},b=function(e){var t,n;d=e.split("#")[0],p=d.split("?")[0],t=d.split("?")[1]||"",n=t.split("&");for(var r=0;r<n.length;r++){var a=n[r].split("=");a[0]&&(y[decodeURIComponent(a[0])]=S(a[1]))}},R=function(e){F(!!e,[])},j=function(e,t){N(y,e)&&F(!0,t)},q=function(e,t){N(y,e)&&t&&(h=0)},H=function(){return y},P=function(e,t){N(E,e||{}),F(!0,t)},L=function(e){for(var t=e.length-1;t>=0;t--){var n=e[t];delete y[n]}},N=function(e,t){if(!t)return!1;for(var n=!1,r=Object.keys(t||{}),a=r.length-1;a>=0;a--){var o=r[a];e[o]!==t[o]&&(n=!0),e[o]=t[o]}return n},C=function(){F(!1)},X=function(e){var t,n,r,a=(e&&e.getAttribute("data-paramNames")||"").split(",");for(t=0;t<a.length;t++)r=a[t].trim(),r&&(n=e.getAttribute("data-"+r),n?y[r]=n:delete y[r])},O=function(){return!(!m&&!w)},U=function(){return h},W=function(e){x=!!e},k=function(){return x},F=function(e,n){var r,o=!w;if(n?"string"==typeof n&&(n=[n]):n=e?["UNKNOWN"]:[],t.each(n,function(e,t){!T[t]&&(o=!0),T[t]=!0}),!w||e&&0!==h){e&&(h=0);var i=c();i>=0?(w=!0,r=++v,window.setTimeout(function(){I(r)},i),o&&s()):(a.fireEvent("hac-could-not-complete"),D())}},I=function(e){if(!m&&w&&e===v){if(M>0)return f=f||[],f.push(I.bind(this,e)),void(window.console&&console.log&&console.log("request held while updates are paused"));var r=++h,a=t.extend({},y,E),o=null;a.reqNum=r,T.UNKNOWN||(o=[],t.each(T,function(e,t){t&&o.push(e)}),a.changeSet=o.toString()),ta&&ta.uid&&(a.puid=ta.uid),w=!1,E={},g=T,T={};var c;try{c=new XMLHttpRequest}catch(e){try{c=new ActiveXObject("MSXML2.XMLHTTP")}catch(e){try{c=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Can't create XMLHttpRequest or similar")}}}c.onreadystatechange=i.bind(c),c.open("POST",p,!0),"responseType"in c&&(c.responseType="document");try{c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(e){}try{c.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(e){}try{c.setRequestHeader("Accept","text/html, */*")}catch(e){}c.send(n.toQueryString(a)),m=c}},K=function(e){if(M>0)return f=f||[],f.push(K.bind(this,e)),void(window.console&&console.log&&console.log("update held while updates are paused"));var t;"string"==typeof e?(t=document.createElement("div"),t.innerHTML=e):t=e;var n=w;if(m=null,g={},x){var r=t.querySelectorAll("script");r=r?Array.prototype.slice.call(r):[];for(var i=0;i<r.length;++i){var c=r[i];if(c.parentNode.removeChild(c),c.innerHTML)if(window.execScript)window.execScript(c.innerHTML);else if(window.eval)window.eval(c.innerHTML);else{var l=document.createElement("script");l.setAttribute("type","text/javascript"),l.text=c.innerHTML,document.head.appendChild(l),document.head.removeChild(l)}}}o(t),"page"===A&&(t.querySelector('[data-targetEvent="'+A+'-repoll-not-done"]')||a.fireEvent("MetaFetchComplete")),m=null,n&&I(++v),s()},D=function(){if(M>0)return f=f||[],f.push(D.bind(this)),void(window.console&&console.log&&console.log("error held while updates are paused"));var e=w;m=null,g={},e?I(++v):a.fireEvent(A+"-repoll-failed"),s()};return a.on(A+"-repoll-not-done",C),a.on(A+"-repoll-ajax-params",X),b(e.pageUrl||window.location.href),e.ajaxParams&&(y=t.extend(y,e.ajaxParams)),setTimeout(function(){O()||a.fireEvent(A+"-polling-complete")},0),{setPageUrl:b,repoll:R,pause:l,resume:u,getAjaxParams:H,setAjaxParams:j,setAjaxParamsNoPoll:q,setOneTimeParams:P,removeAjaxParams:L,setNotDone:C,isUpdatePending:O,getLastRequestNum:U,setScriptsEval:W,isScriptsEvalEnabled:k,fireTargetEvents:o}};return o});
define("trcore",["vanillajs","ns-exporter","ta/util/Cookie"],function(e,n,t){function o(e,n){window.addEventListener?window.addEventListener(e,n):window.attachEvent&&window.attachEvent("on"+e,n)}var i={};return i.registerOnLoad=function(e,n){require.defined("ta/Core/TA.Event")?require("ta/Core/TA.Event").queueForLoad(e,n):o("load",e)},i.registerOnUnload=function(e){o("unload",e)},i.getScrollOffset=function(){return[window.pageXOffset||document.documentElement.scrollLeft,window.pageYOffset||document.documentElement.scrollTop]},i.setOneTimeCookie=function(e,n){return t.write(e,n,5e3,null,cookieDomain),!0},i.setOneTimeCookieOnFQDN=function(e,n){return t.write(e,n,5e3),!0},n.exportTo(i,window||global),i});
define("ta/common/Search",["lib/jquery-amd","ta/Core/TA.Store","ta/common/Repoll","ta/util/Error","trcore","utils/ajax","ns-exporter"],function(e,a,r,t,n,o,s){var i={ta_repoll:null,getRepoll:function(){return this.ta_repoll||(this.ta_repoll=r()),this.ta_repoll},langSelect:function(e,a){a.form.elements.q.value.length>0&&a.form.submit()},useCurrentLocation:function(a){e(".locNotFound.hidden").removeClass("hidden")},clearOnFocus:function(a,r){r.value==r.defaultValue&&(r.value="",e(r).removeClass("focusClear"))},defaultOnBlur:function(a,r){""==r.value&&(e(r).addClass("focusClear"),r.value=r.defaultValue)},getFormFields:function(e){for(var a={},r=0;r<e.elements.length;++r){var t=e.elements[r];""!==t.name&&"INPUT"===t.nodeName&&t.value&&(a[t.name]=t.value)}return a},getUrlFromForm:function(e){if(!e)return"";var a=e.action,r=i.getFormFields(e),t=[];for(var n in r)t.push(encodeURIComponent(n)+"="+encodeURIComponent(r[n]));return a+"?"+t.join("&")},validate:function(a,r){return""!=r.q.value.trim()&&!e(r.q).hasClass("focusClear")&&(n.setOneTimeCookie("SRCHACT","NEW"),!0)},recordAndValidate:function(r,t,n,s,l){if(n||i.validate(r,t)){s=s||a.retrieve("ta_typeahead_widget");var c=function(){if(s&&s.options&&s.options.onSubmit){var e=i.getUrlFromForm(t),a=r?r.type:"";s.options.onSubmit(s,e,l,a)}t.submit()};if(s&&s.options&&s.options.skipRecordAfterValidate)return s.hide(),c(),!1;var d=s&&s.options?s.options.startTime:void 0,u=s?s.lastSuccessfulQuery:void 0,h=s&&s.options&&s.options.geoId,p=s&&s.options?s.options.name:void 0,m=s&&s.historyShown;e("#MASTAHEAD_TYPEAHEAD_START_TIME").val(d),e("#MASTAHEAD_TYPEAHEAD_UI_ORIGIN").val(p),s&&s.hide();var v=s&&s.options?s.options.searchSessionId:void 0;v||(v="no_search_session_id"),l?c():o("/TypeAheadJson",{method:"GET",data:{action:"RECORD",eventType:"search_bttn",startTime:d,source:p,query:u,uiOrigin:p,global:!h||"Search"==pageServlet,scope:h&&"Search"!=pageServlet?h:"G",hadHistory:m,searchSessionId:v},complete:c})}return!1},selectLang:function(a,r){try{var n=e("#SEARCH_LANG_SELECT_POPUP");if(n.hasClass("hidden"))n.removeClass("hidden");else{var o=e("#SEARCH_LANG_SELECT_INPUT"),s=e("#SEARCH_LANG_SELECTED");if(o.length){var i=r.id.match(/lang_(.+)/);if(i){var l=i[1];o.val("all"==l?"":l)}s&&i&&(e(".langSelectOption",n).removeClass("selected"),e(r).addClass("selected"))}n.addClass("hidden")}}catch(e){t.record(e,"select search lang")}},reviews:function(e,a){return o("/ActionRecord?action=SearchReviews"),!1},replaceOrAddParam:function(e,a){var r=a.split("="),t=r[0],n=(r[1],new RegExp("([\\?#&])("+t+"=\\w+)")),o=n.exec(e);return o?e.replace(n,"$1"+a):e+"&"+a},extractParam:function(e,a,r){var t=new RegExp("[\\?#&]"+a+"=(\\w+)"),n=t.exec(e);return n?n[1]:r||null},selectOption:function(a,r){var n=e(r),o=n.closest("form");try{var s=function(e){var a=e.match(/([\d.]+)px/);return a?parseFloat(a):0},l=e(".SEARCH_SELECT_POPUP",o),c=e(".SEARCH_SELECTED",o);if(l.hasClass("hidden"))l.removeClass("hidden"),c.length&&(i.width=s(c.css("width")));else{l.addClass("hidden");var d=e(".SEARCH_SELECT_INPUT",o);if(d&&(d.val(n.hasClass("lang_all")?1:2),c.html(n.html())),c.length){var u=i.width,h=s(c.css("width")),p=Math.max(u,h);c.css("width",p+"px")}}}catch(e){t.record(e,"select search lang")}},buildSearchHref:function(e,r,t,n){var o=window.location.hash,t=t||0;e&&(o=i.replaceOrAddParam(o,"ssrc="+e)),n&&(o=i.replaceOrAddParam(o,"dist="+n)),o=i.replaceOrAddParam(o,"o="+t),window.location.hash=o;var s=a.retrieve("searchTrackingId"),l=a.retrieve("searchRefinementId"),c=a.retrieve("sessionId"),d=a.retrieve("searchSessionId"),u=window.location.href;return u=u.replace(/#.*/,""),s&&(u=i.replaceOrAddParam(u,"sid="+s)),l&&(u=i.replaceOrAddParam(u,"rf="+l)),c&&(u=i.replaceOrAddParam(u,"sessionId="+c)),d&&(u=i.replaceOrAddParam(u,"searchSessionId="+d)),e||(e=i.extractParam(o,"ssrc","a")),u=i.replaceOrAddParam(u,"actionType=updatePage"),u=i.replaceOrAddParam(u,"ssrc="+e),u=i.replaceOrAddParam(u,"dist="+n),u=i.replaceOrAddParam(u,"o="+t),u=i.replaceOrAddParam(u,"ajax=search")},loadSRPlacement:function(r){function t(){var r=0,t=e("input#searchCurrentPagePosition").val(),n=30;t&&(r=(t-1)*n);var o=e(".selected","#SEARCH_FILTERS_COLUMN"),s=o.length?o.prop("id"):"a",l=i.buildSearchHref(s,"PG",r),c=a.retrieve("resultCacheKey");return c&&(l+="&resultCacheKey="+c),l}if(a.retrieve("commerce_on_srp")&&ta.widgets.calendar.hasPageDates()){var n=e(".result.LODGING").length>0,o=0==e("#page-repoll-not-done").length;if(r||n&&!o){var s=t(),l=this.getRepoll();l.setPageUrl(s),l.setNotDone()}}}};return s.exportTo(i,"ta.common.search"),i});
define("ta/Browser",["vanillajs","ns-exporter"],function(e,n){var t,r={},i=function(){return navigator.userAgent.indexOf("MSIE 10.0")>=0},o=r.isIE11orHigher=function(){return navigator.userAgent.toLowerCase().indexOf("trident/7.")>-1||navigator.userAgent.toLowerCase().indexOf("msie 11.")>-1};return r.isIE9orHigher=function(){return navigator.appVersion.indexOf("MSIE 9")>=0||i()||o()},r.isIE10Metro=function(){return i()&&r.isIEMetro()},r.isIEMetro=function(){var e=null,n=o(),t=n?127:0,r=window.innerWidth==screen.width&&screen.height-window.innerHeight===t;try{e=!!new ActiveXObject("htmlfile")}catch(n){e=!1}return!e&&r&&(n||i())},r.isIE=function(){return navigator.userAgent.indexOf("MSIE")>=0},r.isChrome=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},r.getFlashVersion=function(){if("number"!=typeof t){var e;try{e=navigator.plugins["Shockwave Flash"].description}catch(n){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){}}var n=(e||"0 r0").match(/\d+/g);t=Number(n[0]||"0."+n[1])||0}return t},r.isChromeIncognito=function(e){var n=window.RequestFileSystem||window.webkitRequestFileSystem;return n&&"function"==typeof n?void n(window.TEMPORARY,100,function(){e("normal")},function(){e("incognito")}):void e("undetermined")},n.exportTo(r,"ta.browser"),r});
define("ta/util/String",["vanillajs"],function(t){var e={getColumns:function(t){if(!t||!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n]>=8192&&t[n]<65279||t[n]>65280&&t[n]<65376?2:1;return e},abbreviate:function(t,n){if(arguments.length>2)for(var r=2;r<arguments.length;r++)n-=e.getColumns(arguments[r]);return t.length-n<3?t:t.slice(0,n)+"&#8230;"},lowerCaseNoSpace:function(t){return t&&"[object String]"===Object.prototype.toString.call(t)?t.toLowerCase().replace(/ /g,""):""},stripHTMLFromText:function(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText||e.textContent}};return e});
define("typeahead/TypeAhead.utils",["vanillajs","ta/util/Deferred","utils/ajax"],function(e,t,o){var r={};return r.query=function(e,r,n,a,i,l,s,u,c,d,g){return function(e){var h=t(),_={query:e,action:"API",startTime:this.startTime,uiOrigin:this.name,source:this.name,interleaved:!0,geoPages:!i,flightsToPages:!i,nearPages:!1,details:!0,types:r||"geo,hotel,eat,attr,vr",link_type:a||r||"geo,hotel,eat,attr",max:l||12,neighborhood_geos:!!u,requiredFields:s};return""!==n?(_.nearby=!0,_.local=!0,_.parentids=n):_.global=!0,d&&""!==d&&(_.scopeFilter=d),g&&"[object Array]"===Object.prototype.toString.call(g)&&g.length>0&&(_.filter=g.join(",")),new o({method:"GET",url:"/TypeAheadJson",data:_,error:function(){c?h.reject(JS_location_not_found):h.reject(JS_location_not_found)},success:function(e){c?e&&e.results&&e.results.length>0&&h.resolve(e)||h.reject(JS_location_not_found):e&&h.resolve(e)||h.reject(JS_location_not_found)}}),h.promise()}},r});
define("typeahead/TypeAhead.views",["vanillajs","ta/util/Deferred","utils/object/set-props"],function(e,s,t){var a={};a.iconMap={ALL:"sprite-typeahead-all",GEO:"sprite-typeahead-destination",HOTELOVERVIEW:"sprite-typeahead-destination",HOTEL:"sprite-typeahead-hotel",ATTRACTION:"sprite-typeahead-attraction",EATERY:"sprite-typeahead-restaurant",VACATION_RENTAL:"sprite-typeahead-vr",FLIGHTS_TO:"sprite-typeahead-flight",AIRPORT:"sprite-typeahead-flight",AIRLINE:"sprite-typeahead-flight",THEME_PARK:"sprite-typeahead-themepark",VACATION_PACKAGE:"sprite-typeahead-hotel",SMART_DEAL:"sprite-typeahead-hotel",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"sprite-typeahead-neighborhood",TRAVEL_GUIDE:"sprite-typeahead-travel-guide"},a.iconFontMap={ALL:"ui_icon globe-world",GEO:"ui_icon map-pin-fill",HOTELOVERVIEW:"ui_icon map-pin-fill",HOTEL:"ui_icon hotels",ATTRACTION:"ui_icon attractions",EATERY:"ui_icon restaurants",VACATION_RENTAL:"ui_icon vacation-rentals",FLIGHTS_TO:"ui_icon flights",AIRPORT:"ui_icon flights",THEME_PARK:"ui_icon amusement-parks",VACATION_PACKAGE:"ui_icon hotels",SMART_DEAL:"ui_icon hotels",CHILD_TOP:"sprite-typeahead-connector-top",CHILD_BOTTOM:"sprite-typeahead-connector-bottom",NEIGHBORHOOD:"ui_icon neighborhoods",TRAVEL_GUIDE:"ui_icon guides",AIRLINE:"ui_icon flights",KEYWORD:"ui_icon search",TAG:"ui_icon search",ACTIVITY:"ui_icon activities",NEARBY:"ui_icon nearby-fill",NEAR_POI:"ui_icon map-pin-fill",UNIVERSITY:"ui_icon classes-workshops",TRAIN_STATION:"ui_icon train"};var i={PAGE:!0,BLENDER_PAGE:!0,NEAR_POI:!0,VACATION_PACKAGE:!0,SMART_DEAL:!0,FLIGHTS_TO:!0},r={FLIGHTS_TO:!0,VACATION_PACKAGE:!0};a.escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00A0/g,"&nbsp;").replace(/"/g,"&quot;")};var n=function(e,s){var t={},a=[];return e.forEach(function(e){var s=e.type;t[s]=t[s]||[],t[s].push(e)}),s.forEach(function(e){var s=t[e];if(s)for(var i=0;i<s.length;i++)a.push(s[i])}),a};a.configTypeAheadOptionsForSortingByPOIType=function(e,t){var i=e.postResultsFnList||[];i.push(function(e){var a=s();return e.results=n(e.results,t),a.resolve(e),a.promise()}),e.postResultsFnList=i,e.listTemplate=function(e){var s=e.results,t=[];if(s.length>0){t.push("<ul>"),s.forEach(function(){var e="";return function(s){if(e!=s.type){e=s.type;var t=[s.rendered];t.push('<span class="label">'),t.push(s.title),t.push('<img src="/img2/x.gif" class="icon hidden" alt="">'),t.push("</span>"),s.rendered=t.join("")}}}());var i=function(){var e="",s=document.createElement("div");return function(t){var i='<li class="typeahead-choice '+a.escapeHTML(t.title.toLowerCase())+'">'+t.rendered+"</li>";return e!=t.type&&(e=t.type,s.innerHTML=i,s.firstChild.className+=" first",i=s.innerHTML),i}}();t.push(s.map(i).join("")),t.push("</ul>")}return t.join("")}};var o={showChildren:!1,tagLabels:null,poiClasses:"",geoClasses:""};a.itemTemplate=function(e){e=t(o,e);var s=e.useIconFont,n=s?a.iconFontMap:a.iconMap;return function(t,o){var l,p=[];l=t.isNeighborhood?n.NEIGHBORHOOD:"NEAR_POI"===t.data_type?n.NEAR_POI:"TAG"==t.data_type?n[t.data_type]:n[t.type],o=o||{};var u=t.icon_type||t.data_type;if(u&&r[u.toUpperCase()]&&(l=n[u.toUpperCase()]),!s&&l&&u&&i[u]&&(l+="-list"),l){var c=(s?"":"sprite-image ")+"leftIcon "+l;p.push('<div class="'+c+'"></div>')}var h;if(e.tagLabels){var d=e.tagLabels;t.isChild&&t.parent&&t.parent.moved?h=d.newLocation:t.moved===!0?h=d.moved:t.closed===!0&&(h=d.closed),h&&p.push('<span class="search-tagged-poi" >'+h+"</span>")}var v=t.details||t,g=v.highlighted_name||v.name||"",f="TAG"===t.data_type||"local_tag"===t.scope||"overview"===t.scope||e.simpleChild&&t.isChild,y=f?"":v.geo_name||"";"NEAR_POI"===t.data_type&&(g=t.find_near_name),o.HTMLEscape&&(g=a.escapeHTML(g),y=a.escapeHTML(y));var T="poi-name "+e.poiClasses;y||(T+=" no-geo"),"NEAR_POI"===t.data_type&&(T+=" near_poi");var _="geo-name "+e.geoClasses;if(p.push('<span class="'+T+'">'),e.debug&&(p.push('<span class="debug">'),p.push("number"==typeof t.order?t.order:"??"),p.push("("+("number"==typeof t.score?t.score:"??")+")"),p.push("&nbsp;</span>")),p.push(g),p.push("</span>"),p.push('<span class="'+_+'">'+y+"</span>"),p.push(),e.showChildren&&t.isChild){p.unshift('<div class="child">'),p.push("</div>");var A=t.lastChild?n.CHILD_BOTTOM:n.CHILD_TOP,E="sprite-image childIcon leftIcon "+A;p.unshift('<div class="'+E+'"></div>')}return p.join("")}},a.configureTypeAheadForSegmentedResults=function(e,t){var i=t||{},r=i.boldSearchQuery,n=i.groupByScope,o=e.postResultsFnList||[],p="search",u="history",c="suggested",h="overview",d="global",v="local",g=function(e){var s={},t=function(e){return e.type&&"SEARCH"===e.type.toUpperCase()&&e.name?p:"history"==e.scope?u:"suggested"==e.scope?c:"overview"==e.scope?h:e.scope&&0===e.scope.lastIndexOf("local",0)?v:n&&"global"==e.scope?v:d};return e.forEach(function(e){var a=t(e);if("history"!==a||!e.isChild){var i=s[a]=s[a]||[];i.push(e)}}),s};return o.push(function(e){var t=s();return i.debug&&e.results.forEach(function(e,s){e.order=s}),e.results=function(e){var s=[];e.forEach(function(e){if(s.push(e),e.children)for(var t=e.children.length,a=0;a<t;a++){var i=e.children[a];i.scope=e.scope,i.parent=e,s.push(i)}});for(var t=g(s),a=[],i=[h,u,c,v,d,p],r=0;r<i.length;r++){var n,o=i[r];n=o==v?t[o]?[].concat.apply([],l(t[o])):[]:t[o],n&&(a=a.concat(n))}return a}(e.results),t.resolve(e),t.promise()}),e.postResultsFnList=o,e.listTemplate=function(e){var s=[],t=e.results,n=g(t),o=!1,l=!1,f=!1,y=0==t.length,T=!(e.query&&e.query.query||n[v]&&0!==n[v].length||n[d]&&0!==n[d].length),_=function(e,t){var a="resultContainer"+(t?" "+t:"");s.push('<ul class="'+a+'">');for(var i=0;i<e.length;i++){var r=e[i];r&&(s.push('<li class="'+(r.wrapperCSS||"")+'">'),s.push(r.rendered),s.push("</li>"))}s.push("</ul>")};if(n[h]&&n[h].length>0&&(f=!0,i.overviewLabel&&s.push('<div class="title overview">'+i.overviewLabel+"</div>"),_(n[h],"overview")),n[u]&&n[u].length>0&&(o=!0,i.historyLabel&&s.push('<div class="title history">'+i.historyLabel+"</div>"),_(n[u],e.query?null:"history bold_names")),n[c]&&n[c].length>0&&(s.push('<div class="title history">'+i.suggestedLabel+"</div>"),_(n[c],"suggested")),!T&&i.localLabel&&(n[v]&&n[v].length>0||i.noResultsMessage&&!f)&&(l=!0),n[v]&&n[v].length>0?(l=!0,_(n[v],"local")):l&&i.showNoResultsMessage&&s.push('<div class="no-results">'+i.noResultsMessage+"</div>"),n[d]&&n[d].length>0&&(i.globalLabel&&(l||o)&&s.push('<div class="title global">'+i.globalLabel+"</div>"),_(n[d],"global")),!T&&n[p]&&n[p].length>0){var A=n[p][0],E=e.query&&e.query.query||"",m="search resultContainer";A.noResults&&(m+=" noResults"),r?s.push('<ul class="'+m+'"><li class="searchRow">'+A.name.replace("%","<b>"+a.escapeHTML(E)+"</b>")+"</div></li></ul>"):s.push('<ul class="'+m+'"><li class="searchRow">'+a.escapeHTML(A.name.replace("%",E))+" &raquo;</div></li></ul>")}return y&&!T&&i.showNoResultsMessage&&i.noResultsMessage&&s.push('<div class="no-results">'+i.noResultsMessage+"</div>"),s.join("")},i},a.simpleItemTemplate=function(){return function(e){return[e.details.name,'<span class="addr">',e.details.address,"</span>"].join("")}},a.simpleListTemplate=function(e){return function(s){if(!s.results||!s.results.length)return'<div class="noResults">'+e+"</div>";var t,a=s.results||[],i=["<ul>"];return a.forEach(function(e){i.push("<li>"),e.title!==t&&(t=e.title,i.push('<span class="label">',t,'<img src="/img2/icons/typeahead/',e.type.slice(0,1).toLowerCase(),'.gif"/></span>')),i.push(e.rendered),i.push("</li>")}),i.push("</ul>"),i.join("")}},a.ptptListTemplate=function(e){function s(e){var s="history"==e.scope,t=e.type?e.type.toLowerCase():"",a=s?"history":t;return{historyScope:s,choiceType:t,headerType:a}}for(var t=['<div class="typeahead-choices">'],a={},i={history:!0},r=CDNHOST+"/img2/x.gif",n=e.results,o=n.length,l=0;l<o;l++){var p=n[l],u=s(p),c="typeahead-choice "+u.choiceType,h=!1;u.headerType in a||(c+=" first",a[u.headerType]=!0,h=!0),u.historyScope&&(c+=" history"),t.push('<div class="'+c+'">'),t.push('<img src="'+r+'" class="icon" alt="">'),t.push('<span class="cutoff">'),t.push(p.rendered),t.push("</span>"),u.historyScope&&t.push('<img src="'+r+'" class="history_icon" alt="">'),t.push("</div>");var d=n[l+1],v=d&&s(d);v&&i[u.headerType]&&v.headerType!=u.headerType&&t.push('<div class="divider"></div>')}return t.push("</div>"),t.join("")};var l=function(e){for(var s,t={},a=0,i=0;i<e.length;i++){var r=e[i],n=/(global|local)(_(.*))?/.exec(r.scope),o=n&&n.length>3?n[3]:r.scope;r.isChild&&s?t[s].push(r):(s="tag"===o||"keyword"===o?"common_group":r.type,t[s]||(t[s]=[a++,s]),t[s].push(r))}var l=function(e){var s,t=[],a=[];for(s in e)e.hasOwnProperty(s)&&a.push(e[s]);a=a.sort(function(e,s){if(e.length<=1)return-1;if(s.length<=1)return 1;if(e[1]!=s[1]){if("common_group"==e[1])return-1;if("common_group"==s[1])return 1}return e[0]-s[0]});for(var i=0;i<a.length;i++)t.push(a[i].slice(2));return t};return l(t)};return a});
define("lib/TypeAhead",["lib/jquery-amd","api-mod","ta/util/Deferred","utils/ajax","ta/common/Search","ta/Core/TA.Record","ta/Browser","utils/browserutils","ta/util/String","ns-exporter","typeahead/TypeAhead.utils","typeahead/TypeAhead.views"],function(R,g,N,S,Z,M,an,am,d,m,ae,aj){var h={};var L={results:null,showOnEmpty:false,integrate:false,highlight:false,maxItems:5,types:["geo","eatery","hotel","attraction"],linkType:"url",predicate:null,minChars:null,sort:null,shouldReplace:true,getMatchingKey:function(ao){return ao.value},bottom:false};var ag={minChars:1,search:null,itemTemplate:function(ao){return ao&&ao.value},listTemplate:function(ap){var ao=ap.results?ap.results:ap;return'<div class="typeahead-choices">'+ao.map(function(ar,aq){return'<div class="typeahead-choice">'+ar.rendered+"</div>"}).join("")+"</div>"},errorTemplate:function(ao){return'<div class="message">'+ao+"</div>"},resolveSelection:function(ao){return ao&&ao.value},equal:function(ap,ao){return ap.value==ao.value},shouldSubmit:function(){return true},validator:null,containerClass:"typeahead-container",itemSelector:".typeahead-choice",errorClass:"error",defaultTextClass:false,defaultValue:null,width:true,showOnFocus:true,searchOnFocus:true,onUserFocus:null,autoSelectFirst:false,selectOnBlur:true,assumeOnBlur:true,onUserBlur:null,restoreOnFocus:false,cycleInput:true,autopopulateHighlighted:true,selectInputText:true,onSelect:null,onRestore:null,onSync:null,onRender:null,onShow:null,onHide:null,onError:null,nextField:null,offsetY:0,offsetX:0,syncro:null,containerParent:document.body,positionRelative:false,unselectOnEscape:false,cacheResults:false,autoHighlightFirst:false,ignoreKeysWhenInvisible:false,name:"unknown",geoId:undefined,startEventOn:"focus",queryLengthLimit:100,postResultsFnList:null,jpFirefoxIME:false,jpFirefoxIMEInterval:500,clearDefaultTextOnFocus:true,focusOnCreation:false,searchParams:null,errorOnSearchFailure:"error",enableQueryDelay:false,throttleRequests:false,doSelectionBeforeLogging:false,highlightInputOnFocus:false,staticResults:null,isOverlay:true,selectFirstOnMouseOut:false},ai=8,ab=9,Q=13,t=16,o=17,q=18,O=20,r=27,E=37,ac=38,I=39,K=40,F=46,G=91,f="click",y="enter",z="tab";var a=function(ao){return(ao&&ao.searchSessionId)?ao.searchSessionId:"no_search_session_id"};var n;var J=function(){if(n){if(typeof n.abort==="function"){try{n.abort()}catch(ao){}}n=null}};var s=function(ao){n=ao};var Y=function(ap){J();var ao=N();var at=this.getSearchParams();var aq=this;at.query=ap;at.action="API";at.uiOrigin=this.options.name;at.source=this.options.name;at.startTime=this.options.startTime;at.searchSessionId=a(this.options);var ar={method:"GET",url:"/TypeAheadJson",data:at};if(this.options.throttleRequests){ar.beforeSend=function(au){s(au)}}ar.success=function(av,aw){if(aw==="success"){if(av){var au=!!av.results;if(!au){av={results:av,query:{query:ap}}}ao.resolve(av)}}};S(ar);return ao.promise()};var X=function(){return this.source.value};var k=function(aq){var ao=0;for(var ap=this.source.value.length-1;ap>=0;ap--){ao++;var ar=this.source.value.charCodeAt(ap);if((ar>=19968&&ar<=40959)||(ar>=12352&&ar<=12543)||(ar>=44032&&ar<=55295)){ao++}if(!aq&&ao>=this.options.minChars){return true}}return aq?ao:false};var x=function(){var ap=this.source;var ao=undefined;if(this.hasDefaultText()){if(this.options.clearDefaultTextOnFocus===true){ao=ap.value.length}else{ao=0}}else{if(this.options.highlightInputOnFocus){ao=ap.value.length}}if(ao!==undefined){setTimeout(function(){if(document.activeElement==ap){ap.setSelectionRange(0,ao)}},0)}};var l=function(aq){if(this.composing){return}if(this.hasDefaultText()&&this.options.clearDefaultTextOnFocus!==true){this.options.defaultTextClass&&R(this.source).removeClass(this.options.defaultTextClass);this.source.value=""}if(this.options.startEventOn==="type"){p.call(this)}if(this.options.ignoreKeysWhenInvisible&&!this.visible){return}switch(aq.keyCode){case Q:aq.preventDefault();aq.stopPropagation();if(this.selectedIndex>=0){this.select(true,y,aq);H.call(this)}else{if(this.options.assumeOnBlur&&this.results&&this.results.length){if(typeof this.options.assumeOnBlur=="function"){this.setSelectedIndex(this.options.assumeOnBlur(this))}else{this.setSelectedIndex(0)}ah.call(this);this.select(true,y,aq);H.call(this)}if(this.options.shouldSubmit()){if(!this.options.validator||this.options.validator(aq)){if(this.options.onSubmit){var ap=Z.getUrlFromForm(this.source.form);var ao=event?event.type:"";this.options.onSubmit(this,ap,true,ao)}this.abortSearch();this.hide();this.source.form.submit()}}}break;case K:this.highlightNextChoice();aq.preventDefault();aq.stopPropagation();break;case ac:this.hightlightPreviousChoice();aq.preventDefault();aq.stopPropagation();break;case r:this.restore();this.hide();break;case ab:if(this.options.selectOnTab&&this.selectedIndex>=0&&!this.ignoreSelectOnTab){aq.preventDefault();aq.stopPropagation();this.select(true,z,aq);H.call(this)}else{this.tabPressed=true}break}if(this.options.onKeyDown){this.options.onKeyDown(aq,this)}};var aa=function(ao){setTimeout(W.bind(this),0)};var c=function(ao){if(this.composing){return}if(ao){switch(ao.keyCode){case ab:case t:case o:case q:case O:case E:case ac:case I:case K:case G:case Q:case r:return}}W.call(this)};var A=function(){this.composing=true};var af=function(){this.composing=false;W.call(this)};var j=function(){var ao=this.source.value;if(this.intervalHandler){window.clearTimeout(this.intervalHandler)}if(!this.options.enableQueryDelay||this.lastQueryTime+500<=new Date().getTime()){this.intervalHandler=null;this.search()}else{this.intervalHandler=setTimeout(function(){if(!this.aborted&&this.source.value===ao){this.search()}}.bind(this),this.options.throttleRequests?50:300)}};var D=function(){var ao=this.results&&this.results.length===0;return !this.hasDefaultText()&&k.call(this)&&this.source.value!==this.query&&(this.selectedIndex<0||!this.results||ao||this.source.value!==this.results[this.selectedIndex].value)};var W=function(){J();var ao=k.call(this,true);if(!D.call(this)&&ao<this.options.minChars){if(ao===0){if(typeof this.options.clearquery==="function"){this.options.clearquery(this)}}this.selected&&R(this.selected).removeClass("selected");R(this.source).removeClass(this.options.errorClass);this.results=null;this.error=null;this.setSelectedIndex(-1);this.selected=null;this.query=null;this.staticResultsShown=null;var ap=this.source&&(!this.source.value||U(this.source.value).trim().length==0);if(this.shouldShowStaticResults()&&(ap||this.hasDefaultText())){this.showStaticResultsIfEnabled()}else{this.hide()}}else{j.call(this,this.query)}};var V=function(ao){if(!(this.results&&this.results.length)){return}this.setSelectedIndex(this.selectedIndex+ao);if(this.selectedIndex>=this.results.length){this.setSelectedIndex(this.options.cycleInput?-1:0)}else{if(this.selectedIndex<(this.options.cycleInput?-1:0)){this.setSelectedIndex(this.results.length-1)}}ah.call(this)};var ah=function(ao){this.ignoreSelectOnTab=ao&&this.options.selectFirstOnMouseOut;this.selected&&R(this.selected).removeClass("selected");if(-1===this.selectedIndex){this.selected=null;this.options.autopopulateHighlighted&&this.query&&(this.source.value=this.query);this.options.selectInputText&&this.source.select(false)}else{this.selected=this.items[this.selectedIndex];g.addClass(this.selected,"selected");this.options.autopopulateHighlighted&&this.results&&(this.source.value=this.options.resolveSelection(this.results[this.selectedIndex]))}};var e=function(aq,ap){if(!ap){return false}for(var ao=0;ao<ap.length;++ao){var ar=ap[ao];if(ar&&ar.match(aq)){return true}}return false};var C=function(ay,aJ,aA,aH,aw,aG,ax,aF,aK,aB,at,aD,aE,au,ap,az,av,ar,ao){var aI={action:"RECORD",eventType:ay,uiOrigin:aK,global:aF<=1,scope:aF>1?aF:undefined,fromHistory:aD,hadHistory:aE,type:az.type,value:aJ,indexInType:az.indexInType?az.indexInType:0,tagId:az.tagId?az.tagId:0,source:aK,startTime:aB,selDepth:aA,isChild:az.isChild,totalNum:aH,userInteractionType:aG,errors:ax,query:at,dataType:az.data_type,url:az.url,searchSessionId:ar};var aq;if(typeof aw==="function"){if(av){aw();if(typeof ap==="function"){aq=ap}}else{aq=function(){aw();if(typeof ap==="function"){ap()}}}}if(typeof au==="function"){aI=au(aI,az,ao)}var aC={method:"GET",url:"/TypeAheadJson",data:aI,error:function(){aq()},success:function(){aq()}};S(aC)};var p=function(){if(!this.startNotificationSent){this.startNotificationSent=true;this.options.startTime=Date.now();var ao=this.options.geoId;var ap=this.options.name;var ar=this.options.staticResults&&this.options.staticResults.history&&this.options.staticResults.history.results&&this.options.staticResults.history.results.length;var aq={method:"GET",data:{action:"RECORD",eventType:"start",uiOrigin:this.options.name,startTime:this.options.startTime,source:ap,linkedTypeAhead:this.options.linkedTypeAhead?this.options.linkedTypeAhead.options.startTime:void 0,global:!ao,hadHistory:ar,scope:ao,searchSessionId:a(this.options)},url:"/TypeAheadJson"};S(aq);if(this.options.trackingName&&h.entryEventRecorded==false){h.entryEventRecorded=true;M.trackEventOnPage("desktop_typeahead","typeahead_entry",this.options.trackingName)}}};var P=function(ap){if(this.hasDefaultText()&&this.options.clearDefaultTextOnFocus===true){R(this.source).removeClass(this.options.defaultTextClass);this.source.value=""}x.call(this);if(!this.autoFocusing){if(this.options.onUserFocus){this.options.onUserFocus(this)}var ao=this.lastSuccessfulQuery!==this.query;if(this.options.showOnFocus&&(!ao)){this.show()}if(this.options.restoreOnFocus){this.restore()}if(this.options.showOnFocus&&this.options.searchOnFocus&&this.query&&!this.results&&!this.error&&k.call(this)){this.search()}else{this.showStaticResultsIfEnabled()}if(this.options.jpFirefoxIME){al.call(this)}}if(this.options.startEventOn==="focus"){p.call(this)}this.autoFocusing=false};var al=function(){if(this.source==document.activeElement){var ao=function(){W.call(this);if(this.jpTypeAheadTimerId){clearTimeout(this.jpTypeAheadTimerId)}this.jpTypeAheadTimerId=setTimeout(ao.bind(this),this.options.jpFirefoxIMEInterval)};ao.call(this)}};var B=function(at,ao){if(this.checkMenuInteraction()){return}this.hide();var ap=this.tabPressed;this.tabPressed=false;if(!this.options.restoreOnFocus&&!this.query){this.results=null;this.error=null;this.setSelectedIndex(-1);this.selected=null;this.items=[];if(this.container){this.container.innerHTML=""}}var ar=this.options.selectOnBlur&&-1!==this.selectedIndex;if(ar){this.select(ap,ap?z:undefined,at)}var aq=this.options.autoSelectFirst?0:-1;if(this.options.assumeOnBlur&&aq===this.selectedIndex&&this.results&&this.results.length){if(typeof this.options.assumeOnBlur=="function"){this.setSelectedIndex(this.options.assumeOnBlur(this))}else{this.setSelectedIndex(0)}ah.call(this);!ar&&this.select(ap,ap?z:undefined,at)}if(this.source&&this.source.value===""){this.source.value=this.options.defaultValue;if(this.options.defaultTextClass){g.addClass(this.source,this.options.defaultTextClass)}}if(this.options.onUserBlur){this.options.onUserBlur(this,at)}if(this.jpTypeAheadTimerId){clearTimeout(this.jpTypeAheadTimerId)}};var ad=function(ap,ao){if(!ap){return null}if(typeof ao==="string"){for(;ap&&ap.tagName!="html";ap=ap.parentNode){if(g.hasClass(ap,ao)||(typeof ap.tagName==="string"&&ap.tagName.toUpperCase()===ao.toUpperCase())){return ap}}return null}else{return ap.parentNode}};var w=function(ao){if(this.options.autoHighlightFirst&&this.results&&this.results.length){this.setSelectedIndex(0)}else{this.setSelectedIndex(-1)}ah.call(this)};var b=function(ar,at){var ap=at.target;var aq=ad(ap,this.options.itemSelector);if(aq){ap=aq}if(this.selected&&this.selected===ap){return}for(var ao=this.items.length-1;ao>=0;ao--){if(this.items[ao]===ap){this.setSelectedIndex(ao);ah.call(this,ar);return}}};var H=function(){var ao=this.source.tabIndex,aq;if(false===this.options.nextField){return}if(this.options.nextField){if(typeof this.options.nextField==="string"){this.options.nextField=g.find(this.options.nextField)}else{if(typeof this.options.nextField==="function"){aq=this.options.nextField(this)}else{aq=this.options.nextField}}}if(false===aq){return}if(!aq&&ao){ao=parseInt(ao,10)+1;aq=g.find("[tabindex="+ao+"]",this.source.form)}if(!aq){for(var ap=this.source.form.elements.length-1;ap>=0;ap--){var ar=this.source.form.elements[ap];if(this.source===ar){aq=this.source.form.elements[ap+1];break}}}aq&&aq.focus()};var v=function(){this.options.syncro&&this.options.syncro.sync(this,{query:this.query,value:this.source.value,result:this.selectedIndex>=0&&this.results[this.selectedIndex]})};var ak=function(){(document.activeElement===this.source&&!this.aborted&&this.show())||B.call(this)};var u=function(){var ap,ao,au,av;var at=arguments[0]||{};var aq=1;var ar=arguments.length;for(;aq<ar;aq++){if((ap=arguments[aq])!=null){for(ao in ap){au=at[ao];av=ap[ao];if(at===av){continue}at[ao]=av}}}return at};var T=function(ap,ay){this.setSource(ap);this.lastQueryTime=0;this.disableOnBlur=false;this.checkMenuInteraction=function(){return this.disableOnBlur};if(!ag.containerParent){ag.containerParent=document.body}this.options=u({},ag,ay);this.options.postResultsFnList=this.options.postResultsFnList||[];if(this.options.postResultsFn){this.options.postResultsFnList.unshift(this.options.postResultsFn);delete this.options.postResultsFn}if(this.options.staticResults){for(var aw in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(aw)){continue}var av=this.options.staticResults[aw];this.addStaticResults(aw,av)}}this.staticResultsShown=null;this.setSelectedIndex(-1);this.selected=null;this.visible=false;this.lastSuccessfulQuery="";if(!this.options.defaultValue&&this.options.defaultValue!=""){this.options.defaultValue=this.source.getAttribute("data-defaultValue")||this.source.defaultValue}var ao={"class":this.options.containerClass};if(this.options.isOverlay){var ax="position: absolute";if(g.hasClass(document.body,"rtl")){ax+="; right: -999em"}else{ax+="; left: -999em"}ax+="; "+(typeof this.options.positionRelative==="string"?this.options.positionRelative:"top")+":-999px";ao.style=ax}this.container=g.createElement("div",ao);this.options.containerParent.appendChild(this.container);var ar=function(az){this.disableOnBlur=true;az.stopPropagation();az.preventDefault()};var au=function(az){this.disableOnBlur=false;az.stopPropagation();az.preventDefault();this.select(true,f,az);H.call(this)};this.containerHandlers={mousedown:g.bind(ar,this),click:g.bind(au,this)};if(window.FastClick){this.containerHandlers.touchstart=g.bind(b,this,false);this.containerHandlers.touchend=g.bind(au,this)}for(var at in this.containerHandlers){g.addEvent(this.container,at,this.containerHandlers[at])}if(true===this.options.width&&!this.options.cssPositioning){this.container.style.width=g.getSize(this.source).x+"px"}g.bindAll(this,"cleanUp","show","hide","processResults","renderResults","renderError");this.options.syncro&&this.options.syncro.add(this);var aq=document.activeElement===this.source;if(this.options.showOnFocus&&aq){if(this.hasDefaultText()){if(this.options.clearDefaultTextOnFocus===true){R(this.source).removeClass(this.options.defaultTextClass);this.source.value=""}else{g.addClass(this.source,this.options.defaultTextClass)}}if(this.options.searchOnFocus&&this.source.value!==this.options.defaultValue&&k.call(this)){this.query&&(this.source.value=this.query);this.search()}}if(!an.isIE11orHigher()){if("onpagehide" in window){window.addEventListener("pagehide",this.cleanUp,false)}else{g.addEvent(window,am.ie?"unload":"beforeunload",this.cleanUp)}}if(this.options.jpFirefoxIME){al.call(this)}if(this.options.startEventOn==="creation"||(this.options.startEventOn==="focus"&&aq)){p.call(this)}if(this.options.focusOnCreation===true){this.autoFocusing=true;this.source.focus()}x.call(this)};T.prototype.getInputText=X;T.prototype.getInputLength=k;T.prototype.searchFn=Y;T.prototype.setGeoId=function(ao){this.options.geoId=ao;this.options.position=null;this.clearCache();this.lastSuccessfulQuery="";this.results=null};T.prototype.setCurrentPosition=function(ao){this.options.geoId=null;this.options.position=ao;this.clearCache();this.lastSuccessfulQuery="";this.results=null};var U=function(ao){return ao&&ao.replace(/\s+/g," ")};T.prototype.setSource=function(ao,aq){if(!ao||(this.source&&!aq)){return}this.source=ao;this.source.autocomplete="off";this.handlers={keyup:g.bind(c,this),focus:g.bind(P,this),blur:g.bind(B,this),keydown:g.bind(l,this),compositionstart:g.bind(A,this),compositionend:g.bind(af,this)};if(window.FastClick){this.handlers.touchstart=g.bind(b,this,false)}for(var ap in this.handlers){g.addEvent(this.source,ap,this.handlers[ap])}this.source.addEventListener&&this.source.addEventListener("paste",aa.bind(this));this.source.addEventListener&&this.source.addEventListener("cut",aa.bind(this))};T.prototype.getNormalizedQuery=function(){if(this.query){return U(this.query)}else{return this.query}};T.prototype.reset=function(){if(this.options.defaultTextClass){g.addClass(this.source,this.options.defaultTextClass)}R(this.source).removeClass(this.options.errorClass);this.error=null;this.container&&this.render("");this.source.value=this.options.defaultValue||""};T.prototype.getChosenResult=function(){var ap=null;if(this.source&&this.source.value&&this.results){var ar=this.source.value;for(var aq=0;aq<this.results.length;aq++){var ao=this.results[aq];if(ar.toLowerCase()===d.stripHTMLFromText(ao.name).toLowerCase()){ap=ao;break}}}return ap};T.prototype.clearResults=function(){this.query="";this.render("")};T.prototype.search=function(ar,aw){this.selected=null;this.lastQueryTime=Date.now();this.setSelectedIndex(-1);this.query=this.source.value;var au=this.getNormalizedQuery();this.aborted=false;if(this.options.cacheResults&&this.resultsCache&&this.resultsCache[au]){this.processResults(this.resultsCache[au],true);if(false!==ar){ak.call(this)}aw&&aw()}else{var av;if(this.query.length<=this.options.queryLengthLimit){if(this.options.search){av=this.options.search(this.query,this)}else{av=Y.call(this,this.query)}}else{var ao=N();var at={results:[],query:{query:this.query}};ao.resolve(at);av=ao.promise()}av=av.success(this.integrateStaticResults.bind(this));var ap=this.options.postResultsFnList;for(var aq=0;aq<ap.length;aq++){av=av.success(ap[aq])}av=av.success(this.processResults).failure(this.renderError);if(false!==ar){av.always(g.bind(ak,this))}aw&&av.always(aw)}};T.prototype.processResults=function(av,aq){var au=this.options.itemTemplate,ap=this;aq=this.options.forceProcessResults||aq;var ao=!!av.results;if(!ao){av={results:av,query:{query:this.query}}}var ar=av.results;if(this.options.cacheResults&&ao){var at=U(av.query&&av.query.query?av.query.query:this.getNormalizedQuery());if(!this.resultsCache){this.resultsCache={}}this.resultsCache[at]=av}if(aq||this.getNormalizedQuery()!==U(this.lastSuccessfulQuery)){this.results=ar;this.error=null;this.setSelectedIndex(-1);if(this.options.autoHighlightFirst&&this.results&&this.results.length){this.setSelectedIndex(0)}ar.forEach(function(ax,aw){ax.index=aw;ax.rendered=au(ax);if(ap.options.onProcessResult){ap.options.onProcessResult(ax,aw,ap)}})}this.renderResults(av,null,aq)};T.prototype.processResultsForce=function(ao){this.processResults(ao,true)};T.prototype.renderResults=function(av,ar,aq){if(aq||this.getNormalizedQuery()!==U(this.lastSuccessfulQuery)){var ap=this;var au=av.results?av.results:av;this.lastSuccessfulQuery=av.query&&av.query.query?av.query.query:null;R(this.container).removeClass(this.options.errorClass);R(this.source).removeClass(this.options.errorClass);var ao=this.options.listTemplate(av);if(ar){var at=R(this.options.errorTemplate(ar)).add(R(ao));ao=R("<div></div>").append(at).get(0)}this.render(ao);this.items=g.select(this.options.itemSelector,this.container);this.items.forEach(function(aw){g.addEvent(aw,"mouseover",b.bind(ap,true));if(ap.options.selectFirstOnMouseOut){g.addEvent(aw,"mouseout",w.bind(ap))}});if(this.selectedIndex>=0){ah.call(this)}else{this.options.autoSelectFirst&&this.highlightNextChoice()}this.options.onRender&&this.options.onRender(this,au)}};T.prototype.setSelectedIndex=function(ao){this.selectedIndex=ao;if(this.options&&this.options.onSetSelectedIndex){this.options.onSetSelectedIndex(ao,this)}};T.prototype.renderError=function(ao,ap){if(ap&&this.results){this.renderResults(this.results,ao)}else{this.results=null}this.error=ao;g.addClass(this.container,this.options.errorClass);g.addClass(this.source,this.options.errorClass);!ap&&this.render(this.options.errorTemplate(ao));this.options.onError&&this.options.onError(this,ao)};T.prototype.render=function(ao){if(!this.container){return}if(typeof ao==="string"){this.container.innerHTML=ao}else{if(typeof ao==="object"){this.container.innerHTML="";this.container.appendChild(ao)}}};T.prototype.show=function(){if(!this.container||this.visible||!this.container.childNodes.length){return this}var at=g.getPosition(this.source);var ao=g.getSize(this.source);var ar=at.x||at.left;var aq=at.y||at.top;if(this.options.cssPositioning){this.container.style.right="";this.container.style.left="";this.container.style.top=""}else{if(this.options.positionRelative){if(g.hasClass(document.body,"rtl")){this.container.style.right="auto"}else{this.container.style.left=(this.options.offsetX||0)+"px"}if(typeof this.options.positionRelative==="string"){this.container.style[this.options.positionRelative]=(ao.y+(this.options.offsetY||0))+"px"}else{this.container.style.top=(ao.y+(this.options.offsetY||0))+"px"}}else{this.container.style.right="auto";this.container.style.left=ar+(this.options.offsetX||0)+"px";if(this.options.positionAbove){var ap=g.getSize(this.container);this.container.style.top=(aq-ap.y+(this.options.offsetY||0))+"px"}else{this.container.style.top=(aq+ao.y+(this.options.offsetY||0))+"px"}}}this.visible=true;this.hasBeenShown=true;this.options.onShow&&this.options.onShow(this);if(this.options.onResize){this._resizeCb=this.options.onResize.bind(null,this);g.addEvent(window,"resize",this._resizeCb)}return this};T.prototype.hide=function(){if(!this.visible||!this.container){return false}if(this.options.isOverlay){if(g.hasClass(document.body,"rtl")){this.container.style.right="-999em"}else{this.container.style.left="-999em"}this.container.style[typeof this.options.positionRelative==="string"?this.options.positionRelative:"top"]=-999}this.visible=false;this.options.onHide&&this.options.onHide(this);if(this._resizeCb){g.removeEvent(window,"resize",this._resizeCb);this._resizeCb=null}return this};T.prototype.highlightNextChoice=function(){V.call(this,1)};T.prototype.hightlightPreviousChoice=function(){V.call(this,-1)};T.prototype.select=function(ao,ar,aB){this.hide();if(this.selectedIndex<0||!this.results){return}this.source.value=this.options.resolveSelection(this.results[this.selectedIndex]);if(this.error){R(this.container).removeClass(this.options.errorClass);R(this.source).removeClass(this.options.errorClass);this.error=null;this.renderResults(this.results)}var aw;if(this.options.onSelect){aw=this.options.onSelect.bind(this.options,this.results[this.selectedIndex],this.source.value,this,ao,ar,aB)}if(ao){var aC=this.results[this.selectedIndex];var aA=0;if(this.results){aA=this.results.length}var ax=this.lastSuccessfulQuery?this.lastSuccessfulQuery:this.query;var az=aC.scope==="history";var au=this.options.loggingOverride;if(au){au=au.bind(this)}var av=this.options.onSelectNavigate;if(av){av=av.bind(this)}var ay=this.staticResultsShown&&this.staticResultsShown.history;var at=this.options.doSelectionBeforeLogging;var aq=a(this.options);var ap=Z.getUrlFromForm(this.source.form);if(aC.type==="SEARCH"){C("search_bttn",undefined,undefined,undefined,aw,ar,null,this.options.geoId,this.options.name,this.options.startTime,ax,az,ay,au,av,aC,at,aq,ap)}else{C("select",aC.value,this.selectedIndex+1,aA,aw,ar,null,this.options.geoId,this.options.name,this.options.startTime,ax,az,ay,au,av,aC,at,aq,ap)}}else{if(aw){aw()}}v.call(this);return this};T.prototype.restore=function(){this.query&&this.query.length&&(this.source.value=this.query);this.setSelectedIndex(-1);if(this.selected){R(this.selected).removeClass("selected");this.selected=null}this.options.autoSelectFirst&&this.highlightNextChoice();this.options.onRestore&&this.options.onRestore(this.query);v.call(this);return this};T.prototype.sync=function(aq){var ao=this;if(this.query&&this.query!==aq.query){this.results=null;this.error=null}this.query=aq.query;aq.value&&(this.source.value=aq.value);this.setSelectedIndex(-1);this.selected&&R(this.selected).removeClass("selected");var ap=function(){if(ao.results&&ao.results.length){var ar=ao.results.some(function(au,at){if(ao.options.equal(au,aq.result)){ao.setSelectedIndex(at);return true}return false});if(!ar&&ao.options.assumeOnBlur){ao.setSelectedIndex(0)}if(ao.selectedIndex>=0){ao.selected&&R(ao.selected).removeClass("selected");ao.selected=ao.items[ao.selectedIndex];g.addClass(ao.selected,"selected");ao.source.value=ao.options.resolveSelection(ao.results[ao.selectedIndex]);ao.options.onSelect&&ao.options.onSelect(ao.results[ao.selectedIndex],ao.source.value,ao,false)}}ao.options.onSync&&ao.options.onSync(ao.query,ao.source.value,ao.selectedIndex>=0&&ao.results[ao.selectedIndex])};if(!this.results){this.query&&(this.source.value=this.query);this.search(false,ap)}else{ap()}};T.prototype.cleanUp=function(){this.container=null;this.item=null;this.selected=null;this.source=null;this.setSelectedIndex(-1);this.query=null;this.staticResultsShown=null;this.results=null;this.error=null;this.timeoutHandler=null;this.clearCache()};T.prototype.clearCache=function(){this.resultsCache=null};T.prototype.abortSearch=function(){this.aborted=true;if(this.timeoutHandler){clearTimeout(this.timeoutHandler)}};T.prototype.hasDefaultText=function(){return this.source&&this.source.value===this.options.defaultValue};T.prototype.integrateStaticResults=function(aL){var aD=aL.results||aL;if(!g.isArray(aD)){aD=[]}var au=(aL.query&&aL.query.query)||this.query;var aq=false;if(aL.normalized&&aL.normalized.query){au=aL.normalized.query;aq=true}var ap=aD.length>0&&aD[aD.length-1];if(ap&&ap.type=="SEARCH"){aD.length-=1}else{ap=null}var aI=this.getStaticResultsMatchingQuery(au,aq);if(!aI||!aI.length){return aD}var aC={};for(var aH=0;aH<aI.length;aH++){var aw=aI[aH];var aB=[];for(var aG=0;aG<aw.results.length;aG++){var ax=aw.results[aG];var aN=aw.getMatchingKey(ax);if(!aC.hasOwnProperty(aN)){aB.push(ax);aC[aN]=[aH,aB.length-1]}}aw.results=aB}for(var aF=0;aF<aD.length;aF++){var aK=aD[aF];var aA=false;for(var aJ=0;aJ<aI.length&&!aA;aJ++){var av=aI[aJ];var aN=av.getMatchingKey(aK);var at=aC[aN];if(at&&at[0]==aJ){if(av.shouldReplace&&!aK.isChild){aK.scope=av.results[at[1]].scope}av.results[at[1]]=aK;aD[aF]=null;aA=true}}}var ar=[];for(var aJ=0;aJ<aI.length;aJ++){var av=aI[aJ];if(!aw.bottom){for(var aF=0;aF<av.results.length;aF++){var aE=av.results[aF];aE&&ar.push(aE)}}}ar.push.apply(ar,aD.filter(function(aO){return !!aO}));for(var aJ=0;aJ<aI.length;aJ++){if(aw.bottom){var av=aI[aJ];for(var aF=0;aF<av.results.length;aF++){var aE=av.results[aF];aE&&ar.push(aE)}}}var ao=ar;if(ap){ao.push(ap)}if(aL.results){aL.results=ao}else{aL=ao}var ay={};for(var az in aI){if(aI.hasOwnProperty(az)){var aw=aI[az];if(aw.results&&aw.results.filter(function(aO){return aO!=null}).length){ay[az]=true}}}this.staticResultsShown=ay;var aM=N();aM.resolve(aL);return aM.promise()};var i=function(ao){return ao.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")};T.prototype.getStaticResultsMatchingQuery=function(aw,ay){if(!aw||!aw.length){return[]}var ap=[];var aq=new RegExp("\\b"+i(aw),"i");var ax=function(aD){return"<b>"+aD+"</b>"};var au=this;for(var aC in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(aC)){continue}var az=this.options.staticResults[aC];if(aw.length<az.minChars||!az.integrate){continue}var av=az.results;var aB=[];for(var ar=0;ar<av.length&&(!au.options.maxResults||aB.length<au.options.maxResults)&&aB.length<az.maxItems;ar++){var aA=av[ar];if(!aA){continue}var ao=aA.name;if(ay&&aA.normalized_name){ao=aA.normalized_name}if(ao&&ao.match(aq)||e(aq,aA.aliases)){if(az.highlight){aA=u({},aA);aA.name=aA.name.replace(aq,ax)}aB.push(aA)}}if(aB.length){var at=u({},az);at.results=aB;ap.push(at)}}return ap};T.prototype.shouldShowStaticResults=function(){var ap=!!this.query&&this.query.length>0;var ao=this.lastSuccessfulQuery!==this.query;if(this.options.showOnFocus&&(!ap||ao)){for(var ar in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(ar)){continue}var aq=this.options.staticResults[ar];if(aq.showOnEmpty){return true}}}return false};T.prototype.getSearchParams=function(){if(this.options.searchParams){if(typeof this.options.searchParams==="function"){return this.options.searchParams(this)}else{return this.options.searchParams}}else{return{}}};T.prototype.showStaticResultsIfEnabled=function(){if(!this.shouldShowStaticResults()){return}var ao={};var aq=[];for(var aw in this.options.staticResults){if(!this.options.staticResults.hasOwnProperty(aw)){continue}var au=this.options.staticResults[aw];if(au.showOnEmpty){var ar=au.results.slice(0,au.maxItems);if(au.sort){ar=ar.sort(au.sort)}ao[aw]=true;aq=aq.concat(ar)}}this.staticResultsShown=ao;var ax=N(true);setTimeout(function(){ax.resolve({results:aq})},0);var ay=ax.promise();var at=this.options.postResultsFnList;for(var ap=0;ap<at.length;ap++){ay=ay.success(at[ap])}var av=this;ay=ay.success(this.processResultsForce.bind(this));ay.always(function(){av.show()})};T.prototype.addStaticResults=function(ao,at){this.options.staticResults=this.options.staticResults||{};if(!at||!at.results){delete this.options.staticResults[ao];return}var ap=function(au,aw){var av=u({},au);if(au.urls){au.urls.some(function(ax){if(ax.url_type==aw.linkType){av.url=ax.url;return true}return false})}return av};var ar=u({},L,at);var aq=[].concat(ar.results.filter(function(au){return !ar.types||!ar.types.length||au.type&&ar.types.indexOf(au.type.toLowerCase())>-1}).map(function(au){return ap(au,ar)}).filter(function(au){return !ar.predicate||ar.predicate(au)}));if(!aq.length){delete this.options.staticResults[ao];return}ar.results=aq;if(!ar.minChars){ar.minChars=this.options.minChars}this.options.staticResults[ao]=ar};T.utils=ae;T.views=aj;if(h.entryEventRecorded==undefined){h.entryEventRecorded=false}m.createNs(h,"ta.tracking","typeahead");m.exportTo({TypeAhead:T},window);return T});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"location_review_keyword_search_modal","handlers",["handlers"]);a(["placement","lib/jquery-amd","ta/Core/TA.Store","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Deferred","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/styles/windowshade","overlays/options/autoReposition","overlays/options/closeOnDocClick","overlays/options/closeOnEscape","overlays/options/disablePageScroll","lib/TypeAhead"],function(e,a,r,t,n,l,i,o,s,v,c,u,d,h,f){function p(r){var t=a("#"+e.id+"_supportedLangSwitch");x||(x=new i(null,o(null,"center",null,null,null,t.html()),v,s.center(),c),a(x.inner).addClass(B.attr("class")),a(".confirm_switch",x.inner).on("click",function(t){var n=a("#"+e.id+"_createCookieNoConfirmation");n.val("true"),T(r),n.val(""),x.hide(t)}),a(".decline_switch",x.inner).on("click",function(e){x.hide(e)})),x.show()}function w(){var e=ta.retrieve("ta.p13n.review_keyword_search.hasLangFilter")||!1,r=ta.retrieve("ta.p13n.review_keyword_search.noNativeReviewsForPos");null!==r&&(H=r||!1),!e&&H&&a(P).hide()}function g(){var e=a(W),t=e.data("tags"),n="true"===e.data("hasLangFilter"),l=e.data("noNativeReviewsForPos");if(t){var i=t.split(",");r.store("ta.p13n.review_keyword_search.tags",i)}r.store("ta.p13n.review_keyword_search.hasLangFilter",Boolean(n)),l&&r.store("ta.p13n.review_keyword_search.noNativeReviewsForPos",l)}function y(r){a(".ui_tagcloud",B).each(function(e,t){a(t).toggleClass("selected",a(t).data("content")===r)}),r||a("#"+e.id+"_all_reviews").addClass("selected")}function _(e){a(j).val(""),y(""),F(e)}function m(){a(V).val(""),_()}function T(e,r){var n=a(j),l=a(V),i=e;if(n.val()===e)e="";else{if(r&&"true"===a(Q).val())return void p(e);l.prop("defaultValue",""),l.val("")}n.val(e),y(e),e?t.fireEvent("addFilterTag",{filterType:"keywordSearch",value:"",label:e}):t.fireEvent("removeFilterTag",{filterType:"keywordSearch",value:"",label:i}),F(!1),t.fireEvent("review_keyword_search.tag_toggled")}function k(e){a(j).val()!==e&&(a(V).prop("defaultValue",""),a(V).val(""),a(j).val(e),y(e),F(!1),t.fireEvent("review_keyword_search.tag_toggled"))}function F(e){var r=e?D:L,n=a(r),l=a(j),i=(e?a(I).val():a(V).val())||"";return i&&a(j).length&&(l.val(""),y(i)),i&&t.fireEvent("addFilterTag",{filterType:"keywordSearch",value:"",label:i}),a(".dual_search_loader_container").show(),ta.page&&ta.page.applyReviewFiltersForm?ta.page.applyReviewFiltersForm(n.get(0),{whiteBoxTopElmt:B.next().get(0)}):ta.servlet.Reviews.filterReviews(n.get(0),{whiteBoxTopElmt:B.next().get(0)}),e&&l.val(i),!1}function S(){a(V).blur();var e=a(V).val()||"";n.trackEventOnPage("Reviews_Search","keyword_search_manual",e.replace(/(\W|_)+/g,"_"))}function R(){var e=a(".search_overlay_content",B)[0];if(e){var r=[],t=a(W).data("tags"),n=t?t.split(","):[];if(n.forEach(function(e){r.push('<li class="displayItem">'),r.push('<span class="primaryText">'+e+"</span>"),r.push("</li>")}),r.length>0){var l=r.join("");a(".what_results .resultContainer").html(l)}else a(N).hide();a(".displayItem").click(function(e){C(this.innerText)});var v=e.getAttribute("data-div-classes");q=new i(null,o(null,null,"fullwidth no_padding "+v,null,null,e,"div"),s.framed(null,!0),u,d,h),a(I).val(""),a(N).show(),a("#mainSearch").focus()}q&&q.show()}function C(e){var r=a.trim(e);a(I).val(r),t.fireEvent("addFilterTag",{filterType:"keywordSearch",value:"",label:r}),F(!0)}function b(){q&&q.hide()}function E(e,t,i){if(e&&e.stopPropagation(),!A){var o=i?"modalSearchBoxContainer":"inlineSearchBoxContainer",s=20,v={name:"Review-Keyword-Search",minChars:1,startEventOn:"focus",autopopulateHighlighted:!1,defaultValue:"",clearDefaultTextOnFocus:!1,selectOnBlur:!1,assumeOnBlur:!1,restoreOnFocus:!1,cycleInput:!1,containerClass:"typeahead-container keywords_typeahead",containerParent:document.getElementById(o),positionRelative:!0,offsetX:0,offsetY:2,width:null,cacheResults:!0,shouldSubmit:function(){return S(),F(),!1},search:function(e){var a=r.retrieve("ta.p13n.review_keyword_search.tags"),t=[];if(a)for(var n=0;n<a.length;n++){var i=a[n];if(0===i.indexOf(e)&&(t.push({value:i}),t.length>=s))break}return l().resolve({results:t,query:e})},onSelect:function(){var e=a(V).val()||"";n.trackEventOnPage("Reviews_Search","keyword_search_auto_complete",e.replace(/(\W|_)+/g,"_")),_(i),A.sync({query:e,result:{}})},onRender:function(){var e=a(".typeahead-choices *",B).length;a(".typeahead-container",B).css("visibility",0===e?"hidden":"visible")}};return A=new f(t,a.extend({},v))}}function O(e){T(e,!1)}var x,q,A,B=a("#"+e.id),P="#searchReviewsButton",L="#inlineForm",D="#modalForm",I="#modalTypeAhead",N="#modalTagStringsContainer",V="#"+e.id+"_q",j="#"+e.id+"_reviewTag",Q="#"+e.id+"_askForConfirmation",W="#"+e.id+"_jsData",H=!1;return a(j).val()?t.queueForReady(function(){y(a(j).val()),t.fireEvent("addFilterTag",{filterType:"keywordSearch",value:"",label:a(j).val()})}):a(V).length&&t.queueForReady(function(){y(a(V).val())}),t.queueForReady(g),t.on("reviewListUpdated",function(r){g(),a(V).blur(),B=a("#"+e.id),r=a(r);var n=a("input[name=q]",r);n.length&&a(V).prop("defaultValue",n.val()).val(n.val());var l=a("input[name=t]",r);l.length&&a(j).val(l.val());var i=a("input[name=askForConfirmation]",r);i.length&&a(Q).val(i.val()),t.on("review-search-overlay",R),b(),w(),a(j).val()?y(a(j).val()):a(V).length&&y(a(V).val())}),t.on("reviews-selectTag",k),t.on("reviews-search",F),t.on("reviews-clearTagsAndQuery",m),t.on("review-list-update",function(){B=a("#"+e.id)}),t.on("filterTagCleared",O),t.on("review-search-overlay",R),w(),{search:F,clearTagsAndQuery:m,clearTags:_,toggleTag:T,createTypeAhead:E,trackManualSubmit:S,showSearchOverlay:R,hideSearchOverlay:b,suggestedSearch:C}})});
define("overlays/styles/popover",["api-mod","lib/jquery-amd","overlays/utils"],function(t,e,a){"use strict";function i(e,i,n){this.container=t.createElement("span",{"class":"ui_overlay ui_popover arrow_"+a.getArrowDir(e,this.sourceElement,this.domParent)+" "+i,"style":n}),this.arrow=t.createElement("div",{"class":"arrow"}),this.container.appendChild(this.arrow),this.header=t.createElement("div",{"class":"header_text"}),this.container.appendChild(this.header),this.inner=t.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner,this.close=t.createElement("div",{"class":"ui_close_x"}),this.container.appendChild(this.close)}var n=function(n,r,s,o,h){n=e(n),s=s||n.attr("data-popover")||"",o=o||n.attr("data-header")||"",h=h||n.attr("data-content")||"";var d=n.attr("data-style")||"",c=n.attr("data-header-element"),l=n.attr("data-header-copy");return function(){i.call(this,r,s,d),this.updateContent(h),o&&a.injectContent(this.header,n,o,c,l),t.addEvent(this.close,"click",t.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return n});
define("overlays/options/pinnable",["vanillajs","api-mod","ta/Core/TA.Event"],function(n,i,e){"use strict";return function(){function n(){c.pinned&&i.inDocument(c.container)&&!o&&(o=i.createElement("div",{"class":"ui_backdrop dark"}),o.setAttribute("style","z-index:499"),i.addEvent(o,"click",function(){c.hide()}),c.domParent.appendChild(o))}function t(){c.pinned=!0,n()}var o,c=this;this.pinned=!1,this.pin=t,this.on("show",function(){n(),e.on(c.sourceElement,"click",t)}),this.on("hide",function(){o&&(c.domParent.removeChild(o),o=void 0,e.off(c.sourceElement,"click",t))})}});
define("utils/responsive",["vanillajs"],function(){"use strict";function t(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}function n(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function e(n){return function(){return t()>=n}}function r(n){return function(){return t()<=n}}function i(t,n){return function(){return e(t)()&&r(n)()}}var o={largeMonitor:1600,widescreen:1280,desktop:1024,tablet:768,mobile:767},u=Object.keys(o).sort(function(t,n){return o[n]-o[t]}),c={breakpoints:u,widths:o,atLeast:e,atMost:r,between:i,largeMonitor:e(o.largeMonitor),widescreen:e(o.widescreen),desktop:e(o.desktop),tablet:e(o.tablet),mobile:r(o.mobile),desktopOnly:i(o.desktop,o.widescreen-1),tabletOnly:i(o.tablet,o.desktop-1),landscape:function(){return t()>n()},portrait:function(){return n()>t()},currentBreakpoints:function(){return u.filter(function(t){return"function"==typeof c[t]&&c[t]()})},is:function(t,n,e){var r="function"!=typeof t&&c[t]?c[t]:t;return function(t,i){return r()?"undefined"!=typeof t?t:n:"undefined"!=typeof i?i:e}}};return c});
define("overlays/styles/default",["lib/jquery-amd"],function(t){"use strict";function e(e,a,i,s){this.container=t("<"+(s||"div")+"/>").addClass("ui_overlay").addClass(e||"").get(0),a&&(this.header=t("<div/>",{"class":"header_text"}).html(a).appendTo(this.container).get(0)),i&&(this.subheader=t("<div/>").addClass("subheader_text").html(i).appendTo(this.container).get(0)),this.contentElement=t("<div/>").addClass("body_text").appendTo(this.container).get(0),this.close=t("<div/>").addClass("ui_close_x").appendTo(this.container).get(0)}var a=function(a,i,s,n,d,o){return i=(i||"")+(a&&" "+a.getAttribute("data-overlay")||""),s=s||a&&a.getAttribute("data-header")||"",n=n||a&&a.getAttribute("data-subheader")||"",function(){e.call(this,i,s,n,o),this.updateContent(d),t(this.close).on("click",function(){this.hide.apply(this,arguments.length?arguments:["close-button"])}.bind(this))}};return a});
define("overlays/position/autosize",["lib/jquery-amd"],function(t,i){"use strict";function e(){if(document.clientWidth)return{w:document.clientWidth,h:document.clientHeight};var t=document.documentElement||document.body.parentNode;if(t&&t.clientWidth)return{w:t.clientWidth,h:t.clientHeight};var i=document.body,e=Math.max(t.clientWidth,i.clientWidth),n=Math.max(t.clientHeight,i.clientHeight);return e>self.innerWidth||n>self.innerHeight?{w:i.clientWidth,h:i.clientHeight}:{w:e,h:n}}return function(n){n===i&&(n=0);var o="function"==typeof n?n:function(){return n};return function(){var i=!1,n=!1,h=function(){if(n=!1,i){var h=t(this.container).find(".autosize")[0]||this.contentElement;if(!h.style.maxHeight){h.style.height&&(h.style.height="");var c=!1;(this.container.style.top&&this.container.style.bottom||this.container.style.height||this.container.style.maxHeight)&&(c=!0,this.container.style.bottom="auto",this.container.style.height="auto");var s=e().h-2*o(),r=this.container.clientHeight,l=h.clientHeight;r>s&&(c=!0,h.style.height=l+s-r+"px",h.style.overflow="auto"),c&&this.emit("positionDirty")}}}.bind(this),c=function(){i&&!n&&(n=!0,setTimeout(h,0))};this.on("show",function(){i=!0,t(window).on("resize",c),this.on("contentsUpdated",h),h()}.bind(this)).on("hide",function(){i=!1,t(window).off("resize",c),this.off("contentsUpdated",h)}.bind(this))}}});
define("overlays/position/conditional",["overlays/position/base"],function(o){"use strict";return function(i,n,t){var s=o();s.label="conditional";var f;return s.onPosition=function(){var o=i()?n:t;f&&o!==f&&f.offPosition&&f.offPosition.apply(this),(f=o).onPosition&&f.onPosition.apply(this)},s.offPosition=function(){f=null;var o=i()?n:t;o.offPosition&&o.offPosition.apply(this)},s}});
define("overlays/position/center",["lib/jquery-amd","overlays/position/base"],function(t,n){"use strict";return function(){var e=n();return e.onPosition=function(){var n=document.documentElement.clientWidth,e=document.documentElement.clientHeight,i={position:"fixed",left:(n-this.container.clientWidth)/2,top:(e-this.container.clientHeight)/2,right:"auto",bottom:"auto"};t(this.container).css(i)},e}});
define("babel/babel-helpers",[],function(){var e={};return e["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.jsx=function(){var e="function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103;return function(r,t,n,o){var i=r&&r.defaultProps,u=arguments.length-3;if(t||0===u||(t={}),t&&i)for(var a in i)void 0===t[a]&&(t[a]=i[a]);else t||(t=i||{});if(1===u)t.children=o;else if(u>1){for(var f=Array(u),l=0;l<u;l++)f[l]=arguments[l+3];t.children=f}return{$$typeof:e,type:r,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}}(),e.asyncIterator=function(e){if("function"==typeof Symbol){if(Symbol.asyncIterator){var r=e[Symbol.asyncIterator];if(null!=r)return r.call(e)}if(Symbol.iterator)return e[Symbol.iterator]()}throw new TypeError("Object is not async iterable")},e.asyncGenerator=function(){function e(e){this.value=e}function r(r){function t(e,r){return new Promise(function(t,o){var a={key:e,arg:r,resolve:t,reject:o,next:null};u?u=u.next=a:(i=u=a,n(e,r))})}function n(t,i){try{var u=r[t](i),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(u.done?"return":"normal",u.value)}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":i.resolve({value:r,done:!0});break;case"throw":i.reject(r);break;default:i.resolve({value:r,done:!1})}i=i.next,i?n(i.key,i.arg):u=null}var i,u;this._invoke=t,"function"!=typeof r["return"]&&(this["return"]=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype["throw"]=function(e){return this._invoke("throw",e)},r.prototype["return"]=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new r(e.apply(this,arguments))}},"await":function(r){return new e(r)}}}(),e.asyncGeneratorDelegate=function(e,r){function t(t,n){return o=!0,n=new Promise(function(r){r(e[t](n))}),{done:!1,value:r(n)}}var n={},o=!1;return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return this}),n.next=function(e){return o?(o=!1,e):t("next",e)},"function"==typeof e["throw"]&&(n["throw"]=function(e){if(o)throw o=!1,e;return t("throw",e)}),"function"==typeof e["return"]&&(n["return"]=function(e){return t("return",e)}),n},e.asyncToGenerator=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,i){try{var u=r[o](i),a=u.value}catch(e){return void t(e)}return u.done?void e(a):Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)})}return n("next")})}},e.classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},e.createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),e.defineEnumerableProperties=function(e,r){for(var t in r){var n=r[t];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t,n)}return e},e.defaults=function(e,r){for(var t=Object.getOwnPropertyNames(r),n=0;n<t.length;n++){var o=t[n],i=Object.getOwnPropertyDescriptor(r,o);i&&i.configurable&&void 0===e[o]&&Object.defineProperty(e,o,i)}return e},e.defineProperty=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},e["extends"]=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},e.get=function e(r,t,n){null===r&&(r=Function.prototype);var o=Object.getOwnPropertyDescriptor(r,t);if(void 0===o){var i=Object.getPrototypeOf(r);return null===i?void 0:e(i,t,n)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(n)},e.inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},e["instanceof"]=function(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](e):e instanceof r},e.interopRequireDefault=function(e){return e&&e.__esModule?e:{"default":e}},e.interopRequireWildcard=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r["default"]=e,r},e.newArrowCheck=function(e,r){if(e!==r)throw new TypeError("Cannot instantiate an arrow function")},e.objectDestructuringEmpty=function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},e.objectWithoutProperties=function(e,r){var t={};for(var n in e)r.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},e.possibleConstructorReturn=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},e.selfGlobal="undefined"==typeof global?self:global,e.set=function e(r,t,n,o){var i=Object.getOwnPropertyDescriptor(r,t);if(void 0===i){var u=Object.getPrototypeOf(r);null!==u&&e(u,t,n,o)}else if("value"in i&&i.writable)i.value=n;else{var a=i.set;void 0!==a&&a.call(o,n)}return n},e.slicedToArray=function(){function e(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),e.slicedToArrayLoose=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var t,n=[],o=e[Symbol.iterator]();!(t=o.next()).done&&(n.push(t.value),!r||n.length!==r););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},e.taggedTemplateLiteral=function(e,r){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))},e.taggedTemplateLiteralLoose=function(e,r){return e.raw=r,e},e.temporalRef=function(e,r,t){if(e===t)throw new ReferenceError(r+" is not defined - temporal dead zone");return e},e.temporalUndefined={},e.toArray=function(e){return Array.isArray(e)?e:Array.from(e)},e.toConsumableArray=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},e});
define("overlays/options/disableBodyScroll",["babel/babel-helpers","utils/browserutils"],function(o,e){"use strict";return function(o){return function(){var t=this,s={},n=function(o){var e=document.querySelector(".layered_overlay");t.container===o.target||t.container.contains(o.target)||o.target===e||e&&e.contains(o.target)||o.preventDefault()};this.on("show",function(){"ios"===e.Platform.name&&(o||(s.scrollPos=window.pageYOffset||document.documentElement.scrollTop,s.prevTop=document.body.style.top,document.body.style.top="-"+s.scrollPos+"px"),document.body.classList.add("iOS11bug")),document.body.classList.add("disableScroll"),document.body.addEventListener("touchmove",n,{passive:!1})}),this.on("hide",function(){"ios"===e.Platform.name&&(document.body.classList.remove("iOS11bug"),o||(window.scrollTo(0,s.scrollPos),document.body.style.top=s.prevTop)),document.body.classList.remove("disableScroll"),document.body.removeEventListener("touchmove",n,{passive:!1})})}}});
define("overlays/position/fullscreen",["lib/jquery-amd","overlays/position/base","overlays/options/disableBodyScroll"],function(o,i,t){"use strict";return function(n){function s(){e.call(this),l.call(this)}var e=i(),l=t(n);return s.onPosition=e.onPosition=function(){o(this.container).css({position:"fixed",top:0,left:0,bottom:0,right:0,height:"auto",width:"auto"}).addClass("fullscreen")},s.offPosition=e.offPosition=function(){o(this.container).removeClass("fullscreen")},s}});
define("overlays/ux/elementToggle",["lib/jquery-amd"],function(n){"use strict";return function(t,e){e&&(e["on"+t.type]=null);var i=t.type||"click";return function(){n(this.sourceElement).on(i,function(n){n.stopPropagation(),this.isOpen()?"click"==i&&this.hide():this.show()}.bind(this))}}});
define("common/Radio",["vanillajs"],function(){function t(t){this.channel=t,this.events={},this.replies={}}var e={},n=/\s+/;return t.prototype.reply=function(t,e,r){return t.split(n).forEach(function(t){this.replies[t]||(this.replies[t]=[]),this.replies[t].push({callback:e,context:r||this})},this),this},t.prototype.request=function(t){if(!this.replies[t])return null;var e=[].slice.call(arguments,1),n=this.replies[t];return n=n[n.length-1],n.callback.apply(n.context,e)},t.prototype.requestMany=function(t){if(!this.replies[t])return null;var e=[].slice.call(arguments,1);return this.replies[t].map(function(t){return t.callback.apply(t.context,e)})},t.prototype.requestAll=function(t,e){if(!this.replies[t])return!0;var n=[].slice.call(arguments,1),r="function"==typeof e?e:function(t){return t===e};return this.replies[t].reduce(function(t,e){return t&&r(e.callback.apply(e.context,n))},!0)},t.prototype.requestEvery=t.prototype.requestAll,t.prototype.requestAny=function(t,e){if(!this.replies[t])return!1;var n=[].slice.call(arguments,1),r="function"==typeof e?e:function(t){return t===e};return this.replies[t].reduce(function(t,e){return t||r(e.callback.apply(e.context,n))},!1)},t.prototype.requestSome=t.prototype.requestAny,t.prototype.on=function(t,e,r){return t.split(n).forEach(function(t){this.events[t]||(this.events[t]=[]),this.events[t].push({callback:e,context:r||this})},this),this},t.prototype.once=function(t,e,r){return t.split(n).forEach(function(t){this.events[t]||(this.events[t]=[]),this.events[t].push({callback:e,context:r||this,single:!0})},this),this},t.prototype.one=t.prototype.once,t.prototype.off=function(t,e){return t.split(n).forEach(function(t){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return e&&t.callback!=e}))},this),this},t.prototype.trigger=function(t){if(this.events[t]){var e=[].slice.call(arguments,1);return this.events[t]=this.events[t].filter(function(t){return t.callback.apply(t.callback,e),!t.single}),this}},t.prototype.emit=t.prototype.trigger,t.prototype.clear=function(){return this.events={},this.replies={},this},function(n){return e[n]||(e[n]=new t(n))}});
define("overlays/support/radio",["common/Radio"],function(n){"use strict";return{hide:function(o,i){return o||(o="overlays"),i||(i="shown"),function(){var t=this,u=n(o),e=function(n){n!=t&&t.hide()};this.on("show",function(){u.on(i,e)}).on("hide",function(){u.off(i,e)})}},announce:function(o,i,t){return i||(i="overlays"),t||(t="shown"),function(){var u=this,e=n(i);this.on("show",function(){e.emit(t,u,o)})}}}});
define("styleguide/overlays/Modal",["lib/jquery-amd","utils/responsive","overlays/Overlay","overlays/styles/default","overlays/styles/windowshade","overlays/position/autosize","overlays/position/conditional","overlays/position/center","overlays/position/fullscreen","overlays/options/repositionOnEvent","overlays/ux/elementToggle","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnDocClick","overlays/support/radio"],function(e,o,s,i,l,r,n,a,t,y,u,v,d,p){"use strict";return function(e,c){var h=[i(c,"ui_modal"),n(o.mobile,t(),a()),r(0),y(window,"resize"),p.hide(),p.announce(),Array.prototype.slice.call(arguments,2)];e&&h.push(u(e,c));var w=c&&c.getAttribute("data-sg-overlay")||"";return w.indexOf("nobackdrop")<0?h.push(l(),v):h.push(d),new s(c,h).show()}});
define("overlays/widgetoverlays",["ta","api-mod","overlays/Overlay","overlays/styles/popover","overlays/styles/modal","overlays/styles/dropdown","overlays/styles/windowshade","overlays/position","overlays/options/ajax","overlays/options/pinnable","overlays/options/closeOnWindowshadeClick","overlays/options/repositionOnEvent","styleguide/overlays/Modal"],function(e,i,r,n,t,o,a,l,s,v,d,m,u){"use strict";function p(e,i){var r=e.prwidget_ovl||(e.prwidget_ovl={key:i});return r.key!==i&&(r.showtimer&&(clearTimeout(r.showtimer),delete r.showtimer),r.overlay&&(r.overlay.destroy(),delete r.overlay),r.key=i),r}function c(){var r=this,n=r.prwidget_ovl;if(n&&(n.showtimer&&(clearTimeout(n.showtimer),delete n.showtimer),!(e.page&&e.page.usingUnifiedDates&&i.find(".ui_modal.date_picker_modal",document.body)))){var t=n.overlay;!t||t.pinned||t.prw_leaveTimer||(t.prw_leaveTimer=setTimeout(function(){t.pinned||t.hide()},250))}}function y(){var e=this;e&&(e.prw_entered=!0,e.prw_leaveTimer&&(clearTimeout(e.prw_leaveTimer),delete e.prw_leaveTimer))}function w(){if(!(e.page&&e.page.usingUnifiedDates&&i.find(".ui_modal.date_picker_modal",document.body))){var r=this;!r||r.pinned||r.prw_leaveTimer||(r.prw_leaveTimer=setTimeout(function(){r.pinned||r.hide()},250))}}function h(e,r){var n=!e.pinned&&y.bind(e),t=!e.pinned&&w.bind(e),o=function(){n&&i.removeEvent(e.container,"mouseenter",n),t&&i.removeEvent(e.container,"mouseleave",t),e.off("hide",o),delete r.overlay};n&&i.addEvent(e.container,"mouseenter",n),t&&i.addEvent(e.container,"mouseleave",t),e.on("hide",o)}function f(e,i){var r=i.url||"/OverlayWidgetAjax?Mode="+encodeURIComponent(e);return"string"==typeof crPageServlet&&(r+="&metaReferer="+encodeURIComponent(crPageServlet)),r}function g(e,t,o,a,d){var m=p(e,o);if(m.showtimer&&(clearTimeout(m.showtimer),delete m.showtimer),!m.overlay){var u=(d.position||"wideside").split(" ").filter(function(e){return!!e.length}),c=u.shift();if("wideside"===c)try{var y=i.getPosition(e).left,w=i.getSize(e).x,g=i.getSize(document.body).x;c=y>g-y-w?"leftEvenInRtl":"rightEvenInRtl"}catch(e){c="right"}var T=""|d.classes,_=f(o,d);d.reqParams=a,d.inlineResourceId=o,d.isWidget=!0;var x=[n(e,c,T,""),s(_,d),l[c](u,!1),v];d.mixins&&d.mixins.length>0&&x.push.apply(x,d.mixins);var E=new r(e,x);"click"===t&&E.pin(),E.show(),m.overlay=E,h(E,m)}}function T(e,i,n){n=n||{};var o=(n.position||"center").trim().split(" ")[0],v=f(e,n);n.reqParams=i,n.inlineResourceId=e,n.isWidget=!0;var u=[t(null,null,n.classes),s(v,n),l[o](void 0,!0),a(),d,m(window,"resize")];n.mixins&&n.mixins.length>0&&u.push.apply(u,n.mixins);var p=null;n.sourceElement&&(p=n.sourceElement);var c=new r(p,u);return c.show(),c}function _(e,i,r){r=r||{};var n=f(e,r);r.reqParams=i,r.inlineResourceId=e,r.isWidget=!0;var t=[s(n,r)];return r.mixins&&r.mixins.length>0&&t.push.apply(t,r.mixins),u(null,r.sourceElement||null,t)}function x(e,r,n,t,o){e=e||window.event,r=r||e.currentTarget;var a=e&&e.type||"click";e&&i.stopEvent(e);var l=p(r,n);if("click"===a)l.overlay||g(r,a,n,t,o);else{if(l.overlay)return l.overlay.prw_leaveTimer&&(clearTimeout(l.overlay.prw_leaveTimer),delete l.overlay.prw_leaveTimer),!1;if(l.showtimer)return!1;l.hasLeaveHandler||(i.removeEvent(r,"mouseleave",c),i.addEvent(r,"mouseleave",c),l.hasLeaveHandler=!0),l.showtimer=setTimeout(function(){g(r,a,n,t,o)},o.delay||300)}return!1}function E(e,n,t,a,v){e=e||window.event,n=n||e.currentTarget,e&&i.stopEvent(e),v=v||{};var d=(v.position||"below").trim().split(" ")[0],m=f(t,v);v.reqParams=a,v.inlineResourceId=t,v.isWidget=!0;var u=[o(n,d,v.classes,null,v.containerStyles,v.elementType||"div"),s(m,v),l[d](void 0,!0)];v.mixins&&v.mixins.length>0&&u.push.apply(u,v.mixins);var p=new r(n,u);return p.show(),p}return{triggerFlyout:x,showLightbox:T,showDropdown:E,showStyleguideModal:_}});
define("members/memberOverlay",["utils/stopevent","overlays/widgetoverlays","ta/Core/TA.Record","utils/responsive","amdloaders"],function(e,t,r,n,i){function o(o,a,c,d,s){if(o&&("click"===o.type||"mouseenter"===o.type||"mouseover"===o.type)){var m=n.mobile();if(m&&"click"!==o.type)return!1;"click"===o.type&&e(o);for(var u="",l="",v="",f=!1,w=!1,p=c.split("-"),b=0;b<p.length;b++){var y=p[b];y.match(/\bUID_([0-9A-F]+)\b/)?u=RegExp.$1:y.match(/\bSRC_(\d+)\b/)?l=RegExp.$1:y.match(/\bCATID_(\d+)\b/)?v=RegExp.$1:y.match("FUS")?f=!0:y.match("PATT")&&(w=!0)}var h="";if("undefined"!=typeof window.footprintGet&&(h=window.footprintGet()),m)return window.location.href="/MemberProfile-a_uid."+u,!1;var _="/MemberOverlay?Mode=owa&uid="+u+"&c="+v+"&src="+l+"&fus="+f+"&partner="+w+"&LsoId="+h;return t.triggerFlyout(o,a,"MEMBER_OVERLAY",i.getLoadedFilesParams(),{url:_,mixins:[function(){d&&s&&r.trackEventOnPageOnce(d,"show_reviewer_info_window",s)}]}),!1}}function a(e,t,r,n,i){return!t[c]&&(t[c]=!0,t.addEventListener("click",function(e){o(e||window.event,this,r,n,i)}),t.addEventListener("mouseenter",function(e){o(e||window.event,this,r,n,i)}),e&&o(e,t,r,n,i),!1)}var c="members_memberOverlay_init";return{initMemberOverlay:a}});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"reviews_member_info_resp","handlers",["handlers"]);r(["widget","members/memberOverlay","common/trackingStreams"],function(e,r,n){function i(e,n){return r.initMemberOverlay(e,n,n.id,"Reviews","user_name_photo"),!1}function t(){n.trackEvent("Reviews","click","user_name_name_click")}return{initMemberOverlay:i,usernameClick:t}})});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"reviews_text_summary_hsx","handlers",["handlers"]);r(["widget","lib/jquery-amd"],function(e,r){function t(){r(e.element).trigger("review:expand",[e.element,l])}function n(){r(e.element).trigger("review:collapse",[e.element,l])}var i=r(e.element).closest(".reviewSelector"),l=Number(i.attr("data-reviewId"));return{clickExpand:t,clickCollapse:n}})});
require(["ta/prwidgets"],function(e){var o=e.define.bind(e,"reviews_google_translate_button_hsx","handlers",["handlers"]);o(["widget","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","overlays/options/disablePageScroll"],function(e,o,t,a,r,l,n,s,i,y){function v(e){var v=e.getAttribute("data-url");ta.util.cookie.setPIDCookie(16009),c.overlay&&c.overlay.hide(),c.overlay=new o(e,[t(e,"center",""),a.center([0,0]),n,y,r,l,s(),i(v)]),c.overlay.container.style.maxWidth="90%",c.overlay.container.style.width="800px",c.overlay.container.style.maxHeight=.8*window.innerHeight+"500px",c.overlay.container.style.overflowY="scroll",c.overlay.show()}var c=this;return{open:v}}.bind({}))});
require(["ta/prwidgets"],function(e){var i=e.define.bind(e,"reviews_mt_header_hsx","handlers",["handlers"]);i(["widget","ta/util/Cookie"],function(e,i){function t(e,t){return"true"===t.value?i.setPIDCookie(25173):"false"===t.value&&i.setPIDCookie(25172),t.form.elements[0].value=window.location.href,t.form.submit(),!1}return{clickSubmit:t}})});
define("overlays/uiOverlay",["vanillajs","api-mod","utils/responsive"],function(t,e,a){"use strict";function o(t){var e=a[t.getAttribute("data-breakpoint")];return!("function"==typeof e&&!e())}var r={"tooltip":{defaultPosition:"above",defaultFade:"fade_short"},"popover":{defaultPosition:"below",defaultFade:"fade_short"},"modal":{defaultPosition:"center",defaultFixed:!0,defaultFade:"fade_short"},"dropdown":{defaultPosition:"below"},"notification":{}},i={},s=function(t,a){if(t=t||window.event,a=a||t.target||t.srcElement,o(a)){var s=t&&t.type;s&&e.removePropertyEvent(a,s,"uiOverlay"),t&&e.stopEvent(t);var n,l=(a.getAttribute("data-position")||"").split(" ").filter(function(t){return!!t.length}),u=l.shift(),d=["overlays/Overlay","overlays/position"];for(var v in r)if(a.hasAttribute("data-"+v)){u=u||r[v].defaultPosition,d.push("overlays/styles/"+v),n=!0;break}var c=a.getAttribute("data-options")||"";if(!n&&require.defined("ta/util/Error")){var p="uiOverlay: no style. class="+a.className+", id="+a.id;return[].forEach.call(a.attributes,function(t){/^data-/.test(t.name)&&(p+=", "+t.name+"="+t.value)}),void require("ta/util/Error").record(null,p)}d.push(a.hasAttribute("data-windowshade")?"overlays/styles/windowshade":null);var h=!1;a.hasAttribute("data-defer")&&(h=parseInt(a.getAttribute("data-defer"))),d.push(h?"overlays/options/hoverDelay":null),d.push(a.hasAttribute("data-fade")?"overlays/options/fadeInOut":null),d.push(a.getAttribute("data-url")?"overlays/options/ajax":null),d.push(a.hasAttribute("data-close-event")?"overlays/options/closeOnEvent":null),d.push(a.hasAttribute("data-close-ta-event")?"overlays/options/closeOnTaEvent":null),d.push(a.hasAttribute("data-maxWidth")?"overlays/options/maxWidth":null),d.push(a.hasAttribute("data-close-child")?"overlays/options/closeOnTargetChildClick":null);var f=a.hasAttribute("data-move-padding")||a.hasAttribute("data-move-source");d.push(f?"overlays/options/moveIntoView":null),d.push(a.hasAttribute("data-keep-in-dom")?"overlays/options/keepInDom":null),d.push("overlays/options/storeOverlayOnElement"),c&&(d=d.concat(c.split(" ").map(function(t){return"overlays/options/"+t}))),a.hasAttribute("data-tooltip")?"click"===s?d.push("overlays/options/closeOnDocClick"):"mouseover"===s&&c.indexOf("closeOnMouseAway")<0&&d.push("overlays/options/closeOnMouseOut"):a.hasAttribute("data-dropdown")&&("click"===s?(d.push("overlays/options/closeOnDocClick"),d.push("overlays/options/closeOnSourceClick")):"mouseover"===s&&d.push("overlays/options/closeOnMouseAway")),d.push(a.hasAttribute("data-zIndex")?"overlays/options/zIndex":null);var y;if(!(a.hasAttribute("data-unique")&&(y=a.getAttribute("data-unique"),y&&y in i))){var b;return a.hasAttribute("data-group")&&(b=a.getAttribute("data-group")),require(d,function(t,n,d,c,p,f,A,g,m,w,O,E){var k=[d(a,u),u&&n[u](l,r[v].defaultFixed),c&&c(a.getAttribute("data-windowshade")),p&&p(h,!0),f&&f(r[v].defaultFade),A&&A(),g&&g(a.getAttribute("data-close-event")),m&&m(a.getAttribute("data-close-ta-event")),w&&w(a.getAttribute("data-maxWidth")),O&&O(a.getAttribute("data-close-child")),E&&E(a.getAttribute("data-move-source"),parseInt(a.getAttribute("data-move-padding"),10))],x=Array.prototype.slice.call(arguments,11),I=new t(a,k.concat(x)),q=function(){e.select(".ui_tooltip").forEach(function(t){t.overlay&&t.overlay!=I&&t.overlay.hide()}),b&&(i[b]||[]).forEach(function(t){t!=I&&t.hide()}),I.show()};if(b){var C=i[b]||[];C.push(I),i[b]=C}if(s&&!h){var F=function(t){o(a)&&(q(),e.stopEvent(t))};e.addEvent(a,s,F),I.on("destroy",function(){e.removeEvent(a,s,F)})}if(y&&(i[y]=I,I.on("destroy",function(){delete i[y]})),!h&&q(),a.hasAttribute("data-callback")){var P=e.fn(a.getAttribute("data-callback"));P&&P(I)}}),!1}var A=i[y];if(A.sourceElement=a,A.updateContent(),!h&&A.show(),a.hasAttribute("data-callback")){var g=e.fn(a.getAttribute("data-callback"));g&&g(A)}}};return s}),window.uiOverlay=function(){var t=arguments;require(["overlays/uiOverlay"],function(e){e.apply(null,t)})};
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"reviews_mt_footer_hsx","handlers",["deferred/mtReview","handlers"]);t(["widget","api-mod","overlays/uiOverlay","overlays/Overlay","overlays/styles/default","overlays/position/conditional","utils/responsive","overlays/position/fullscreen","overlays/position/center","overlays/options/autoReposition","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/ajax","utils/ajax","overlays/styles/windowshade","ta/Core/TA.Store","common/trackingStreams"],function(e,t,i,r,a,o,n,l,s,d,v,y,c,u,f,m,p){function h(e){E.editOverlay?E.editOverlay.updateContent("/MachineTranslationEdit?r="+e):(E.editOverlay=new r(null,[a(null,"ui_modal mtedit_overlay"),o(n.mobile,l(),s()),d,v,y,f(),c("/MachineTranslationEdit?r="+e)]),m.store("translationEditOverlay",E.editOverlay),E.editOverlay.on("contentLoaded",function(){try{var e=document.getElementById("mtedit_mt"),t=document.getElementById("mtedit_english");if(e&&t){var i=e.querySelector(".mtedit_text");i.style.height=t.clientHeight+e.offsetTop-i.offsetTop+"px"}E.editOverlay.reposition()}catch(e){p.error(e,"openMTEdit:onLoad")}})),E.editOverlay.show()}function O(i,r,a){t.stopEvent(i),ta.servlet.Reviews?h(a):e.require(["trjs!deferred/mtReview"],function(e){ta.servlet.Reviews=e,h(a)})}function w(r,a){t.stopEvent(r),E.rateOverlay&&E.rateOverlay.hide();var o=t.find(".ratingList",a);o&&e.markMine(o),a.overlay=null,i(r,a),E.rateOverlay=t.retrieve(a,"overlay")}function g(i,r,a,o,n){if(o){var l=t.find(".mtRatingButton",e.element);l&&t.addClass(l,"hidden");var s=t.find(".thanksText",e.element);s&&t.removeClass(s,"hidden"),u("/RateUserReviewSlider?at=true&rateValue="+a+","+o+","+n,{})}E.rateOverlay&&E.rateOverlay.hide()}var E=this;return{clickEdit:O,clickRate:w,rateReview:g}}.bind({}))});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"reviews_vote_line_hsx","handlers",["deferred/clicks","handlers"]);t(["widget","overlays/uiOverlay","vanillajs"],function(e,t){function r(e,r){t(e,r)}function i(e,r){r.getAttribute("data-first")||(ta.trackEventOnPage("Reviews","respond_to_review","hover"),r.setAttribute("data-first",1)),t(e,r)}return{hoverReport:r,respondLinkMouseover:i}})});

define("overlays/options/closeOnEmit",["babel/babel-helpers"],function(n){"use strict";return function(n,e,o){return function(){var t=this,i=function(){o&&!o.apply(void 0,arguments)||t.hide("on-event")};this.on("show",function(){return n.on(e,i)}).on("hide",function(){return n.off(e,i)})}}});
define("photoviewer/tracking",["babel/babel-helpers","common/trackingStreams","ta/Core/TA.FireEvent","lib/jquery-amd","utils/responsive","utils/throttle","page-model"],function(e,i,o,t,n,r,c){"use strict";function l(e,o,t){i.trackEvent(e,o,t,M)}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_(e)&&i.trackEvent(z,e,o,M)}function a(e){i.trackEvent(z,e,"",M)}function _(e){var i=void 0;if(e.includes("grid_view"))i=K;else{if(!e.includes("detail_view"))return!1;i=J}return t(B).hasClass(i)}function v(){W=t(window).height(),U=t(window).width(),t(window).off("resize",X).on("resize",X)}function u(){t(window).off("resize",X)}function w(){n.desktop()&&o.fireEvent("galNavClick"),l(z,S,null)}function s(){l(z,D,null,M)}function k(){l(z,F,null,M)}function h(e){var i=e?"detail_view_show_nav_click":"detail_view_hide_nav_click";l(z,i,null,M)}function f(e){l(z,e,j,M)}function p(e){l(z,e,j,M)}function g(){l(z,P,null,M)}function m(){n.desktop()&&l(z,R,null,M)}function C(){l(z,G,null)}function b(){n.mobile()&&o.fireEvent("galThumbClick")}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";l(z,H,e+"|"+i+"|"+o+"|"+t)}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";l(z,I,e+"|"+i+"|"+t+"|"+r),n.desktop()&&o.fireEvent("galThumbClick")}function y(e,i,o){var n=t(i).closest(B).hasClass(J),r=t(i).hasClass(L),c=n?"detail":"grid",d=r?"dropdown_open":"dropdown_select";l(z,""+c+q[o],d+"_"+e)}function A(e,i,o,t){l(z,V,e+"|"+i+"|"+o+"|"+t)}var z="photoviewer",S="detail_view_image_arrow_click",D="detail_view_gallery_click",P="detail_view_caption_review_click",R="detail_view_desktop_image_click",F="detail_view_photostrip_arrow_click",G="detail_view_image_swipe_click",H="grid_view_thumbnail_click",I="detail_view_photostrip_tile_click",V="helpful_vote_click",x="_view_album_click",N="_view_type_click",O="_view_category_click",j="dropdown_abandoned",q={album:x,type:N,category:O},B=".photoviewerContainer",L="tabs_item",J="hero",K="grid",M=c.LOC_ID,Q=1e3,U=void 0,W=void 0,X=r(function(){setTimeout(function(){var e=t(window).width(),o=t(window).height();e===U&&o===W||(i.trackEvent("screenSizeRecord","resize","s"+U+"x"+W+"b"+e+"x"+o,""),U=e,W=o)},Q)},Q);return{attachResizeTracker:v,detachResizeTracker:u,trackPhotoViewerEvent:l,trackPhotoViewerImpression:d,trackSimpleAction:a,recordBackToGalleryClick:s,recordCaptionReviewClick:g,recordPhotoStripArrowClick:k,recordGridDropdownAbandonment:f,recordAlbumDropdownAbandonment:p,recordHeroClickOnDesktop:m,recordNavArrowVisibilityChange:h,recordArrowClick:w,recordPhotoSwipe:C,recordFilmstripThumbClick:b,recordGridTileClick:T,recordHeroThumbClick:E,recordFilterItemClick:y,recordHelpfulClick:A}});
define("utils/HistoryManager",[],function(){"use strict";function t(){function t(){return(new Date).getTime()+""+Math.random()}function i(t){var i=t.state;if(!a&&i&&i.id){var e=i.id,s=n[e];s&&s(i.data)}}var n={},e={},a=!1;this.pushState=function(i,e,a,s){var r=t();n[r]=s,i.id=r,history.pushState(i,e,a)},this.replaceState=function(i,e,a,s){var r=t();n[r]=s,i.id=r,history.replaceState(i,e,a)},this.addCallback=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},this.removeCallback=function(t,i){if(e[t]){var n=e[t].indexOf(i);n>=0&&e[t].splice(n,1)}},this.doCallbacks=function(t){e[t]&&e[t].each(function(t){t()})},this.isSupported=function(){return"undefined"!=typeof history&&"pushState"in history},this.disableCallbacks=function(t){a=t},window.addEventListener("popstate",i)}return t});
define("utils/localstorage",["vanillajs"],function(t){function e(t){return r(t,"value")}function n(t){return r(t,"now")}function r(t,e){if(!e)return null;try{var n=JSON.parse(h.getItem(t)||"0");return n?n.ttl&&n.ttl+n.now<(new Date).getTime()?(h.removeItem(t),null):n.hasOwnProperty(e)?n[e]:null:null}catch(t){}return null}function o(t){try{h.removeItem(t)}catch(t){}}function u(t,e){var r=n(t);if(e&&r&&r<(new Date).getTime()-e)try{h.removeItem(t)}catch(t){}}function i(t){try{var e=h.getItem(t);if(null!==e&&void 0!==e)return!0}catch(t){}return!1}function c(t,e,n){try{h.setItem(t,JSON.stringify({ttl:n||0,now:(new Date).getTime(),value:e}))}catch(t){}}function a(){var t=!1;try{if(h&&h.setItem)return h.setItem(y,d),t=h.getItem(y)!=d,h.removeItem(y),t&&(h=!1),!!h}catch(t){}return!1}function f(t){h=t,this.enabled=a()}function l(){return 1e9*Math.random()|0}function m(t,n,r){function u(){try{n()}finally{o(a)}}var i=t+"__MUTEX_x",a=t+"__MUTEX_y",f=function(){return e(a)};return c(i,g),f()?(r||setTimeout(function(){m(t,n)},0),!1):(c(a,g,40),e(i)!==g?(r||setTimeout(function(){f()!==g?setTimeout(function(){m(t,n)},0):u()},50),!1):(u(),!0))}function s(t,n,r,u){return function(){try{u()}finally{m(t,function(){if(e(n)!==r)throw t+" was locked by a different process while I held the lock";o(n)})}}}function v(t,n,r,o){r=r||5e3;var u=t+"__MUTEX",i=function(){return e(u)},a=g+":"+l(),f=function(){setTimeout(function(){v(t,n,r)},10)};if(i())return o||f(),!1;var w=s(t,u,a,n),h=m(t,function(){return i()?(o||f(),!1):(c(u,a,r),void(o||setTimeout(w,0)))},o);return!(!o||!h)&&(w(),!0)}function w(){var t=!1;try{window&&window.localStorage&&(t=window.localStorage)}catch(t){}f(t)}var h=!1,y="taLsTest",d="1",g=Date.now()+":"+l();return w(),{enabled:a(),get:e,set:c,remove:o,removeIfElapsed:u,has:i,getTimeStamp:n,setStorage:f,lock:function(t,e,n){v(t,e,n,!1)},attemptLock:function(t,e,n){return v(t,e,n,!0)}}});
define("ta/Core/TA.LocalStorage",["vanillajs","common/trackingStreams","ns-exporter"],function(e,t,n){"use strict";var r=!1,i="taLsTest",o="1",a="TALocalStorageCurrentSessionId",s=!1,u="session-",c=!1,l=[],f=function(){return!(!s&&!c)},v=function(e){return!!f()||(t.error(null,"Accessing localStorage session cookie before session logic intialized: "+e),!1)},g=function(e){return S(e,"value")},m=function(e){return S(e,"now")},S=function(e,t){if(!t)return null;try{var n,i=JSON.parse(r.getItem(e)||"0");return i?i.ttl&&i.ttl+i.now<(new Date).getTime()?(r.removeItem(e),null):i.hasOwnProperty(t)?(r.setItem("512",i[t]),n=r.getItem("512"),r.removeItem("512"),n):null:null}catch(e){}return null},d=function(e){try{var t=JSON.parse(r.getItem(e)||"0");return t?t.ttl&&t.ttl+t.now<(new Date).getTime()?(r.removeItem(e),null):t.value:null}catch(e){}return null},w=function(e){try{r.removeItem(e)}catch(e){}},y=function(e){try{var t=r.getItem(e);if(null!==t&&void 0!==t)return!0}catch(e){}return!1},h=function(e,t,n){try{r.setItem(e,JSON.stringify({ttl:n||0,now:(new Date).getTime(),value:t}))}catch(e){}},I=function(e){if(c=!0,!e)return t.error(null,"Attempting to initialize localStorage with invalid sesion key: "+e),!1;if(!T())return!1;if(s=g(a),!s||s!=e){s=e,h(a,s);var n=g("latestPageServlet");n&&h("sessionEntryServlet",n),p(),y(a)&&require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").store("isFirstSessionPageView",!0)}},p=function(){try{var e=u+s,t=new RegExp("^"+u);if(r.length)for(var n=0;n<r.length;n++){var i=r.key(n);try{t.test(i)&&i!=e&&w(i)}catch(e){}}}catch(e){}},T=function(){try{if(r&&r.setItem){r.setItem(i,o);var e=r.getItem(i)!=o;return r.removeItem(i),e&&(r=!1),!!r}}catch(e){}return!1},O=function(e){try{r.setItem("session-"+s,JSON.stringify(e))}catch(e){}},k=function(){try{var e=r.getItem("session-"+s);if(e)return JSON.parse(e)}catch(e){}return{}},A=function(e){l.push(e)},E={enabled:T(),get:g,getObject:d,set:h,remove:w,has:y,getTimeStamp:m,updateSessionId:I,onSessionStorageChange:A,canUseSession:f,getSessionKey:function(e){if(!v(e))return null;var t=k();return t?t[e]:null},setSessionKey:function(e,t){if(v(e)){var n=k();n||(n={}),n[e]=t,O(n)}},removeSessionKey:function(e){if(v(e)){var t=k();t&&(delete t[e],O(t))}},hasSessionKey:function(e){if(!v(e))return!1;var t=k();if(t){var n=t[e];if(null!==n&&void 0!==n)return!0}return!1},setStorage:function(e){r=e,E.enabled=T()}};if("undefined"!=typeof window){var N=!1;try{N=window.localStorage}catch(e){}E.setStorage(N),function(){function e(e){if(e=e||window.event,s&&(!e.key||e.key==="session-"+s))for(var t=0,n=l.length;t<n;t++)l[t](e)}window.addEventListener?window.addEventListener("storage",e,!1):window.attachEvent&&window.attachEvent("onstorage",e)}()}return n.createNs(E,"ta","localStorage"),E});
define("ta/support/Qualtrics",["vanillajs","ns-exporter","page-model","ta/Core/TA.LocalStorage"],function(e,t,s,n){"use strict";var i={},r=function(e,t,s,n){this.get=function(e){for(var e=e+"=",t=document.cookie.split(";"),s=0,n=t.length;s<n;s++){for(var i=t[s];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null},this.set=function(e,t){var s="",s=new Date;s.setTime(s.getTime()+6048e5),s="; expires="+s.toGMTString(),document.cookie=e+"="+t+s+"; path=/; "},this.check=function(){var n=this.get(s);if(n)n=n.split(":");else{if(100==e)return!0;"v"==t&&(e=Math.random()>=e/100?0:100),n=[t,e,0],this.set(s,n.join(":"))}var i=n[1];if(100==i)return!0;switch(n[0]){case"v":return!1;case"r":return i=n[2]%Math.floor(100/i),n[2]++,this.set(s,n.join(":")),!i}return!0},this.go=function(){if(this.check()){var e=document.createElement("script");e.type="text/javascript",e.src=n+"&t="+(new Date).getTime(),document.body&&document.body.appendChild(e)}},this.start=function(){var e=this;e.go()}};i.displaySurvey=function(e){var t=s.session.uid,n="QSI_S_"+e,i="//znbkpczkrl5wwqzj3-tripadvisor.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_SIID="+e+"&UID="+t+"&Q_LOC="+encodeURIComponent(window.location.href);try{new r(100,"r",n,i).start()}catch(e){}R(!0)};var a=2592e6,o=6048e5,u=!1,c=!1,l=4,p=3,g=2,v=!1,f=function(){return n.get("qualtrics-debug")},d=function(){return Number(n.get("qualtrics-session-count")||0)},q=function(){return!!n.getSessionKey("qualtrics-session-count-incremented")},h=function(){var e=d(),t=n.getSessionKey("qualtrics-session-count-incremented");t||(n.set("qualtrics-session-count",e+1,o),n.setSessionKey("qualtrics-session-count-incremented",!0))},S=function(e){n.setSessionKey("qualtrics-ignored",e),n.removeSessionKey("qualtrics-page-views"),n.removeSessionKey("qualtrics-intercept-views"),n.removeSessionKey("qualtrics-intercept-reqs")},m=function(){return!!n.getSessionKey("qualtrics-ignored")},y=function(e){n.set("qualtrics-responded",e,a),n.removeSessionKey("qualtrics-page-views"),n.removeSessionKey("qualtrics-intercept-views"),n.removeSessionKey("qualtrics-intercept-reqs")},w=function(){return!!n.get("qualtrics-responded")},K=function(){return Number(n.getSessionKey("qualtrics-page-views")||0)},I=function(){return Number(n.getSessionKey("qualtrics-intercept-views")||0)},b=function(){var e=I();4===e&&S(!0),n.setSessionKey("qualtrics-intercept-views",e+1)},D=function(){return Number(n.getSessionKey("qualtrics-intercept-reqs")||0)},T=function(){var e=D();n.setSessionKey("qualtrics-intercept-reqs",e+1)},N=function(){return v},k=function(e){v=e},C=function(){var e=!1,t=N();if(t){var s=w()||m(),n=d(),i=q(),r=K(),a=I(),o=Math.round(10*Math.random())%2;!s&&(n<p||n==p&&i)&&a<l&&(r===g||r>g&&0===o)&&(e=!0),a>=l&&S(!0)}return e};i.isDebug=f,i.setResponded=y,i.hasResponded=w,i.getPageViews=K,i.getSmartSurvey=N,i.setSmartSurvey=k,i.updateInterceptViews=b,i.canDisplaySmart=C,i.getSessionCount=d,i.updateSessionCount=h,i.getInterceptViews=I,i.updateInterceptReqs=T,i.getInterceptReqs=D;var R=function(e){e?(n.set("qualtrics-last-seen",Date.now()),u=!0):n.remove("qualtrics-last-seen")},j=function(){var e=parseFloat(n.get("qualtrics-last-seen")),t=isNaN(e)?0:e,s=t<0?0:t+a;return Date.now()<s},x=function(){return u},L=function(){var e=Number(n.get("qualtrics-page-views"));return 2===e&&!i.hasShownInLastThirtyDays()||1===e&&!c&&!i.hasShownInLastThirtyDays()},M=function(){if(N()&&(d()<p||d()==p&&q())&&!w()&&!m()){var e=K();n.setSessionKey("qualtrics-page-views",e+1)}var t=n.get("qualtrics-session-id"),i=s.session.sessionId;if(t&&t===i){var e=Number(n.get("qualtrics-page-views"))+1;n.set("qualtrics-page-views",e)}else n.set("qualtrics-session-id",i),n.set("qualtrics-page-views",1);c=!0};return i.hasShownInLastThirtyDays=j,i.seenThisPageView=x,i.canDisplay=L,i.updatePageViews=M,t.exportTo(i,"ta.support.qualtrics"),i});
define("mixins/page-dates/pop-calendar",["ta","utils/localstorage","common/trackingStreams","ta/support/Qualtrics","ta/Core/TA.Store"],function(e,r,t,a,n){function s(){E=!1}function i(t){v=!!t.popFromDefault,w=!!t.popFromUndated,h=!!t.datesWereDefaulted,T=t.popCalendarType,m=!!t.hasMetaMarketingDefaultDates,S=!!t.qualtricsSurveyEnabled,P=t.localStorageTTL,r.enabled&&(r.removeIfElapsed(f,P),r.removeIfElapsed(g,P),h?(r.set(f,(r.get(f)||0)+1,P),r.get(g)||r.set(g,{},P)):t.refreshLocalStorage&&(r.remove(f),r.remove(g))),e.page.on("datepickerRejected",s),e.page.on("dateSelected",s)}function o(){if(!h||D)return!1;if(n.retrieve("suppressCalendarPop"))return!1;if(!T)return!1;if(S&&a&&(a.canDisplay()||a.seenThisPageView())){if(!require.defined("page-model"))return!1;if(require("page-model").isMobile)return!1}var t=r.get(g),s=r.get(f)||NaN;switch(T){case"first":return 1===s;case"firstPerServlet":return t&&!t[window.pageServlet];case"firstAndSecond":return s<=2;case"firstThree":return s<=3;case"firstFour":return s<=4;case"firstFive":return s<=5;case"firstAndThird":return 1===s||3===s;case"everyThird":return s%3===1;case"doNot":return!1;case"always":return!0;case"skipFirstPageview":return s&&1!==s}return v||w&&!e.page.hasDates("STAYDATES")}function u(){return m}function d(a){if(E=!0,e.page.gatherDates(a),D=!0,t.trackEvent("DATEPICKER","auto-popped-calendar-shown",window.pageServlet),t.trackEvent("calendar","in_view","autopop"),r.enabled){var n=r.get(g)||{};n[window.pageServlet]=!0,r.set(g,n,P)}}function p(){return D}function c(){return E}function l(){h=!1}var f="ddpageviews",g="ddservletpops",v=!1,w=!1,h=!1,S=!1,m=!1,T="",D=!1,E=!1,P=0;return{init:i,shouldPop:o,shouldPopMetaMarketing:u,popCalendar:d,wasPoppedThisPageLoad:p,isShowing:c,setUserEnteredDates:l}});
define("commerce/offerclickEvents",["mixins/Events","vanillajs"],function(e){"use strict";return new e("beforeClick","afterClick")});
define("photoviewer/loader",["babel/babel-helpers","lib/jquery-amd","page-model","overlays/Overlay","overlays/styles/modal","overlays/position/fullscreen","overlays/options/closeOnEmit","overlays/options/ajax","overlays/support/radio","overlays/options/closeOnEscape","common/trackingStreams","common/Radio","ta/Core/TA.FireEvent","ta/Core/TA.Store","photoviewer/tracking","utils/responsive","utils/HistoryManager","utils/urlutils","mixins/page-dates/pop-calendar","commerce/offerclickEvents"],function(e,o,t,i,n,r,a,d,l,s,p,c,u,h,v,f,w,m,g,b){"use strict";function y(e){var i=e,n=f.mobile()?2:f.desktop()?5:3;return i.heroMinWidth=o(window).width()-2*O,i.heroMinHeight=o(window).height()-2*O,i.gridItemMinWidth=i.heroMinWidth/n,i.updateType=i.updateType||"partial",i.placementRollUps="responsive-photo-viewer",i.albumid=e.albumid||e.albumId,i.geo=i.geo||t.GEO_ID,i.detail=i.detail||t.LOC_ID,i.geo&&i.detail?(e.albumViewMode||(i.albumid=i.albumid||T,i.filter=i.filter||H,e.ff||e.imageId?(i.albumViewMode="hero",i.ff=e.ff||e.imageId):e.panoId?i.albumViewMode="hero":i.albumViewMode="grid"),i.area="QC_Meta_Mini|Photo_Lightbox",window.pageServlet&&(i.metaReferer=window.pageServlet),i):(p.error(null,"photoviewer/loader.js:load missing required arguments"),!1)}function C(e){return"/DynamicPlacementAjax?"+o.param(y(e))}function E(){if(P.contentElement){var e=P.contentElement.querySelector(".photoviewerContainer");e&&e.parentNode&&(P.contentElement=e.parentNode),P.contentElement.id||(P.contentElement.id="photo_viewer_default_id");var o=I();o&&o.clear(),c("responsive-photoviewer").trigger("content-loaded",P.contentElement.id)}}function I(){if(P){var e=P.contentElement.id;if(e)return c(e)}return null}function k(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f="no_padding";if(e.currentHeroId=e.ff,P){var w=void 0,m=I();m&&(w=m.request("currentHeroId")),w&&(e.currentHeroId=w),P.updateContent(C(e))}else P=new i(document.body,n(null,"",f),r(),s,a(b,"beforeClick",function(e){return e.isBooking}),d(C(e),{resources:[],noCache:!0,skipInvalidate:!0}),l.hide("responsive-photoviewer","close")),_(t,e),P.on("contentLoaded",function(){E()}),P.on("data-targetEvent",u.fireEvent),P.on("hide",function(){c("responsive-photoviewer").trigger("overlay-hide"),v.trackSimpleAction("photoviewer_close_click"),v.detachResizeTracker(),A&&h.remove("suppressCalendarPop"),g.shouldPop()&&g.popCalendar(o("[data-datetype='CHECKIN']").get(0))}),P.on("show",function(){c("responsive-photoviewer").trigger("overlay-shown")});p||t||M(e),P.show()}function M(e){var t=e.aggregationId,i=e.albumid,n=e.ff,r=e.filter,a=e.panoId,d={aggregationId:t,albumid:i,filter:r};n&&(d.ff=n),a&&(d.panoId=a);var l=S+o.param(d);c("responsive-photoviewer").trigger("addHistory",{data:d},document.title,l,function(){return k(d,!1,!0)})}function _(e,o){var t=new w;if(t.isSupported()){if(e){var i=window.location.href;window.setTimeout(function(){if(i===window.location.href){var e=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search;window.history.replaceState(null,"",e),M(o)}},0)}c("responsive-photoviewer").on("addHistory",t.pushState);var n=!1;P.on("hide",function(){window.location.hash.indexOf(x)>=0&&(n=!0,t.disableCallbacks(!0),history.back())}),window.addEventListener("popstate",function(){window.location.hash.indexOf(x)>=0?n?history.back():P.show():(n=!1,t.disableCallbacks(!1),P.hide())})}}var O=20,x="#photos",S=x+";",H=7,T=101,P=void 0,A=!1;return o(function(){var e=window.location.hash;if(e.indexOf(x)>=0){h.retrieve("suppressCalendarPop")||(A=!0,h.store("suppressCalendarPop","true"));var o=void 0,t=e.indexOf(S)>=0&&e.substring(e.indexOf(S)+S.length,e.length);o=t&&t.length>0?m.getUrlQueryArgs("?"+t):y({}),o.updateType="full",k(o,!0)}}),{load:k,buildUrl:C}});
define("actions/openRespPhotoViewer",["common/trackingStreams","ta/util/Cookie","photoviewer/loader"],function(e,o,t){function i(i,r,a,n,l,c){e.trackEvent("photoviewer","click","btf_userreviews"),o.setPIDCookie(5042);var f={detail:a,geo:n,imageId:l,filter:c};l>0&&(f.ff=l),f.albumViewMode="hero",f.updateType="full",t.load(f)}return{open:i}});
require(["ta/prwidgets"],function(e){var i=e.define.bind(e,"reviews_review_resp","handlers",["handlers"]);i(["widget","lib/jquery-amd","ta/util/Cookie","ta/Core/TA.Record","common/trackingStreams"],function(e,i,t,r,n){function l(){i(e.element).trigger("review:expand",[e.element,s])}function o(){i(e.element).trigger("review:collapse",[e.element,s])}function c(){t.setPIDCookie(24687),n.trackEvent("Reviews","click","via_mobile_itunes")}function a(e,i){r.setEvtCookie("Reviews","click","title",0,e.href),t.setPIDCookie(i)}var v=i(".reviewSelector",e.element),s=Number(v.attr("data-reviewId"));return{clickExpand:l,clickCollapse:o,viaMobileClick:c,reviewClick:a}})});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"location_reviews_container","handlers",["handlers"]);n(["placement","vanillajs","ta/Core/TA.Event"],function(e,n,t){var a=document.getElementById(e.id);return t.on("paginationChanged",function(n){if(document.getElementById(e.id).contains(n)){var t=a.querySelector("#REVIEWS"),i=a.querySelector("#REVIEWS .review-container"),o={"whiteBoxTopElmt":t,"loadingBoxTopElmt":i};ta.page.applyPaginationOffset(n,o)}}),{}})});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"reviews_member_info_hsx","handlers",["handlers"]);r(["widget","members/memberOverlay","vanillajs"],function(e,r){function i(e,i){return r.initMemberOverlay(e,i,i.id,"Reviews","user_name_photo"),!1}return{initMemberOverlay:i}})});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"reviews_member_info_simple","handlers",["handlers"]);r(["widget","members/memberOverlay","vanillajs"],function(e,r){function i(e,i){return r.initMemberOverlay(e,i,i.id,"Reviews","user_name_photo"),!1}return{initMemberOverlay:i}})});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"reviews_inline_room_tips_hsx","handlers",["handlers"]);n(["widget","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/ajax","vanillajs"],function(e,n,o,i,t,s,l,r){function a(e,a,c,d){var p=new n(null,[o(null,"center","small no_padding"),i.center(),t,s,l,r("/AccommodationTips?d="+c+(d?"&filterLang="+d:""))]);return p.on("contentLoaded",function(){p.contentElement.querySelector("#emptyTips")&&setTimeout(p.hide.bind(p),1)}),p.show(),!1}return{click:a}})});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"reviews_user_links_hsx","handlers",["handlers"]);t(["widget","lib/jquery-amd","utils/stopevent","ta/Core/TA.Record","ta/util/Cookie"],function(e,t,r,a,i){function s(s,n){var u=t(n),d=t(".userLink a",e.element),o=u.attr("data-pid"),c=u.attr("data-locId"),l=u.attr("data-screenName"),v=u.attr("data-memberId"),k=u.attr("data-language"),w=u.attr("data-reviewId"),f=u.attr("data-subject"),_=d.attr("href");if("19169"===o)a.setEvtCookie("Reviews","click","more_reviews_by_user",0,_),i.setPIDCookie(o);else if("38673"===o){if(v)return r(s),require(["trjs!answers/misc"],function(e){e.askReviewerIntercept(n,c,l,v,k,w,f,o)}),!1;r(s),requireCallLast("answers/question_overlay_stub","open",c,o),a.trackEventOnPage("Reviews","click","ask_user")}}return{onclick:s}})});
require(["ta/prwidgets"],function(e){var i=e.define.bind(e,"reviews_basic_review_responsive","handlers",["handlers"]);i(["widget","lib/jquery-amd","ta/util/Cookie","ta/Core/TA.Record"],function(e,i,r,t){function n(){i(e.element).trigger("review:expand",[e.element,o])}function l(){i(e.element).trigger("review:collapse",[e.element,o])}function a(){r.setPIDCookie(24687),t.trackEvent("Reviews","click","via_mobile_itunes")}var c=i(".reviewSelector",e.element),o=Number(c.attr("data-reviewId"));return{clickExpand:n,clickCollapse:l,viaMobileClick:a}})});
require(["ta/prwidgets"],function(n){var t=n.define.bind(n,"common_north_star_pagination","handlers",["handlers"]);t(["widget","vanillajs","ta/Core/TA.Event","common/trackingStreams"],function(n,t,i,a){"use strict";function e(n,t){i.fireEvent("paginationChanged",t)}function r(n,t,i,e,r){a.trackEvent(i,"click",e,r)}return{paginate:e,trackClick:r}})});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"location_reviews_list","handlers",["handlers"]);n(["placement","lib/jquery-amd","overlays/ajaxUtil","ta/Core/TA.Event"],function(e,n,a,d){function i(){l=n("#"+e.id+" .listContainer"),E=[],p={},l.children("[data-reviewId]").each(function(e,n){var a="true"===n.getAttribute("data-collapsed"),d="true"===n.getAttribute("data-deferred"),i=Number(n.getAttribute("data-reviewId")),t={elem:n,id:i,deferred:d,saved:!1,frozen:!a&&!d,expanded:!a&&!d};E.push(t),p[i]=t}),l.off("review:expand",c),l.on("review:expand",c),l.off("review:collapse",s),l.on("review:collapse",s),u(),n(".seeMoreReviewsButton",l).click(function(){n(".seeMoreReviewsButton",l).hide(),n(".collapsedReviewsList",l).show()})}function t(e){var a=p[e];if(a&&a.source&&!a.frozen){var d=a.source,i=a.elem;d.isLoading?n(i).addClass("listingLoading"):d[e]?(n(i).removeClass("listingLoading"),i.innerHTML=d[e],ta.prwidgets.initWidgets(i)):(n(i).removeClass("listingLoading"),i.expandedSource===d&&(i.expandedSource=void 0,i.expanded=!1),i.collapsedSource===d&&(i.collapsedSource=void 0))}}function r(e,n){var a=p[e];a&&!a.frozen&&(!!a.expanded!=!!n||!n&&a.deferred)&&(a.expanded&&!a.expandedSource&&(a.expandedSource={},a.expandedSource[e]=a.elem.innerHTML),a.expanded||a.collapsedSource||a.defered||(a.collapsedSource={},a.collapsedSource[e]=a.elem.innerHTML),a.expanded=n,a.source=n?a.expandedSource:a.collapsedSource,n&&(a.wasExpanded=!0),t(e))}function o(e,a){if(!a.isBusy()&&e.isLoading){var d=document.createElement("div");n(d).html(a.data).children("[data-reviewListingId]").each(function(n,a){e[Number(a.getAttribute("data-reviewListingId"))]=a.innerHTML}),e.isLoading=!1,n.each(E,function(n,a){a.source===e&&t(a.id)})}}function c(e,i,t){var c=[],s=[],u=!1,p={};if(n.each(E,function(e,n){u=u||n.id===t,!u||n.expanded||n.frozen||n.id!==t&&n.wasExpanded||(c.push(n.id),n.expandedSource||(n.expandedSource=p,s.push(n.id)))}),s.length>0){var v="true"===l.attr("data-responsive")?"EXPANDED_REVIEW_RESPONSIVE":"EXPANDED_HOTEL_REVIEW_HSX",g=a.loadOverlayWidget("EXPANDED_HOTEL_REVIEWS",{loadingContent:"",noCache:!0,reqParams:{reviews:String(s),widgetChoice:v}});p.isLoading=!0,g.on("update",o.bind({},p,g)),o(p,g)}return n.each(c,function(e,n){r(n,!0)}),f&&(f=!1,ta.registration.RegOverlay.show({type:"dummy"},e.target||i,{flow:"CORE_COMBINED",pid:39415,onSuccess:function(){}})),d.fireEvent("ReviewExpanded"),!1}function s(e,a,d){n("html, body").animate({scrollTop:n("#review_"+d).offset().top-54},200),r(d,!1)}function u(){var e=[],d={},i="true"===l.attr("data-loadDeferredExpanded"),t=i?"EXPANDED_HOTEL_REVIEWS":"COLLAPSED_HOTEL_REVIEWS",c=l.attr("data-contextChoice"),s="true"===l.attr("data-responsive")?i?"EXPANDED_REVIEW_RESPONSIVE":"REVIEW_RESPONSIVE":i?"EXPANDED_HOTEL_REVIEW_HSX":"BASIC_HOTEL_REVIEW";if(n.each(E,function(n,a){a.deferred&&!a.frozen&&(a.collapsedSource=d,e.push(a.id))}),e.length>0){var u=a.loadOverlayWidget(t,{loadingContent:"",reqParams:{reviews:String(e),contextChoice:c,widgetChoice:s}});d.isLoading=!0,u.on("update",o.bind({},d,u)),o(d,u)}n.each(e,function(e,n){r(n,!1)})}var l=n("#"+e.id+" .listContainer"),E=[],p={},f=!!l.children(".info[data-expansionSoftGate=true]")[0];return i(),d.on("review-list-update",i),{}})});
define("ta/prwidgets",["vanillajs","ns-exporter","purify","amdloaders"],function(e,t,r,n){function i(e,t){var r,n=this.element._prWidgetContext;return"string"==typeof e?(e=[e],r=a(n.widget.name,e),r=r[0]&&y(r[0]),r=r&&o(n,e,[r]),r&&r[0]):(e=e.slice(),void y(a(n.widget.name,e),function(){var r=o(n,e,arguments);t&&t.apply(null,r)}))}function a(e,t,r){var n=m[e];if(!n)return[];t=t.slice();for(var i=0;i<t.length;++i){var a=t[i],o=a.replace(/^[a-z]+!/,""),l=a.substring(0,a.length-o.length);"trhtml!"===l||("widget"===o?t[i]=null:n["trjs!"===l?o:a]&&(t[i]=l+"$prw/"+e+"/"+o))}return t}function o(e,t,r){var n,i;if(r=Array.prototype.slice.apply(r),0===t.length)return r;var o=m[e.widget.name];if(r.length<t.length)for(n=a(e.widget.name,t);(i=r.length)<t.length;)n[i]?r.push(y(n[i])):r.push(null);for(var i=0;i<t.length;++i){var l=t[i].replace(/^trjs!/,"");e[l]?r[i]=e[l]:o[l]&&"function"==typeof r[i]&&(r[i]=r[i].call(null,e))}return r}function l(e){e._prWidgetContext=this.element._prWidgetContext}function u(e){var t,r,n,a,o,u;if(e&&!e._prWidgetContext&&(t=e.getAttribute("data-prwidget-init"),"string"==typeof t&&(n=e.getAttribute("data-prwidget-name")))){t=f(t),o=f(e.getAttribute("data-scriptFlags")).reduce(function(e,t){return e[t]=!0,e},{});var p=t.length;if(u=e.getAttribute("data-prwidget-deferred")){u=f(u);for(var a=0;a<u.length;a++)t.push(u[a])}var d=m[n];for(d||(m[n]=d={}),r={},a=0;a<t.length;a++)d[t[a]]=!0;r.widget={"name":n,"element":e,"modules":t,"flags":o,"markMine":l,"require":i},e._prWidgetContext=r,r.widget.require(t.slice(0,p),function(){if(e._prPendingClick){var t=e._prPendingClick;e._prPendingClick=void 0,t.key===s&&window.setTimeout(function(){h.call.apply(h,t.args)},0)}})}}function f(e){return"string"!=typeof e?[]:e.match(/[^\s,]+(\s+[^\s,]+)*/g)||[]}function p(e){var t=e._prWidgetContext;if(t)return t;for(e=e.parentNode;e&&e.hasAttribute;e=e.parentNode){if(t=e._prWidgetContext)return t;if(e.hasAttribute("data-prwidget-init"))break}}function d(e){for(var t=e;t&&t.hasAttribute;t=t.parentNode)if(t.hasAttribute("data-prwidget-init"))return t}function g(e){e&&e.nodeName&&w.test(e.className||"")&&(e.className=(e.className||"").replace(w,""))}function c(e){e&&e.nodeName&&!w.test(e.className||"")&&(e.className=(e.className||"")+" handlerLoading")}var s,h={},v=define,y=require,m={},w=/\bhandlerLoading *\b/g;return h.define=function(e,t,r,n,i){if(t=t.replace(/\.js$/i,""),"[object Array]"!==Object.prototype.toString.call(n)&&(n=[]),r&&r.length){var l=m[e];l||(m[e]=l={});for(var u=0;u<r.length;u++)l[r[u]]=!0}v("$prw/"+e+"/"+t,a(e,n),function(){var e=Array.prototype.slice.apply(arguments);return function(r){return r[t]||(r[t]=i.apply(null,o(r,n,e))),r[t]}})},h.redefine=function(e,t){return y.undef&&y.undef("$prw/"+e+"/"+t),h.define.apply(this,arguments)},h.getjs=function(e,t){var r=p(e);if(r&&"string"==typeof t)return r.widget.require(t)},h.initWidgets=function(e,t){var n,i;if(e||(e=document),"string"!=typeof e||(e=document.getElementById(e))){if(!t&&(e=r(e,!0),e.forEach))return void e.forEach(function(e){h.initWidgets(e,!0)});for(n=e.querySelectorAll(".prw_rup"),i=0;i<n.length;i++)u(n[i]);for(n=e.querySelectorAll(".prw_dyn"),i=0;i<n.length;i++)u(n[i])}},h.getWidgetElement=function(e,t){return t=t||document.body,t.querySelector(".prw_"+e)},h.call=function(e,t,r,n){if("string"!=typeof e||!r)throw"ta.prwidgets.call() requires method, event||null, element";var i=p(r),a=t&&("click"===t.type||"submit"===t.type);if(a&&(t&&t.preventDefault&&t.preventDefault(),s=void 0),!i){if(a){var o=d(r);o&&!o._prWidgetContext&&(s={},o._prPendingClick={key:s,args:Array.prototype.slice.call(arguments,0)})}return!1}var l=e.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/),u=l[1];l=l[2].split(".");var f=Array.prototype.slice.call(arguments,1),h=function(t){g(r);for(var n=void 0;l.length>0&&t;)n=t,t=t[l.shift()];if("function"!=typeof t)throw"ta.prwidgets.call: '"+e+"' is not a function";return t.apply(n||{},f),!1};return i[u]?h(i[u]):void((a||require.defined("$prw/"+i.widget.name+"/"+u))&&(c(r),i.widget.require(["trjs!"+u],h)))},t.exportTo(h,"ta.prwidgets"),h});
define("ta/util/ajaxPreserves",["vanillajs"],function(){function e(e,n,r){if(r&&n&&e){var a=r.querySelectorAll(".ajax_preserve");if(a.length>0){var t={},l=n.querySelectorAll(".ajax_preserve, .ajax_preserve_noreplace");Array.prototype.forEach.call(l,function(e){var n=e.getAttribute("data-ajax-preserve");n&&(t[n]=e)}),Array.prototype.forEach.call(a,function(n){var r=t[n.getAttribute("data-ajax-preserve")];r&&e(r,n)})}}}var n={};return n.copy=e.bind(null,function(e,n){n.parentNode&&n.parentNode.replaceChild(e,n)}),n.innerCopy=e.bind(null,function(e,n){n.innerHTML=e.innerHTML}),n.replaceContent=function(e,r){for(n.copy(r,e),r.innerHTML="";e.childNodes.length>0;)r.appendChild(e.childNodes[0])},n.setContentElement=function(e,r,a){n.copy(e,r),a?e.parentNode&&e.parentNode.replaceChild(r,e):(e.innerHTML="",e.appendChild(r))},n});
define("utils/nodePreserve",["ta/util/ajaxPreserves"],function(e){"use strict";function r(e,r){for(e.innerHTML="";r.firstChild;)e.appendChild(r.firstChild)}var t={};t.detachNodes=function(e,r){Array.prototype.forEach.call(r.querySelectorAll(".node-preserve, .ajax_preserve"),function(r){var t=r.getAttribute("data-ajax-preserve");t&&(e[t]=r,r.parentNode&&r.parentNode.removeChild(r))})},t.recursiveReattach=function(e,a){var n=a.getAttribute("data-ajax-preserve");if(n&&e[n]){var i=e[n],o=a;o.removeAttribute("id"),o.parentNode&&o.parentNode.replaceChild(i,o),a=i,r(i,o),delete e[n]}for(var d=0;d<a.children.length;d++)t.recursiveReattach(e,a.children[d])};var a=function(a,n,i){var o={};i&&e.innerCopy(a,n),t.detachNodes(o,a),r(a,n),t.recursiveReattach(o,a)};return t.nodePreserve=function(e,r){a(e,r,!1)},t.treePreserve=function(e,r){a(e,r,!0)},t});
define("ta/util/SessionStorage",["vanillajs","ns-exporter"],function(e,t){var n={};return n.canUseSessionStore=function(){try{if(window.sessionStorage){var e="taLsTest";sessionStorage.setItem(e,"1");var t=sessionStorage.getItem(e);return"1"==t}}catch(e){return!1}},n.canUseSessionStore()?(n.setObject=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},n.getObject=function(e){var t=sessionStorage.getItem(e);return t?JSON.parse(t):null},n.remove=function(e){sessionStorage.removeItem(e)}):(n.setObject=function(){},n.getObject=function(){return null},n.remove=function(){}),t.exportTo(n,"ta.util.sessionStorage"),n});
define("hotels/SpecialMessageUtil",["ta/util/SessionStorage","utils/responsive"],function(e,s){function t(e){for(var s=l(),t=0;t<s.length;t++)if(e===s[t])return!1;return!0}function a(e,t){if(e&&e.classList.remove("collapsed"),"BRAND_MESSAGING_DEFAULT"===t&&s.mobile()){var a=l();a.push(t),r(a)}}function i(e,s,t){if(e.classList.add("collapsed"),!t){var a=l();a.indexOf(s)===-1&&a.push(s),r(a)}}function n(e){var s=e.querySelector("[data-messageType]");return s?s.getAttribute("data-messageType"):""}function r(s){for(var t="",a=0;a<s.length;a++)t+=s[a],a!==s.length-1&&(t+="*");e.setObject(o,t)}function l(){var s=e.getObject(o);return s?s.split(u):[]}var o="dismissedMessages",u="*";return{displayMessage:a,dismissMessage:i,shouldDisplayMessage:t,getMessageType:n}});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"hsx_special_messaging","handlers",["handlers"]);t(["placement","ta/Core/TA.FireEvent","ta/prwidgets","utils/nodePreserve","hotels/SpecialMessageUtil"],function(e,t,s,a,n){function r(e){var t=n.getMessageType(e);t&&t!==i&&n.shouldDisplayMessage(t)&&(i=t,e&&e.getAttribute("data-targetEvent")!=l&&(e=e.querySelector('[data-targetEvent="'+l+'"]')),e&&g&&(a.treePreserve(g,e),s.initWidgets(g)))}var i,l="update-"+e.name,g=document.getElementById(e.id);if(t.on(l,r),i=n.getMessageType(g),i&&n.shouldDisplayMessage(i)){var d=g.querySelector(".hsx_special_messaging > .collapsed");n.displayMessage(d,i)}return{}})});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"common_hotel_icons_list","handlers",["handlers"]);t(["widget","common/trackingStreams","page-model"],function(e,t,n){var i=function(e,i){t.trackEvent("UserTracking","impression"===e?"impression":"action",JSON.stringify({"event_name":"hotel_website_icon_link_"+e,"location_id":i,"servlet":n.session.pageServlet}),1)},o=function(e){t.trackEvent("bl_hotel_website_click_non_CPC_test","click",e)},r=e.element.querySelector("[data-locid]");r&&(i("impression",parseInt(r.getAttribute("data-locid"))),e.element.querySelector("[data-curl]")||t.trackEvent("bl_hotel_website_impression_non_CPC_test","impression",r.getAttribute("data-locid"),0,!0));var s=e.element.querySelector("[data-wouldhaveshownhw]");return s&&t.trackEvent("bl_hotel_website_impression_non_CPC_test","impression",s.getAttribute("data-wouldhaveshownhw"),0,!0),{trackHotelWebsiteEvent:i,trackClickNonCommerce:o}})});
define("overlays/styles/tooltip",["vanillajs","api-mod","overlays/utils"],function(t,e,i){"use strict";function n(t,n,r){this.container=e.createElement(r||"span",{"class":"ui_overlay ui_tooltip arrow_"+i.getArrowDir(t,this.sourceElement,this.domParent)+" "+n}),this.arrow=e.createElement("div",{"class":"arrow"}),this.container.appendChild(this.arrow),this.inner=e.createElement("div",{"class":"body_text"}),this.container.appendChild(this.inner),this.contentElement=this.inner}var r=function(t,e,i,r,a){return t&&(i=i||t.getAttribute("data-tooltip"),a=a||t.getAttribute("data-elementtype")),function(){n.call(this,e,i,a),this.updateContent(r)}};return r});
define("hotels/ChildAgesSerialization",["vanillajs"],function(){function n(n){return null==n||0===n.length?[]:n.split(t).map(function(n){return parseInt(n,10)}).filter(function(n){return!isNaN(n)})}function e(n,e){if(null==e||0===e.length)return"";for(var t=Math.floor(e.length/n),l=e.length-t*n,a=[],u=0,o=0;o<n;++o){var f=0;if(f=o<l?t+1:t){var h=Math.min(u+f,e.length),s=e.slice(u,h);u=h,a.push(s.join(i))}}return a.join(r)}var i=",",r=":",t=new RegExp(i+"|"+r);return{deserialize:n,serialize:e}});
define("overlays/EmailHotelOverlay",["ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","hotels/ChildAgesSerialization"],function(e,o,t,s,a,l,r,n,i,c){return function(u,v,m,y){return new Promise(function(d){require(["trjs!ta/t4b/Emailhotel","trcss!t4b/emailhotel"],function(g){function f(){O++,O>=2&&g.init(E)}var p={detail:u,isOfferEmail:v,overrideOfferEmail:m,contactColumn:y},h=ta.page&&ta.page.guests?ta.page.guests.toJson():e.retrieve("guests.rooms.object");h&&(p.rooms=h.rooms,p.guests=(h.adults||h.guests)+c.deserialize(h.child_rm_ages).length);var E=new o(null,[t(null,"center","",""),s.center([0,0]),a,l,r,n(),i("/EmailHotel",{reqParams:p})]),O=0;E.on("contentLoaded",f).on("show",f),d(E)})})}});
define("ta/common/Flyout",["vanillajs","utils/ajax","ns-exporter","ta/Core/TA.Store","overlays/Overlay","overlays/styles/modal","overlays/styles/tooltip","overlays/position","overlays/options/closeOnEscape","overlays/options/closeOnDocClick","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","hotels/ChildAgesSerialization","overlays/EmailHotelOverlay"],function(e,o,n,t,a,l,s,i,r,c,y,u,v,m,p){var w,d={showRecentLocationSaveOverlay:function(){setPID(3832);var e=new a(null,[l(null,"center","RecentlyViewedOverlay",""),i.center([0,0]),r,c,y,u(),v("/RecentlyViewedAjax",{reqParams:{a:"save_overlay"}})]);e.on("show",function(){e.inner.innerHTML.match("emptyRecentlyViewed")&&e.hide()}),e.show()},showEmailHotelOverlay:function(e,o,n,t){p(e,o,n,t).then(function(e){e.show()})},bestValue:function(e,o){e&&e.preventDefault(),o.onmouseover=null;var n=new a(o,[s(o,"below","",""),i.below(),v("/vpages/bestValueFly.html?log=false")]);return n.show(),!1},amenities:function(e,n,t,s){e&&e.preventDefault(),n.onclick=null,t&&t>0&&(setPID(t),o("/ActionRecord?excludeFromVS=false&action=HRAmenitiesFlyout"));var c="/LocationTab?tab=amenities&from="+location.pathname.replace(/^[\/]|-.*$/g,"")+"&suppressLinks="+!!s;return 0==n.id.indexOf("amenity_")&&(c+="&d="+n.id.substring(8)),w=w||new a(n,[l(n,"center","small",""),i.center([0,0]),r,y,u(),v(c,{resources:[amenityOverlayCss]})]),w.show(),!1}};return n.exportTo(d,"ta.common.flyout"),d});
define("ta/util/Link",["vanillajs","utils/object/set-props","utils/stopevent","common/trackingStreams","ajax-request","utils/asdf-encoder","ta/Browser","ns-exporter"],function(e,t,r,a,i,n,o,f){"use strict";var s,l={popResWidth:function(e,r,i){try{var n=475,o=390,f=210;screen.width>1024?(n=800,o=600,f=240):screen.width>800&&(n=620,o=500,f=240);var s=t({width:n,height:o,xOffset:f,yOffset:5},i);l.popup(e,r,s)}catch(t){a.error(t,"ta.util.link - popCustom",e,s)}},popup:function(e,i,f){try{var l=t({name:!1,width:950,height:610,xOffset:!1,yOffset:!1,noScroll:0,aHref:!1,fullOptions:!0,ensureReferrer:!1,isAsdf:!1},f);e&&r(e);var c=!1,p="",d=s;if("undefined"==typeof d&&(d=1),l.aHref||(l.aHref=i.href),l.aHref=l.aHref.replace("%7Cnavarea%7C",ta.meta.link.getPhotoNavArea(i)),l.isAsdf&&l.aHref&&(l.aHref=n.asdf(l.aHref).replace(/&amp;/g,"&")),l.aHref&&l.aHref.indexOf("p=HotelsCom")>-1){l.width=Math.max(l.width,960);try{l.height=Math.max(l.height,window.getHeight(),600)}catch(e){l.height=Math.max(l.height,600)}}if(l.width&&(p+=",width="+l.width),l.height&&(p+=",height="+l.height),l.xOffset&&(p+=",screenX="+l.xOffset+",left="+l.xOffset),l.yOffset&&(p+=",screenY="+l.yOffset+",top="+l.yOffset),o.isChrome||(l.noScroll=1),l.fullOptions){var h=1;o.isIE9orHigher()&&(h=0),p="toolbar=1,resizable=1,menubar="+h+",location=1,status=1,scrollbars="+l.noScroll+p}else p="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+l.noScroll+p;if(l.name||(l.name="p"+d++),s=d,l.ensureReferrer&&o.isIE())try{var u=document.createElement("a");u.target=l.name,u.href=l.aHref,document.body.appendChild(u),c=window.open("",l.name,p),u.click(),document.body.removeChild(u)}catch(t){a.error(t,"ta.util.link - pop ensure referrer",e,l)}else try{c=window.open(l.aHref,l.name,p)}catch(t){a.error(t,"ta.util.link - popping window",e,{"href":l.aHref,"name":l.name,"args":p})}if("undefined"!=typeof c&&null!==c)try{c.opener=self,c.focus()}catch(e){}}catch(t){a.error(t,"ta.util.link - popup",e,l)}},directionsPop:function(e,t,r,n){n&&i("/ActionRecord?action="+n),a.trackEvent("map_pin_overlay","directions_click"),l.popup(e,t,r)},directionsPopInfoCard:function(e,t,r,n){n&&i("/ActionRecord?action="+n),a.trackEvent("dynamic_large_map","map_info_window","directions_cta"),l.popup(e,t,r)},targetBlank:function(e,r,i){try{var o=t({aHref:!1,isAsdf:!1},i);o.isAsdf&&o.aHref&&(o.aHref=n.asdf(o.aHref).replace(/&amp;/g,"&")),o.newTab||navigator.appVersion.indexOf("MSIE 7.")!=-1?window.open(o.aHref,"_blank"):require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("ta.bl_calendar_lb")?ta.servlet.Popup.openExternalWithDefaultOptions(o.aHref):window.open(o.aHref,"_blank")}catch(t){a.error(t,"ta.util.link - targetBlank",e,o)}}};return f.exportTo(l,"ta.util.link"),l});
define("ta/maps/opener",["vanillajs","api-mod","ta/Core/TA.Event","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/autoReposition","overlays/options/closeOnEscape","overlays/styles/windowshade","overlays/utils"],function(e,a,o,r,t,n,s,i,l,p){var c,v,y,d=function(){c&&(v=1,c.hide())};return o.on("mapOverlayOpened",function(){d(),y&&setTimeout(ta.mapsv2.Factory.closeFromOtherThanX,1),y=0}),o.on("mapOverlayClosed",d),{open:function(e,d,m,u){if(2==e){if(!c){var f,h=a.hasClass(document.body,"tablet_desktop"),O=0;h||(O=20,f=l()),c=new r(0,[t(0,"center",0,0,0,p.loadingSpinnerHtml()),n.framed([O,O]),s,i,f]),c.on("hide",function(){v||(y=1),v=0})}v=y=0,c.show()}if(require.defined("maps/performanceMetrics")){var F=require("maps/performanceMetrics");F.baseLayerStart(F.DRAW_TRIGGERS.LOAD)}var R=2==e?"ta.mapsv2.Factory.createPOIMapViaHashRedirect":"ta.maps.Factory.createFloatMapDelay";o.run(R,{},null,null,d,m,u)}}});
require(["ta/prwidgets"],function(t){var e=t.define.bind(t,"common_atf_header_bl","handlers",["handlers"]);e(["widget","vanillajs","ta/common/Flyout","ta/Core/TA.Record","ta/util/Link","ta/Core/TA.Event","overlays/uiOverlay","ta/maps/opener","utils/classnameUtils"],function(t,e,a,i,n,o,r,c,l){function d(t,e){if(f){var a=f.getAttribute("data-locid"),r=e.getAttribute("data-ahref"),c=e.getAttribute("data-trackingkey")||"URL_HOTEL",l=e.getAttribute("data-eventname")||"bl_contact_website",d={"aHref":r,"isAsdf":!0,"detailId":a,"newTab":!0};n.targetBlank(t,e,d),g(e,c),o.fireEvent("onBLClick",t,a);var s={location_id:a,bl_website:r,bl_tracking_key:c};i.trackActionWithJson(l,s)}}function s(t,e,n){if(f){var o=f.getAttribute("data-locid"),r=f.getAttribute("data-context");g(e,"EMAIL");var c={location_id:o};if(i.trackActionWithJson(k,c),n&&"Attraction_Review"===r){var l=ta.util.decoder.base64Decoder(n);window.location="mailto:"+l}else a.showEmailHotelOverlay(o,"false","","")}}function u(t,e){_("TABS_MENU"),g(e,"MENU")}function b(t,e){e&&e.scrollWidth>e.offsetWidth&&r(t,e);var a={location_id:f.getAttribute("data-locid")};i.trackImpressionWithJson(A,a)}function v(t,e){var a={customFilters:[]},n=e.getAttribute("data-mapFilters");n&&(a.customFilters=n.split(",")),c.open(2,null,null,a),i.trackEventOnPage("BusinessListings","click","address");var o={location_id:f.getAttribute("data-locid")};i.trackActionWithJson(A,o)}function g(t,e){var a=f.getAttribute("data-context"),n=f.getAttribute("data-locid"),o=t.getAttribute("data-column"),r=e+"|text|"+o+"||";i.trackEventOnPage(a,r,n,0,!1),i.trackEventOnPage("BusinessListings","BL_CLICK","BL_LINKS")}function _(t){var e=document.getElementById(t);o.fireEvent("HRTab_clickTab",e,300),o.fireEvent("TabHeader_clickTab",e,300)}var f=document.querySelector(".blRow"),A="bl_contact_long_address",k="bl_contact_email";return{onAddressHovered:b,onAddressClicked:v,onWebLinkClicked:d,onEmailClicked:s,onMenuClicked:u}})});
require(["ta/prwidgets"],function(n){var e=n.define.bind(n,"common_manage_listing_cta","handlers",["handlers"]);e(["widget","lib/jquery-amd","ta/Core/TA.Record"],function(n,e,t){"use strict";function i(n){t.trackEventOnPage("Owner","CTA","manage_listing_click");var e=r.attr("data-linkUrl");window.location=e}function a(n){uiOverlay(n,this),t.trackEventOnPage("Owner","CTA","manage_listing_hover")}var r=e(".claim_listing_text",n.element);return r.on({"click":i,"mouseover":a}),t.trackEventOnPage("Owner","CTA","manage_listing_imp"),{}})});
define("utils/ceUtils",["ta","vanillajs","api-mod","mixins/Events","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/options/closeOnEscape","overlays/options/autoReposition","overlays/styles/windowshade","overlays/options/ajax","utils/browserutils","overlays/widgetoverlays"],function(e,t,n,o,i,a,s,l,r,c,h,y,p){function E(){n.mixin(this,new o("showExplanatoryOverlay","hideExplanatoryOverlay","beginInstall","cancelInstall","test"));var t=this;this.detectExtension=function(e,t,n){var o=new Image;o.src="chrome-extension://"+e,o.onload=function(){t&&t()},o.onerror=function(){n&&n()}},this.isChromeExtensionInstalled=function(e,n){t.detectExtension(t.CHROME_EXT_TAG,e,n)},this.showExplanatoryOverlay=function(e){var n=this._getOsClass(),o=p.showLightbox("CHROME_EXPLANATORY_OVERLAY",{version:e,classes:n},{classes:["chrome explanatory",n,e].join(" "),mixins:[s.topCenter([0,284])]});t.emit("showExplanatoryOverlay"),t.on("hideExplanatoryOverlay",function(){o.hide()})},this.showCancelOverlay=function(e){var n=(this._getOsClass(),p.showLightbox("CHROME_CANCEL_OVERLAY",{version:e},{mixins:[s.topCenter([0,284])]}));t.emit("showCancelOverlay"),t.on("hideCancelOverlay",function(){n.hide()})},this._getOsClass=function(){var e=y.Platform.name.match(/(linux|mac|win)/),t="win";return e&&e.length>=1&&(t=e[0]),t},this.installClickHandler=function(n,o,i,a,s){window.event&&(window.event.preventDefault(),window.event.stopPropagation());try{chrome.webstore.install(E.WEBSTORE_URL,function(){e.trackEventOnPage(n,o,"installed",i,!0),t.emit("hideExplanatoryOverlay"),t.emit("installed")},function(a){if(e.trackEventOnPage(n,o+"_e",a,i,!0),/Could not fetch data from the Chrome Web Store|Installs can only be initiated by one of the Chrome Web Store item's verified sites|Inline installs can not be initiated from fullscreen/i.test(a)){var l=E.prototype.WEBSTORE_URL+"?utm_source="+o+"&utm_medium=install_error";location.href=l}t.emit("hideExplanatoryOverlay"),s&&t.showCancelOverlay(i)}),t.showExplanatoryOverlay(a),e.trackEventOnPage(n,o,"click",i)}catch(e){console.log(e)}},this.hrPriceWatchClick=function(e,n,o,i,a,s){e.classList.contains("ce-installed")||(t.on("installed",function(){e.addClass("ce-installed")}),t.installClickHandler(n,o,i,a,s))}}E.prototype.CHROME_EXT_ID="oiekdmlabennjdpgimlcpmphdjphlcha",E.prototype.CHROME_EXT_TAG=E.prototype.CHROME_EXT_ID+"/images/owl-48.png",E.prototype.WEBSTORE_URL="https://chrome.google.com/webstore/detail/"+E.prototype.CHROME_EXT_ID,E.prototype.PINTEREST_EXT_ID="";return new E});
require(["ta/p13n/placements"],function(a){var e=a.define.bind(a,"location_detail_header","handlers",["handlers"]);e(["placement","ta/Core/TA.Event","ta/maps/opener","lib/jquery-amd","ta/Core/TA.Record","ta/prwidgets","utils/nodePreserve","utils/ceUtils"],function(a,e,n,t,r,i,o,c){"use strict";function s(a,n){e.call("ta.attractions.showMoreTags",a,n)}var l=function(e){var n=document.getElementById(a.id),t=n.querySelector(".headerBL"),r=e.querySelector(".headerBL");o.treePreserve(t,r)};return e.on("update-"+a.name,l),a.params.animalAttraction&&r.trackEventOnPage(a.params.animTrackingPageProperty,a.params.animTrackingPageActionPrefix+"_paw_display","",0,!0),t(".header_rating .more","#"+a.id).on("click",function(){a.params.isHotelReview?r.trackEventOnPage("Ratings_Info","review_count",""):r.trackEventOnPage("RATINGS_INFO","REVIEWS_LINK","click")}),t(".animal_tag","#"+a.id).on("click",function(){r.trackEventOnPage(a.params.animTrackingPageProperty,a.params.animTrackingPageActionPrefix+"_paw_button","")}),t("#ANIMAL_LEARN_MORE","#"+a.id).on("click",function(){r.trackEventOnPage(a.params.animTrackingPageProperty,a.params.animTrackingPageActionPrefix+"_paw_portal",""),window.open(a.params.featAnimPortalUrl,"_blank")}),c.isChromeExtensionInstalled(function(){t(".price_watch_button_reg").closest("div").remove()},function(){}),{onAttrShowMoreTagsClick:s}})});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"bl_hr_overview_special_offer","handlers",["handlers"]);n(["widget","ta/servlet/ShowSpecialOffer","common/trackingStreams","vanillajs"],function(e,n,t){function i(e,i,o,r,a,c,l,s){var u,f,_=a?String(a):"",v=c?String(c):"";if(a&&c)f="viewcouponandannouncement",u="BL_COUPON_ANOUNCEMENT";else if(a)f="viewcoupon",u="BL_COUPON";else{if(!c)return!1;f="viewannouncement",u="BL_ANOUNCEMENT"}u=u+"|text|1|||"+l;var p=""+r+"|"+_+"|"+v;t.trackEvent(o,u,p,1,!1),a&&t.trackUnifiedEvent("bl_special_offer","action",{"location_id":r,"pagename":require("page-model").session.lookbackServlet,"so_type":"URL_PACKAGES","bl_contact_type":u}),require(["trjs!ta/common/Flyout","trjs!ta/servlet/BLCoupons"],function(){n.openCoupon(f,""+_,v,String(r),s,"",o,"",!1)})}return{click:i}})});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"common_ratings_histogram_overview","handlers",["handlers"]);r(["widget","ta/Core/TA.FireEvent"],function(e,r){function i(e,i,t,n){if(require.defined("common/page-filters")){var a=require("common/page-filters");a.clearAll("trating"),a.set("trating",t)}else r.fireEvent("review_filters.toggle_rating",t,n);r.fireEvent("TabHeader_clickTab",document.getElementById("TABS_REVIEWS"),300)}return{click:i}})});
require(["ta/prwidgets"],function(t){var e=t.define.bind(t,"bl_hr_overview_contact_offer","handlers",["handlers"]);e(["widget","ta/util/Link","ta/util/Cookie","common/trackingStreams"],function(t,e,a,i){function n(n,r,o){var c=r.getAttribute("data-obf-url"),d=r.getAttribute("data-pid"),l=r.getAttribute("data-column"),u=r.getAttribute("data-contact-type"),s=r.getAttribute("data-location"),g=r.getAttribute("data-context"),b=u+"|text|"+l+"||";i.trackEvent(g,b,s,0,!1),i.trackEvent("BusinessListings","BL_CLICK","BL_LINKS"),i.trackUnifiedEvent(o,"action",{"location_id":s,"pagename":require("page-model").session.lookbackServlet,"bl_contact_type":u}),d&&a.setPIDCookie(d),e.targetBlank(n,r,{"aHref":c,"isAsdf":!0,"detailId":t.location_id,"newTab":!0})}return{onOfferClick:n}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"location_detail_overview","handlers",["handlers"]);t(["placement","lib/jquery-amd","ta/util/Link","ta/util/Cookie","ta/Core/TA.Record","ta/Core/TA.Event"],function(e,t,i,a,n,r){function o(e){e.preventDefault();var i=t(this).attr("data-target-tab");l(i)}function d(e){e.preventDefault&&e.preventDefault();var i=t(e.target),a=i.attr("data-keyword");r.fireEvent("reviews-clearTagsAndQuery",function(){"true"===i.attr("data-issearchterm")?(t("#REVIEWS .search-input input").val(a),r.fireEvent("reviews-search",a)):r.fireEvent("reviews-selectTag",a.toLowerCase())}),l("TABS_REVIEWS")}function l(e){var t=document.getElementById(e);r.fireEvent("TabHeader_clickTab",t,300)}function c(){var i=t("#"+e.id);t(".reviewSnippets.defer",i).length&&e.require(["trhtml!deferred/translatedSnippets"],function(e){t(".reviewSnippets",i).replaceWith(e)})}r.queueForReady(function(){if(t("#"+e.id).children().length){c();var i=t("#"+e.id+" .detailsMid"),a=t("#"+e.id+" .seeHotelDetails");if(a&&a.position()){var n=i.find(".highlightedAmenity").toArray(),l=i.find(".unavailableAmenity").toArray();for(n=n.concat(l);(a.position().left+a.width()>i.width()||a.position().top+a.height()>i.height())&&n.length;)t(n.pop()).remove()}r.on("reasons-keywordClick",d),t("#"+e.id+" [data-target-tab]").on("click",o),t("#"+e.id+" [data-keyword]").on("click",d)}},"initialize "+e.name)})});
/*
 * hoverIntent v1.8.1 // 2014.08.11 // jQuery v1.9.1+
 * http://briancherne.github.io/jquery-hoverIntent/
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
define("lib/jquery/jquery.hoverIntent",["lib/jquery-amd"],function(d){var h={interval:100,sensitivity:6,timeout:0};var i=0;var g,f;var b=function(j){g=j.pageX;f=j.pageY};var a=function(m,k,l,j){if(Math.sqrt((l.pX-g)*(l.pX-g)+(l.pY-f)*(l.pY-f))<j.sensitivity){k.off(l.event,b);delete l.timeoutId;l.isActive=true;m.pageX=g;m.pageY=f;delete l.pX;delete l.pY;return j.over.apply(k[0],[m])}else{l.pX=g;l.pY=f;l.timeoutId=setTimeout(function(){a(m,k,l,j)},j.interval)}};var e=function(m,k,l,j){delete k.data("hoverIntent")[l.id];return j.apply(k[0],[m])};return function c(n,o,j){var m=i++;var l=d.extend({},h);if(d.isPlainObject(n)){l=d.extend(l,n);if(!d.isFunction(l.out)){l.out=l.over}}else{if(d.isFunction(o)){l=d.extend(l,{over:n,out:o,selector:j})}else{l=d.extend(l,{over:n,out:n,selector:o})}}var k=function(u){var s=d.extend({},u);var q=d(this);var p=q.data("hoverIntent");if(!p){q.data("hoverIntent",(p={}))}var t=p[m];if(!t){p[m]=t={id:m}}if(t.timeoutId){t.timeoutId=clearTimeout(t.timeoutId)}var r=t.event="mousemove.hoverIntent.hoverIntent"+m;if(u.type==="mouseenter"){if(t.isActive){return}t.pX=s.pageX;t.pY=s.pageY;q.off(r,b).on(r,b);t.timeoutId=setTimeout(function(){a(s,q,t,l)},l.interval)}else{if(!t.isActive){return}q.off(r,b);t.timeoutId=setTimeout(function(){e(s,q,t,l.out)},l.timeout)}};return this.on({"mouseenter.hoverIntent":k,"mouseleave.hoverIntent":k},l.selector)}});
define("ta/util/Element",["lib/jquery-amd","utils/ajax","ta/Core/TA.Record","ns-exporter","ta/Core/TA.Event","lib/jquery/jquery.hoverIntent","utils/throttle"],function(t,e,i,n,o,r,a){function l(e,i){var n=e.style.fontSize||t(e).css("font-size"),o=n.replace(/[\d\.]/g,""),r=c(o,parseFloat(n)*i);e.style.fontSize=r+o}function s(){function e(e,i){var r=n[e],a=t(r.e);if(a.length>0){var l=r.inView;r.inView=!1,a.each(function(){return!r.inView&&void(r.inView=o.inViewport(this,i,r.persistentElmt,r.offset))}),!l&&r.inView&&(r.cb&&r.cb(r.e),r.multiple||n.splice(e,1))}}function i(){var e=t(window),i={};return i.top=e.scrollTop(),i.left=e.scrollLeft(),i.bottom=i.top+e.height(),i.right=i.left+e.width(),i}var n=[],o=this;this.add=function(i){n.push(i),e(n.length-1),n.length>0&&t(window).on("resize scroll",r)},this.inViewport=function(e,n,o,r){if(e=t(e),!e.is(":visible"))return!1;if(r=t.extend({top:0,left:0,right:0,bottom:0},r),o){var a=o.offsetHeight;a&&(0==o.offsetTop?r.bottom-=a:r.top+=a)}var l=e.offset();return n||(n=i()),n.bottom>=Math.max(l.top+r.top,0)&&n.right>=Math.max(l.left+r.left,0)&&n.top<=Math.max(l.top+e.height()+r.bottom,0)&&n.left<=Math.max(l.left+e.width()+r.right,0)};var r=a(function(){if(n.length){for(var o=i(),a=n.length-1;a>=0;a--)e(a,o);0==n.length&&t(window).off("resize scroll",r)}},300);t(window).on("load",r)}var f={};f.replaceContent=function(i,n,o,r){if(n=t(n),!n.find(".progresstab")){var a=o+(o.indexOf("?")==-1?"?":"&")+"xhr=true";n.append('<div class="progresstab"></div>'),e({url:a,success:function(t){n.html(t),window.behavior&&window.behavior.apply(n),r&&r(n.get(0))},evalScripts:!0}).get()}},f.spinner=function(e,i){t(i).parents(".spinnerReplaceable").children().each(function(t,e){e.toggle(e.hasClass("spinner"))})},f.limitLength=function(t,e,i){return!(e.value.length>=i)||(e.value=e.value.substr(0,i),!1)},f.updateValue=function(e,i){if(e=t(e),e.length>0&&e.val()!=i){e.val(i);var n=document.createEvent("HTMLEvents");n.initEvent("change",!1,!1),e[0].dispatchEvent(n)}},f.keepInWindow=function(e,i){function n(t,e){var i=parseInt(t.get(0).style[e]);return i||0===i}if(e){e=t(e),i||(i={top:!0,right:!0,bottom:!0,left:!0});var o=2,r=e.offset();r.right=r.left+e.width(),r.bottom=r.top+e.height();var a=t(window),l=a.width(),s=a.height(),f=a.scrollTop(),c=a.scrollLeft();i.right&&n(e,"right")?r.left<c+o?e.css("right",l+c-e.width()-o):r.right>l-c-o&&e.css("right",o):i.left&&n(e,"left")&&(r.left<c+o?e.css("left",o):r.right>l-c-o&&e.setStyle("left",l+c-r.width-o)),i.bottom&&n(e,"bottom")?r.top<f+o?e.setStyle("bottom",s+f-r.height-o):r.bottom>s-f-o&&e.setStyle("bottom",o):i.top&&n(e,"top")&&(r.top<f+o?e.setStyle("top",o):r.bottom>s-f-o&&e.setStyle("top",s+f-r.height-o))}};var c=function(t,e){var i=e;return"px"==t?i=8:"em"==t?i=.5:"pt"==t?i=6:"%"==t&&(i=50),Math.max(e,i)};f.makeTextFit=function(e,i,n,r,a){a=a||1,r=r||8;var l=!1;if(t(e).each(function(e,o){o=t(o);var a=o.find(i);if(a){var s;if("number"==typeof n)s=n;else if(s=o.find(n).outerHeight(),void 0===s)return;var f=a.height();if(s<f){var c=a.css("font-size");if(c){var u=function(t,e){return"px"==e&&t>=r||"em"==e&&t>=.5||"pt"==e&&t>6||"%"==e&&t>=50},h=c.replace(/[\d\.]/g,""),d=parseFloat(c)*Math.sqrt(s/f);"px"==h&&(d=Math.max(parseInt(d),r)),u(d,h)&&(a.css("font-size",d+h),l=!0)}}}}),l>0&&a<4){o.fireEvent("makeTextFitResizedText");var s=this;setTimeout(function(){s.makeTextFit(e,i,n,r,a+1)},1)}},function(){function e(t){var e=!1;if(!t||t.clientWidth&&t.clientWidth<=0)return!1;for(var i=t.clientWidth,n=(parseFloat(t.style.paddingLeft)||0)+(parseFloat(t.style.paddingRight)||0),o=0;o<a&&t.scrollWidth>i;o++){var r=(i-n)/(t.scrollWidth-n);l(t,r),e=!0}return t.scrollWidth>i&&(l(t,s),e=!0),e}function i(t,e){var i=t.getAttribute("data-sizegroup"),n=parseFloat(t.style.fontSize);i&&(e[i]=Math.min(e[i]||Number.MAX_VALUE,n))}function n(t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=[];n.forEach(function(t){o.push([t.scrollWidth,t])}),o.sort(function(t,e){return e[0]-t[0]});for(var r=0;r<o.length&&e(o[r][1]);r++);}}function r(t){var i;for(var n in t)t.hasOwnProperty(n)&&(i={},t[n].forEach(function(t){var n=t.innerHTML,o=i[n];void 0!==o?0!=o&&(t.style.fontSize=o):e(t)?i[n]=t.style.fontSize||0:i[n]=0}))}var a=4,s=.9;f.makeTextFitOneLine=function(i,n){var o=t(i);if(o.each(function(t,i){e(i)}),n){var r;o.each(function(e,i){var n=t(i).css("font-size");(!r||parseFloat(n)<parseFloat(r))&&(r=n)}),r&&o.css("font-size",r)}},f.autoResizeTextInNode=function(o){o=t(o);var a=t(".autoResize",o),l={},s={width:{},text:{}};a.filter(":visible").removeClass("autoResize").each(function(t,n){var o,r,a=n.getAttribute("data-resizeWidthGroup"),f=n.getAttribute("data-resizeTextGroup");a?(o=s.width,r=a):f&&(o=s.text,r=f),o?(o[r]||(o[r]=[]),o[r].push(n)):(e(n),i(n,l))}),n(s.width),r(s.text),a.each(function(t,e){var i=e.getAttribute("data-sizegroup");i&&(e.style.fontSize=l[i]+"px")})},o.queueForLoad(function(){require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("no-old-resize")||(o.on("refreshedDOMContent",function(t){f.autoResizeTextInNode(t)}),document.body&&f.autoResizeTextInNode(document.body))},"autoResize all targets on load")}(),f.makeSameWidth=function(e){var i=0;t(e).each(function(t,e){var n=Math.round(parseFloat(e.style.width));n&&n>i&&(i=n)}).css("width",i)},f.fitToContentsHorizontally=function(e,i,n,o){if(o=o||1,!(o<=0||i>n)){var r=function(t){return t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight};t(e).each(function(t,e){e.style.width=i;for(var a=i;a<n&&r(e);a+=o)e.style.width=a;r(e)&&(e.style.width=n)})}},f.scrollIntoView=function(e,i,n,o){if(e){e=t(e);var r=e.offset().top+(i||0);if(n){for(var a=t("html, body"),l=e.parent(),s=function(t){return("auto"===t.css("overflow-y")||"scroll"===t.css("overflow-y"))&&t[0].scrollHeight>t[0].clientHeight};l.length&&!l.is(a)&&!s(l);)l=l.parent();l.length&&!l.is(a)&&s(l)?r=l.offset().top+l.scrollTop()+(i||0):l=a,l.animate({scrollTop:r},{duration:300,complete:function(){o&&o()}})}else window.scrollTo(0,r),o&&o()}};var u=f.scrollTrackers=new s;return f.isScrolledIntoView=function(t,e,i){return u.inViewport(t,null,e,i)},f.doIfElementIsVisible=function(t,e,i,n){t&&u.add({e:t,cb:function(){return e.apply(null,i),!0},offset:n})},f.trackWhenScrolledIntoView=function(t,e,n){if(t&&e){var o=function(){i.trackEventOnPage.apply(i,e)};u.add({e:t,cb:o,multiple:n})}},f.getTotalWidth=function(e){return t(e).outerWidth(!0)||0},f.getTotalHeight=function(e){return t(e).outerHeight(!0)||0},f.hoverIntent=function(e,i){r.bind(t(e),i)()},n.exportTo(f,"ta.util.element"),f});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"location_detail_review_highlight","handlers",["handlers"]);t(["placement","api-mod","ta/Core/TA.Event","ta/util/Element"],function(e,t,n,i){var a=function(e){e.preventDefault();var t=this.getAttribute("data-target-tab");n.fireEvent("TabHeader_clickTab",document.getElementById(t),300)},r=function(e,n){var i=document.getElementById("review_"+e);i?t.fireEvent(i,"review:expand",[i,e]):window.location.href=n},d=function(e,t){var n=document.getElementById("review_"+e);n?i.scrollIntoView(n,-54):window.location.href=t};return n.queueForReady(function(){t.addEvent("#"+e.id+" [data-target-tab]","click",a)},"initialize "+e.name),{expandReview:r,scrollIfPresent:d}})});
define("utils/ScrollInContainer",["lib/jquery-amd","ta/Core/TA.Event","utils/throttle"],function(t,e,o){function i(e){function i(o,i){if(!b&&"undefined"!=typeof h){o=o||window.event;var n,d=e.topMargin+(t(e.topDodgeFixed).outerHeight()||0);n=e.topAnchor?t(e.topAnchor).offset().top+t(e.topAnchor).height():r.offset().top;var u,w=t(window).scrollTop()+d,p=0,m=0;if(w>n){var y=t(e.bottomAnchor);p=y.length?y.offset().top:n+r.height(),p-=f(),w+s.height()>=p?(u="absolute",m=e.bottomMargin,a?m+=n+r.height()-p:m=l.height()+l.offset().top-(y.length?y.offset().top:0)):u="fixed"}else u="static";if(u!==v||i||!o||"resize"===o.type){if(o&&"resize"===o.type&&"right"===e.stickySide){var A=l.width();c+=A-g,g=A}if(v=u,"fixed"===u)s.css({bottom:"auto",top:d,left:r.offset().left+h});else if("absolute"===u){var S=s.offset().left,x=r.offset().left;c=a?S-x:S-l.offset().left,s.css({bottom:m,top:"auto",left:c})}if(s.css({position:v}),"center"===e.stickySide){var z=r.innerWidth()/2-s.width()/2;"fixed"===u&&(z+=r.offset().left),s.css("left",z)}}}}function f(){var o=t(y),i=e.bottomMargin;return"Restaurant_Review"===window.pageServlet&&o.length>0&&(i+=750),i}function n(e){var f=Date.now();i(e);var r=Date.now()-f;r>u&&(p++,p>=w&&(t(window).off("scroll resize",n),t(window).on("scroll resize",o(i,300))))}var r,s,l,a,h,c,d,g,u=50,w=5,p=0,v="static",b=!1,m=!0,y=".belowScrolingAd";e=t.extend({bottomMargin:0,topMargin:0,stickySide:"left"},e),this.init=function(o,f){var u=t(e.bottomAnchor);if(u.length){r=t(o),s&&s.is(f)||(s=t(f),l=s.offsetParent()),v="",g=l.width();var w=s.width();if(m){m=!1;var p=s.offset().left,b=r.offset().left;h=p-b,a=l.is(r),c=a?p-b:p-l.offset().left,t(window).on("scroll resize",n)}else{var y=d-w;y&&(h+=y,"right"===e.stickySide&&(c+=y))}d=w,i()}},this.test=function(){i(null,!0)}}return i});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"location_detail_two_column","handlers",["handlers"]);t(["placement","lib/jquery-amd","ta/Core/TA.Event","utils/ScrollInContainer"],function(e,t,n,i){n.queueForLoad(function(){var a,d=t(".ad_column","#"+e.id);"Restaurant_Review"===window.pageServlet&&d.addClass("adPosLifted");var o=d.height();if(o>=600&&(a=t(".iab_medRec",d)),a&&a.length){a.removeClass("inactive");var r=new i({topMargin:24,topDodgeFixed:".persistent_tabs_header.fixed",bottomAnchor:"#"+e.id+" .unified.ui_pagination"});n.on("onHACUpdateComplete",function(){r.init(d.get(0),d.find(".ad:not(.inactive)").closest(".adParent").get(0))}),n.on("qaListUpdated",r.test.bind(r)),n.on("reviewListUpdated",r.test.bind(r)),n.on("onAdRender",function(e){d.get(0).contains(document.getElementById(e.domId))&&r.init(d.get(0),d.find(".ad:not(.inactive)").closest(".adParent").get(0))})}},"select BTF ad size")})});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"common_btf_nearby_intro","handlers",["handlers"]);n(["widget","lib/jquery-amd","ta/Core/TA.Event"],function(e,n,i){var t=e.element,r=function(){var e=n(".seeMore",t),i=n(".introTextExtension",t),r=e.hasClass("hidden");i.toggleClass("hidden",r),e.toggleClass("hidden",!r)},o=function(){n(".seeMore, .seeLess",t).on("click",r)};return i.queueForLoad(o,"initialize "+e.name),{}})});
define("ta/popups/BeforePopTargetBlankIE",["ta/Browser","ta/util/Cookie"],function(e,t){return function(o){var n;return!o||!o.href||"_blank"!==o.target||(e.isIE10Metro()||(n=e.isIE9orHigher()?window.open(o.href,"_blank"):window.open(url,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight)),!(n&&!n.closed&&"undefined"!=typeof n.closed)&&(o.target="",t.setPIDCookie(38821),!0))}});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"common_static_map_no_style","handlers",["handlers"]);n(["widget","ta/popups/BeforePopTargetBlankIE"],function(e,n){})});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"common_btf_nearby_poi_grid","handlers",["handlers"]);r(["babel/babel-helpers","widget","common/trackingStreams"],function(e,r,n){"use strict";function t(e){n.trackEvent("seeAllNearby","click",e)}return{trackSeeAll:t}})});
require(["ta/prwidgets"],function(t){var e=t.define.bind(t,"common_inline_map","handlers",["handlers"]);e(["widget","vanillajs","ta/Core/TA.Load","ta/Core/TA.Store","ta/Core/TA.Event"],function(t,e,a,i,n){function r(){if(h&&!i.retrieve("mapInitialized")){var t=h.getAttribute("data-map-height"),e=h.getAttribute("data-map-width");I.style.height=t+"px",I.style.width=e+"px";var n=JSON.parse(h.getAttribute("data-map-js")),r=h.getAttribute("data-map-key"),o=h.getAttribute("data-map-version");a.loadInOrder(n,function(){i.store(r,o);var t=s();ta.mapsv2.InlineNearbyMap.loadMapsAPI(function(){g=ta.api.maps.providerFactory.createProviderImplementationInstance(),g.setupMap(t),i.store("mapInitialized")})})}}function o(t,e){if(I===e&&m){var a=t.getAttribute("data-locid"),i=t.getAttribute("data-pinHoverImg");a&&i&&(g.setIcon(a,i,!0),g.setZIndex(a,f))}}function d(t,e){if(I===e&&m){var a=t.getAttribute("data-locid"),i=t.getAttribute("data-pinimg");a&&i&&(g.setIcon(a,i,!0),g.setZIndex(a,b))}}function u(t){n.fireEvent("pinHoverStart",I,t);var e=document.querySelector('[data-locid="'+t+'"]'),a=e?e.getAttribute("data-pinHoverImg"):null;t&&a&&(g.setIcon(t,a,!0),g.setZIndex(t,f))}function l(t){n.fireEvent("pinHoverEnd",I,t);var e=document.querySelector('[data-locid="'+t+'"]'),a=e?e.getAttribute("data-pinimg"):null;t&&a&&(g.setIcon(t,a,!0),g.setZIndex(t,b))}function s(){if(!h)return{};var t=h.getAttribute("data-lat"),e=h.getAttribute("data-lng");return{container:h,initialZoom:18,onload:c.bind(this),initialLocation:{lat:function(){return t},lng:function(){return e}},onPinHoverStart:u.bind(this),onPinHoverEnd:l.bind(this),enableScrollwheel:!1,disableDefaultMapControl:!0}}function c(){h.getAttribute("data-pinimg");p(h,v,A);for(var t=document.getElementsByClassName("shownOnMap"),e=0;e<t.length;++e)p(t[e],b,A);g.zoomAndPanToFitAllMarkers(),n.on("poiHoverStart",o),n.on("poiHoverEnd",d),m=!0}function p(t,e,a){var i=t.getAttribute("data-pinimg"),n=t.getAttribute("data-name"),r=t.getAttribute("data-locid"),o=t.getAttribute("data-lat"),d=t.getAttribute("data-lng"),u=new ta.maps.util.GeoPoint(o,d),l=g.constructMarkerDef(u,r,i,{name:n,id:r,dispid:r,position:u,image:i,size:a},e,!1);g.addMarkerFromMarkerDef(l)}var g,m=!1,v=4,b=2,f=3,A=101,I=t.element,h=I.querySelector(".mapContainer");return n.queueForLoad(r,"start inline map initialization"),{}})});
define("ta/util/openNewTab",["utils/browserutils","ta/Browser","ta/util/Cookie"],function(e,o,t){return function(n){var i;return o.isIE10Metro()||(i=e.ie&&!o.isIE9orHigher()?window.open(n,"_blank","location=yes,resizable=yes,menubar=yes,scrollbars=yes,toolbar=yes,width="+document.documentElement.clientWidth+",height="+document.documentElement.clientHeight):window.open(n,"_blank")),!i||i.closed||"undefined"==typeof i.closed?(t.setPIDCookie(38821),window.location=n,!1):i}});
require(["ta/prwidgets"],function(n){var e=n.define.bind(n,"common_btf_nearby_poi_entry","handlers",["handlers"]);e(["widget","vanillajs","ta/util/openNewTab","common/trackingStreams"],function(n,e,t,i){return{click:function(n,e){e&&i.trackEvent("nearby","click",e),t(n)}}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"location_nearby","handlers",["trcss!deferred/placement","handlers"]);t(["placement","vanillajs","ta/Core/TA.Event","ta/util/Element"],function(e,t,n,r){var o=document.querySelector("#"+e.id),i=document.querySelector("#"+e.id+" .nearbyContainer"),a=function(){e.require(["ta/prwidgets","trcss!deferred/placement","trhtml!deferred/neighborhood"],function(t,r,i){var a=document.querySelector("#"+e.id+" .mapTile .dynamicMap");a.appendChild(i),t.initWidgets(o);for(var c=o.getElementsByClassName("poiEntry"),s=0;s<c.length;++s){var u=c[s];u.addEventListener("mouseenter",function(){var e=document.getElementsByClassName("btfNearby")[0];n.fireEvent("poiHoverStart",this,e)}),u.addEventListener("mouseleave",function(){var e=document.getElementsByClassName("btfNearby")[0];n.fireEvent("poiHoverEnd",this,e)})}n.on("pinHoverStart",l),n.on("pinHoverEnd",d)})},l=function(t,n){if(o.contains(t)){var r=document.querySelector("#"+e.id+' [data-locid="'+n+'"]');r.classList.add("pinHover")}},d=function(t,n){if(o.contains(t)){var r=document.querySelector("#"+e.id+' [data-locid="'+n+'"]');r.classList.remove("pinHover")}},c=function(e){var t=document.querySelector(".poiGrid.hotel"),n=document.querySelectorAll(".poiGrid.hotel .poiTile").length;n<e&&t.classList.add("lowContent")};return o.hasChildNodes()&&(n.on("nearbyHACComplete",function(){c(2),a()}),n.queueForLoad(function(){r.doIfElementIsVisible(i,function(){e.require(["trjs!hotels/SimilarHotelsCrossSellAjaxRenderer"],function(t){var n={};n.containerSelector=".poiGrid.hotel .container",n.oldRecsSelector=".poiTile",n.newRecsSelector=".hotel .poiTile",n.dataEntrySelector=".poiEntry",n.locIdAttribute="data-locid",n.maxEntryNum=4,n.finishEvent="nearbyHACComplete";var r=new t(e,n);r.load()})},{},{top:-500})},"initialize "+e.name)),{}})});
require(["ta/p13n/placements"],function(t){var a=t.define.bind(t,"location_persistent_tabs_header","handlers",["handlers"]);a(["placement","lib/jquery-amd","tab_bar/TabBar","tab_bar/ScrollPastBottom","tab_bar/MoreTab","tab_bar/HighlightActiveTab","tab_bar/StickyBar","tab_bar/CorrectLazyLoadOffset","ta/Core/TA.Record","ta/Core/TA.Event","ta/Core/TA.Store"],function(t,a,e,n,r,i,o,s,c,b,d){function _(){b.queueForLoad(p,"initialize "+t.id)}function l(){var n=a(".persistent_tabs_container"),r=a(".persistent_tabs_header:not(.persistent_tabs_spacer)");T=new e({tabBar:n,content:a(".tabs_pers_content",n),tabs:".tabs_pers_item, .tabs_commerce_button"},{clickOffset:68},g(n,r)),T.init().on("activeChanged",function(t,e){var n=a(e);if(!T.isScrolling()){var r=n.attr("data-anchor");c.trackEventOnPage("Tab_Bar",r+"_SCROLL",r)}u(n)}).on("beforeTabClick",function(t){t=a(t);var e=t.attr("data-anchor");c.trackEventOnPage("Tab_Bar",t.attr("data-track"),e)}).on("beforeSticky",function(a){var e=(t.params.eventPrefix||"")+a?"TabBarFixBegin":"TabBarUnFixBegin";b.fireEvent(e)}).on("afterSticky",function(t){t&&b.fireEvent("scrollingTabs_updateTabBar",{"height":a(".persistent_tabs_header").height()})}).on("redraw",function(){var t=a(".tabs_pers_content .tabs_pers_item:not(.hidden)");t.length>=1&&n.removeClass("invisible")})}function h(){var t=a(".tabs_pers_item:not(.hidden)");t.each(function(){var t=a(this),e=t.attr("data-anchor");a('[data-tab="'+e+'"]').length||t.addClass("hidden")})}function f(){b.on("TabHeader_clickTab",function(t,e){T.show(a(t),e?e:1)}),b.on("TabHeader_enableTab",function(t){var e=a("#"+t);e.length&&(e.removeClass("hidden"),T.redraw())}),b.on("tabExpand_End",function(){u(a(T.getActiveTab()))})}function u(e){var n=t.params.dealInactiveTab,r=t.params.dealInactiveClass,i=a('[data-tab="'+n+'"]');if(n&&i.length){var o=e.length&&n===e.attr("data-anchor");o&&r&&(o=!!a("."+r,i).length);var s=a("#PriceButton");s.hasClass("hidden")!==!!o&&(s.toggleClass("hidden",o),T.redraw())}}function v(){var t=window.location.hash&&window.location.hash.substring(1);if(t){var e=document.getElementById("TABS_"+t);e&&T.show(a(e))}}function p(){var t=a(".persistent_tabs_header:not(.persistent_tabs_spacer)");t.length&&(h(),l(),f(),v())}function g(t,e){var c="#PriceButton, "+(d.has("feature.flat_buttons")?".prices_backtotop":".tabs_pers_back"),b=[n(),r({tab:".tabs_more",content:".tabs_more .tabs_more_content",dodge:a(c,t)}),i({offset:150}),s()];return window.isTabletOnFullSite||b.push(o(e,{stickyClass:"fixed",lastYOffset:-50,transitionDuration:150})),b}var T=null;return _(),{}})});
define("ta/util/ReCaptcha",["vanillajs","ns-exporter","common/trackingStreams"],function(e,t,r){"use strict";var n=!1,a={},c={},o="",i=function(e){if(e<0)return 300;switch(e){case 0:return 0;case 1:return 250;case 2:return 500;case 3:return 1e3;default:return 2e3}},l=function(e,t){require.defined("ta/util/Error")?require("ta/util/Error").record(e,t):ta.merror&&ta.merror.recordError&&"function"==typeof ta.merror.recordError&&ta.merror.recordError(t,null,null,null,e)},u=function(){r.trackEvent("captcha","recaptcha","displayed")},d=function(e,t){var r=document.getElementById(t);return r&&"INPUT"===r.tagName?void(r.value=e||""):void l(null,"The recaptcha input id was not found on the page: "+t)},p={init:function(e,t,r,a){try{if(c[r]=a,n)return;e||l(null,"No language specified for recaptcha."),t&&(o=t);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.defer=!0,i.src="https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl="+e,document.getElementsByTagName("head")[0].appendChild(i),n=!0}catch(e){l(e,"Could not inject recaptcha script on to page.")}},reset:function(e){if(!e)return void l(null,"No reset key specified.");if(a[e]||0===a[e])try{"undefined"!=typeof grecaptcha&&grecaptcha&&grecaptcha.reset&&"function"==typeof grecaptcha.reset&&grecaptcha.reset(a[e])}catch(t){l(t,"Error resetting recaptcha object: "+e)}},resetAll:function(){for(var e in a)a.hasOwnProperty(e)&&p.reset(e)},clear:function(){a={}},checkGrecaptcha:function(){return!("undefined"==typeof grecaptcha||!grecaptcha||!grecaptcha.render||"function"!=typeof grecaptcha.render)},checkCaptchaRendered:function(e){return!(!a[e]&&0!==a[e])},showSync:function(e,t,r){var n=0,a=window.setInterval(function(){return++n>=40?(window.clearInterval(a),void l(null,"Recaptcha JS was not loaded on the page.")):void("undefined"!=typeof grecaptcha&&(p.show(e,t,r),window.clearInterval(a)))},250)},showAll:function(e){for(var t in c)c.hasOwnProperty(t)&&p.show(e,t,c[t])},waitForElm:function(e,t,r){var n=0,a=function(){if(++n>=5)return window.clearInterval(c),void l(null,"Recaptcha element id was not loaded on the page."+t);var a=document.getElementById(t);a&&(window.clearInterval(c),p.show(e,t,r))},c=window.setInterval(a,250)},execute:function(){return"undefined"==typeof grecaptcha||"function"!=typeof grecaptcha.execute?void l(null,"Calling execute while captcha is not rendered"):void grecaptcha.execute()},show:function(e,t,r,n,c,f,h){try{if("undefined"==typeof grecaptcha||!grecaptcha||!grecaptcha.render||"function"!=typeof grecaptcha.render)return void l(null,"Recaptcha JS was not loaded on the page.");if(!e||!t||!r)return void l(null,"Please pass a site key, element id, and input id.");var s=document.getElementById(t);if(!s)return void p.waitForElm(e,t,r);if(a[t]&&"object"==typeof a[t])return;var g=0,w=i(g),y=document.getElementById("captchaSpinner"),m=function(){if(1==g&&null!==y&&(y.style.display="block"),++g>=5){window.clearTimeout(v),y.style.display="none",l(null,"Couldn't load recaptcha"),"function"==typeof h&&h.call();var u=document.getElementById("captchaError");return void(null!==u&&(u.className="captchaError errorMsg warning wrap",u.innerHTML=o))}if("undefined"==typeof a[t]){var s=n?"compact":"normal";c&&(s="invisible"),a[t]=grecaptcha.render(t,{"sitekey":e,"theme":"light","type":"image","tabindex":0,"size":s,"callback":function(e){d(e,r),"function"==typeof f&&f(e,r)},"expired-callback":function(){p.reset(t)}}),w=i(g),v=window.setTimeout(m,w)}else window.clearTimeout(v),y.style.display="none"},v=window.setTimeout(m,w);u()}catch(e){l(e,"Error loading recaptcha.")}}};return t.exportTo(p,"ta.util.ReCaptcha"),p});
define("ta/util/GeeTest",["ns-exporter","common/trackingStreams"],function(e,t){"use strict";var n=!1,o="float",a={},r="",i=t.error,c=function(){t.trackEvent("captcha","geetest","displayed")},s=function(e){var t=e.getElementsByClassName("gt_guide_tip");t&&t.length>0&&r&&(t[0].innerHTML=r)},d={init:function(e,t){try{if(n||"undefined"!=typeof Geetest&&Geetest)return;o=t?t:o,r=e;var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src="https://api.geetest.com/get.php?callback=ta.util.GeeTest.onloadCallback",document.getElementsByTagName("head")[0].appendChild(a),n=!0}catch(e){i(e,"Could not inject geetest script on to page.")}},reset:function(e){try{a[e]&&"function"==typeof a[e].refresh&&a[e].refresh()}catch(t){i(t,"Error resetting recaptcha object: "+e)}},resetAll:function(){for(var e in a)a.hasOwnProperty(e)&&d.reset(e)},clear:function(){a={}},showSync:function(e,t,n){var o=0,a=window.setInterval(function(){return++o>=40?(window.clearTimeout(a),void i(null,"GeeTest JS was not loaded on the page.")):void("undefined"!=typeof Geetest&&(d.show(e,t,n),window.clearTimeout(a)))},250)},show:function(e,t,n){try{if("undefined"==typeof Geetest||!Geetest)return void i(null,"GeeTest JS was not loaded on the page.");if(!e||!t)return void i(null,"Please pass a site key and element id.");var r=document.getElementById(t);if(!r)return void i(null,"The geetest element id was not found on the page: "+t);if(a[t]&&"object"==typeof a[t]&&!n)return;a[t]=new Geetest({gt:e,product:o,https:!0}),a[t].onReady(function(){s(r)}).appendTo(r),c()}catch(e){i(e,"Error loading geetest captcha.")}},onloadCallback:function(){}};return e.exportTo(d,"ta.util.GeeTest"),d});
define("overlays/options/closeOnBackButton",[],function(){"use strict";var n,o;return function(h){return history&&"onhashchange"in window?function(){this.on("show",function(){n=window.onhashchange;var i=this;window.onhashchange=function(n){location.hash===o&&i&&i.hide()},o=location.hash,location.hash=o+"#"+h}).on("hide",function(){window.onhashchange=n,location.hash===o+"#"+h&&history.back(),o=null})}:function(){}}});
define("pages/inappropriate_vote_stub",["ta","ta/util/Element","ta/Core/TA.Store","vanillajs","overlays/Overlay","overlays/styles/default","overlays/position/conditional","utils/responsive","overlays/position/fullscreen","overlays/position/center","overlays/options/closeOnEscape","overlays/position/autosize","overlays/options/autoReposition","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnBackButton","overlays/styles/windowshade","overlays/options/ajax"],function(e,o,t,n,i,s,r,a,l,p,d,u,c,w,v,y,m){"use strict";function _(e){o.isScrolledIntoView(e.elmt)||o.scrollIntoView(e.elmt),window.JS_SECURITY_TOKEN=e.token||window.JS_SECURITY_TOKEN,!window.JS_SECURITY_TOKEN&&window.ta.m&&window.ta.m.secureToken&&(window.JS_SECURITY_TOKEN=window.ta.m.secureToken);var n="/ReportIAP?token="+window.JS_SECURITY_TOKEN+"&step=START&voteContentType="+e.voteContentType;n+=e.owner?"&action=explain&reason=21&reviewid="+e.reviewid+"&isGeo="+e.isGeo+"&locationid="+e.locationid:"&action=reportIAP&contentId="+e.contentId,T?(T.updateContent(n),T.sourceElement=e.elmt,require("pages/inappropriate_vote").updateContentId(e.contentId),T.show()):require(["trjs!inappropriate_vote_dlg"],function(){T=new i(e.elmt,[s(e.elmt,"iapFlyout ui_modal"),r(a.mobile,l(),p()),d,u(0),c,y("light"),w,v("ReportProblem"),m(n,{})]),T.on("contentLoaded",function(){e.owner||require("pages/inappropriate_vote").initUI(T,T.sourceElement)}),T.show(),t.store("iapFlyout",T)})}var T,E={};return E.open=function(e,o,t){t.elmt=t.elmt||o;var n={flow:"CORE_COMBINED",pid:t.reg_pid||39841,userRequestedForce:!0,loggedInBypass:!0,onSuccess:_.bind(null,t)};require(["trjs!ta/registration/RegOverlay"],function(e){e.show({type:"dummy"},t.elmt,n)})},E});
define("utils/errorutils",["ta/util/Error","vanillajs"],function(r,e){return{domIsReady:r.enableDomReadyParam.bind(r),record:r.record.bind(r),getSelectorString:r.getSelectorString.bind(r),on:r.on.bind(r),off:r.off.bind(r)}});
define("overlays/styles/spinnershade",["lib/jquery-amd"],function(i){"use strict";return function(n,s){return function(){this.loading=function(n){return void 0===n?i(this.container).hasClass("wait"):void i(this.container).toggleClass("wait",n)};var t='<div class="spinnerImage"></div>';if(window.AnimationEvent){t='<div class="cssLoadingSpinner">'+t;for(var e=1;e<=8;e++)t+='<div class="cssLoadingSpinner_step'+e+'"></div>';t+="</div>"}this.spinner=document.createElement("div"),i(this.spinner).attr({"class":"spinnershade "+n}).html(t),this.container.appendChild(this.spinner),s===!1||this.loading(!0)}}});
define("ta/registration/RegEvents",["mixins/Events"],function(e){return new e("success")});
define("ta/registration/RegOverlay",["ta","lib/jquery-amd","api-mod","ns-exporter","utils/urlutils","utils/errorutils","overlays/Overlay","overlays/position","overlays/position/center","overlays/position/autosize","overlays/options/disableBodyScroll","overlays/options/closeOnDocClick","overlays/styles/modal","overlays/styles/windowshade","overlays/styles/spinnershade","ta/registration/RegEvents"],function(e,r,t,o,n,i,a,s,l,c,u,d,f,v,p,g){"use strict";var h=null,m=null,y=null,w=null,b=function(){var e=r("#overlayRegFrame");e.length&&(h&&h.loading&&h.loading(!1),e.css("display",""),h&&h.emit("regFrameReady"))},k=function(e,t){var o=r("#overlayRegFrame");if(o.length){var n=h?h.container:null;if(!n)return void i.record(null,"No overlay parent element found.");var a={frame:o[0],overlay:n,width:e,height:t};w(a)}},_=function(e){var t=r(window),o=t.length?t.width():981,n=e.width?e.width:0;n=n>o?o-20:n;var i=e.height?e.height:0,a=r(e.frame),s=r(e.overlay);n>100&&(a.css("width",n),s.css("width",n)),i>100&&(a.css("height",i),s.css("height",i)),h.emit("contentsUpdated")},O=function(e){var r={};try{r=JSON.parse(e)}catch(r){return i.record(r,"Error parsing controller result data: "+e),{}}return"object"!=typeof r?(i.record(null,"Parsed controller result is not an object."),{}):r},R=function(e){m&&(m(e),m=null)},T=function(e){y&&(y(e),y=null)},F=function(o){U.close();var n=o.resultData||"";if(n){var a=O(n);a.user_id&&require.defined("page-model")&&(require("page-model").session.user_id=a.user_id),R(a)}else R({});o.jsCallback&&x(o.jsCallback);var s=o.fireEvent||"";e.hasEventListener&&e.hasEventListener(name)?e.fireEvent&&e.fireEvent(s):t.fireEvent(document,s),require.defined("page-model")&&(require("page-model").session.loggedIn=!0),g.emit("success");try{var l=void 0===r("#USER_PREFS")[0];if(!e.util||!e.util.partials||"function"!=typeof e.util.partials.requestPartials||l)return;var c={ifb:!0},u=e.retrieve("attractions_shopping_cart_whitelisted_servlet_flag");"undefined"!=typeof u&&(c.shoppingCartWhitelistedServlet=u),e.util.partials.requestPartials(["IP_HEADER"],c,"facebook",null)}catch(e){i.record(e,"Could not request IP partial.")}},x=function(e){if(e&&("string"==typeof e&&(e=0===e.indexOf("function")?j(e):E(e)),"function"==typeof e))try{e()}catch(e){i.record(e,"Unable to trigger js callback from registration overlay.")}},E=function(e){for(var r,t=e.split("."),o=0,n=t.length;o<n;o++){var i=t[o];if(0!==o){if(!(r&&i in r))return null;r=r[i]}else r=window[i]}return r},j=function(e){var r=/^function\s*\(\s*\)\s*{(.*)}/.exec(e);if(r&&r[1])try{return new Function(r[1])}catch(e){i.record(e,"RegOverlay failed to parse js callback: "+r[1])}},q=function(e){var r=U.parseMessageFrom(e);if(r){var t=r.action;switch(t){case"successClose":F(r);break;case"reloadWindow":location.reload(!0);break;case"fwdToRelativeUrl":var o=r.url?r.url:"";o||i.record(null,"No url specified to forward to."),0!==o.indexOf("/")&&i.record(null,"Cannot forward to absolute url: "+o),window.location=o;break;case"resizeFrame":k(r.width,r.height);break;case"domReady":b();break;case"dismiss":U.close();break;default:return}}},C=function(){e.store&&e.store("member_gating_cta_shown",!0)},P=function(){return!!e.retrieve&&e.retrieve("member_gating_cta_shown")},S=function(e){if(e)return void(h=e);var r="no_padding no_x mobile_reg_overlay",t='<div id="overlayRegFrameWrap"></div>',o=[f(null,"center",r,"","",t),l(),u(),v("dark"),d,p("light"),c(20)];h=new a(null,o)},I=function(t,o,n){S(n),h.on("show",function(){var n=r("#overlayRegFrameWrap");if(!n.length)return void i.record(null,"The registration iframe wrapper was missing.");e.trackEventOnPage("regoverlay","show_overlay",window.modelLocId||"",o,!1);var a=document.createElement("iframe");r(a).prop("src",t).prop("id","overlayRegFrame").prop("class","overlayRegFrame").prop("scrolling","no").css("border","none").css("display","none"),n.append(a)}),h.on("hide",function(r){"close-button"===r.trigger&&e.trackEventOnPage("regoverlay","closed",window.modelLocId||"",o,!1),h=null,T(r)}),h.on("regFrameReady",function(){r(this.container).toggleClass("no_x",!1)}),h.show()},D=function(e){return e&&"object"==typeof e?e.hasOwnProperty("flow")&&e.flow?!(!e.hasOwnProperty("pid")||!e.pid)||(i.record(null,"Options object missing required pid field."),!1):(i.record(null,"Options object missing required flow field."),!1):(i.record(null,"Options object is invalid."),!1)},L=function(){var e=!1;return r.ajax({url:"/AuthCheck",data:{},async:!1,type:"GET",timeout:1e3,success:function(r){"string"==typeof r&&"true"===r.trim()&&(e=!0)}}),e},z=function(e){for(var r in e)!1===e[r]||e[r]||delete e[r]},U={attachListener:function(){window.addEventListener?window.addEventListener("message",q,!1):window.attachEvent("onmessage",q)},show:function(e,t,o){if(D(o),y=o.onClose,m=o.onSuccess,o.loggedInBypass&&L())return void R({});w=o.customResizeFn?o.customResizeFn:_,U.attachListener();var i={flow:o.flow,pid:o.pid,mcid:o.mcid,locationId:o.locationId,stateToken:o.stateToken,jsCallback:o.jsCallback,requireSecure:!!o.requireSecure,expectedUser:o.expectedUser,forceDesktop:"forceDesktop"in o&&o.forceDesktop,preVerificationToken:o.preVerificationToken,hideNavigation:!0,returnTo:""};o.extraQueryParams&&(i=r.extend(i,o.extraQueryParams)),z(i);var a=r.param(i),s=n.https("/RegistrationController?"+a);return o.userRequestedForce?void I(s,o.pid,o.customOverlay):void(P()?R({}):(C(),I(s,o.pid,o.customOverlay)))},close:function(){h&&h.hide()},showFullScreen:function(e,t,o){if(D(o),!o.hasOwnProperty("returnTo")||!o.returnTo)return void i.record(null,"Options object missing required returnTo field.");var a={flow:o.flow,pid:o.pid,mcid:o.mcid,locationId:o.locationId,stateToken:o.stateToken,jsCallback:o.jsCallback,returnTo:o.returnTo,requireSecure:!!o.requireSecure,fullscreen:!0};o.extraQueryParams&&(a=r.extend(a,o.extraQueryParams)),z(a);var s=r.param(a);window.location=n.https("/RegistrationController?"+s)},showForMobile:function(e,o,n){if(!n.customOverlay){var i=[f(null,"center","no_padding mobile_reg_overlay","","",'<div id="overlayRegFrameWrap"></div>'),s.framed(null,null,!0),p("light")];n.customOverlay=new a(null,i).on("show",function(){r(n.customOverlay.close).css("display","block")}).on("positionDirty",function(){this._scrollTop||(this._scrollTop=t.scrollTop()),window.scrollTo(0,0)}).on("hide",function(){window.scrollTo(0,this._scrollTop),delete this._scrollTop}),n.customResizeFn||(n.customResizeFn=function(e){var t=e.height,o=r(document);o.height()>t&&(t=o.height()),r("#overlayRegFrame").css("height",t+"px").css("width",r(window).width()),h.emit("positionDirty"),r(n.customOverlay.container).css("position","absolute")})}this.show(e,o,n)},parseMessageFrom:function(e){var r,t=e||window.event;if(!t)return null;if(!t.origin||0!==t.origin.indexOf("https")||t.origin!==document.location.origin)return null;if(!t.data||!t.data.indexOf||-1===t.data.indexOf("action"))return null;try{r=JSON.parse(t.data)}catch(e){return null}var o=r.hasOwnProperty("action")?r.action:null;return o||(r=null),r}};return o.exportTo(U,"ta.registration.RegOverlay"),U});
define("ta/registration/AuthCheck",["ta","lib/jquery-amd"],function(e,r){"use strict";var t=function(e){var t=!1;return r.ajax({url:"/AuthCheck",data:{"secure":!!(e&&"secure"in e)&&e.secure,"username":!!(e&&"username"in e)&&e.username},async:!1,type:"GET",success:function(e){"string"==typeof e&&"true"===e.trim()&&(t=!0)}}),t};return{isAuthorized:t}});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"common_location_topic","handlers",["handlers"]);n(["widget","vanillajs","api-mod","overlays/utils","overlays/widgetoverlays","ta/prwidgets","utils/ajax","ta/util/Error","ta/Core/TA.Record","ta/util/ReCaptcha","ta/util/GeeTest","pages/inappropriate_vote_stub","members/memberOverlay","ta/Core/TA.Event","ta/registration/RegOverlay","ta/registration/AuthCheck"],function(e,n,t,i,a,r,s,d,l,o,c,u,f,h,v,m){"use strict";function p(){var e=t.find(".answerForm",q);t.removeClass(e,"hidden"),t.find(".answerText",q).focus(),l.trackEventOnPage(N,"click","answer")}function C(n){var a=t.find(".answerList",q);a&&(a.innerHTML=i.loadingSpinnerHtml(),e.require(["trhtml!LOCATION_TOPIC_WIDGETS/HSX?t="+n+"&o=0&limit=20"],function(e){a.innerHTML=e.innerHTML,r.initWidgets(a),t.addClass(t.find(".showAll",q),"hidden"),t.removeClass(t.find(".hideAll",q),"hidden"),t.removeClass(t.select(".answerList > *",q),"hidden")}),l.trackEventOnPage(N,"click","show_all_answers"))}function w(){t.addClass(t.find(".hideAll",q),"hidden"),t.removeClass(t.find(".showAll",q),"hidden"),t.addClass(t.select(".answerList > *",q),"hidden"),t.removeClass(t.find(".answerList > *",q),"hidden")}function _(){t.addClass(t.find(".delete",q),"hidden"),t.removeClass(t.find(".confirmDelete",q),"hidden"),t.removeClass(t.find(".cancelDelete",q),"hidden"),t.removeClass(t.find(".confirmDeleteExplanation",q),"hidden")}function g(n,i){t.addClass(t.find(".confirmDelete",q),"hidden"),t.addClass(t.find(".cancelDelete",q),"hidden"),t.addClass(t.find(".confirmDeleteExplanation",q),"hidden"),t.removeClass(t.find(".delete",q),"hidden"),s({url:"/AnswersAjax",method:"POST",dataType:"html",data:{"act":"dt","tpcid":n,"token":i},trackEvent:{module:"answers_faq_answer_crud",action:"answers_faq_delete_answer",context:n,value:0,noninteraction:!1},success:function(n){var t=q.parentElement;t.removeChild(q),t.querySelector("[data-prwidget-name="+e.name+"]")||h.fireEvent("qaLastQuestionDeleted")},error:function(e){d.ajaxFailure("Failed to delete question (location_topic/handlers)",e)}})}function T(){t.addClass(t.find(".confirmDelete",q),"hidden"),t.addClass(t.find(".cancelDelete",q),"hidden"),t.addClass(t.find(".confirmDeleteExplanation",q),"hidden"),t.removeClass(t.find(".delete",q),"hidden")}function A(){var e=t.find(".answerText",q);if(!e.value.length)return void e.focus();var n={username:!0};if(m.isAuthorized(n))S();else{var i={flow:"CONTENT_SUBMISSION",pid:-1,userRequestedForce:!0,onSuccess:function(){S()}};v.show(null,null,i)}return!1}function O(){t.addClass(t.find(".answerForm",q),"hidden")}function E(e){return e?e.value:""}function S(){var n=t.find(".answerForm",q),i=t.find(".answerText",n),a={act:"ap",psttxt:E(i),tpcid:n.topicid.value,pid:-1,altsessid:n.altsessid.value,token:n.token.value,lcid:n.lcid.value,"g-recaptcha-response":E(t.find(".recaptcha_input",n)),geetest_challenge:E(n.geetest_challenge),geetest_validate:E(n.geetest_validate),geetest_seccode:E(n.geetest_seccode),useJson:!0},u=t.find(".formSubmit",n);t.addClass(u,"loading"),s({url:"/AnswersAjax",method:"POST",dataType:"html",data:a,trackEvent:{module:"answers_faq_answer_crud",action:"answers_faq_create_answer",context:a.tpcid,value:0,noninteraction:!1},success:function(a){o.resetAll(),c.resetAll(),l.trk("AnswerSubmit",!1,t.find(".formSubmit",n)),I(a),t.removeClass(u,"loading"),t.addClass(n,"hidden");var s=JSON.parse(a);s.postingId&&e.require(["trhtml!LOCATION_POSTING_WIDGETS/HSX?lp="+s.postingId],function(e){var n=t.find(".answerList",q);n.insertBefore(e,n.firstChild),r.initWidgets(n),i.value="",k()})},error:function(e){o.resetAll(),c.resetAll(),l.trk("AnswerSubmit",!1,t.find(".formSubmit",n)),d.ajaxFailure("Failed to submit answer (location_topic/handlers)",e),null!==e&&null!==e.responseText&&I(e.responseText),t.removeClass(u,"loading")}})}function k(){t.find(".errors",q).innerHTML=""}function I(e){try{var n=JSON.parse(e)}catch(e){return}if(n.ALERT&&(n.errors=[n.ALERT]),n.errors&&n.errors.length>0){var i=t.find(".errors",q);i.innerHTML="";for(var a=0;a<n.errors.length;a++){var r=document.createElement("li");r.innerHTML=n.errors[a],i.appendChild(r)}t.removeClass(i,"hidden")}}function L(e,n,t){u.open(e,n,{voteContentType:"LOCATION_TOPIC",contentId:t})}function x(){null==t.find(".captcha_here",q).querySelector("#sharedCaptcha")&&t.find(".captcha_here",q).appendChild(t.find("#sharedCaptcha"))}function b(e,n){return f.initMemberOverlay(e,n,n.getAttribute("data-overlay-id"),"Answers","user_name_photo"),l.trackEventOnPage(N,"click","show_reviewer_info_window"),!1}function y(e){a.showLightbox("QA_GET_VERIFIED",{locationId:e},{})}function D(e){a.showLightbox("QA_POSTING_GUIDELINES",{locationId:e},{})}var q=e.element,N="faq";return{answerButtonClick:p,showAllClick:C,hideAllClick:w,deleteClick:_,confirmDeleteClick:g,cancelDeleteClick:T,clearErrors:k,submitAnswer:A,cancelAnswer:O,moveCaptchaHere:x,iapVote:L,initMemberOverlay:b,initGetVerifiedOverlay:y,initPostingGuidelinesOverlay:D}})});
require(["ta/prwidgets"],function(e){var n=e.define.bind(e,"common_location_posting","handlers",["handlers"]);n(["widget","vanillajs","api-mod","ta/prwidgets","ta/util/Error","common/trackingStreams","ta/registration/RegOverlay","pages/inappropriate_vote_stub","members/memberOverlay","utils/ajax","ta/registration/AuthCheck"],function(e,n,t,i,a,d,o,r,s,l,c){"use strict";function u(e,n,t){m(e,n,t,1),d.trackEvent(g,"click","upvote")}function f(e,n,t){m(e,n,t,-1),d.trackEvent(g,"click","downvote")}function v(e,n,i,d){l({url:"/AnswersAjax",method:"POST",dataType:"json",trackEvent:{module:"answers_faq_vote",action:"answers_faq_vote_add",context:e,value:d,noninteraction:!1},data:{altsessid:i,act:"av",pstid:e,vs:d,pid:-1,token:n,useJson:!0},success:function(e){t.find(".score",b).innerHTML=e.votes,t.find(".voteCount",b).dataset.content=e.message,t.find(".voteCount",b).innerHTML=e.text,uiOverlay(null,t.find(".voteCount",b))},error:function(e){a.ajaxFailure("Failed to delete question (location_topic/handlers)",e,null,"WARN")}})}function m(e,n,t,i){if(c.isAuthorized())v(e,n,t,i);else{var a={flow:"CORE_COMBINED",pid:-1,userRequestedForce:!0,onSuccess:function(){v(e,n,t,i)}};o.show(null,null,a)}}function h(){t.addClass(t.find(".delete",b),"hidden"),t.removeClass(t.find(".confirmDelete",b),"hidden"),t.removeClass(t.find(".cancelDelete",b),"hidden"),t.removeClass(t.find(".confirmDeleteExplanation",b),"hidden")}function p(e,n){t.addClass(t.find(".confirmDelete",b),"hidden"),t.addClass(t.find(".cancelDelete",b),"hidden"),t.addClass(t.find(".confirmDeleteExplanation",b),"hidden"),t.removeClass(t.find(".delete",b),"hidden"),l({url:"/AnswersAjax",method:"POST",dataType:"html",data:{"act":"dp","pstid":e,"token":n},trackEvent:{module:"answers_faq_answer_crud",action:"answers_faq_delete_answer",context:e,value:0,noninteraction:!1},success:function(e){b.parentElement.removeChild(b)},error:function(e){a.ajaxFailure("Failed to delete question (location_posting/handlers)",e,null,"WARN")}})}function C(){t.addClass(t.find(".confirmDelete",b),"hidden"),t.addClass(t.find(".cancelDelete",b),"hidden"),t.addClass(t.find(".confirmDeleteExplanation",b),"hidden"),t.removeClass(t.find(".delete",b),"hidden")}function _(e,n,t){r.open(e,n,{voteContentType:"LOCATION_POSTING",contentId:t}),d.trackEvent(g,"click","flag")}function w(){t.addClass(t.find(".abbreviated",b),"hidden"),t.removeClass(t.find(".unabbreviated",b),"hidden")}function k(e,n){return s.initMemberOverlay(e,n,n.getAttribute("data-overlay-id"),"Answers","user_name_photo"),d.trackEvent(g,"click","show_reviewer_info_window"),!1}var b=e.element,g="faq";return{voteUp:u,voteDown:f,deleteClick:h,confirmDeleteClick:p,cancelDeleteClick:C,iapVote:_,unabbreviateContent:w,initMemberOverlay:k}})});
define("hotels/HRContentBlockUtils",["ta/prwidgets","utils/classnameUtils","utils/objutils"],function(e,t,i){function n(e,i){var n=!t.hasClass(e,u)||i,o=e&&e.querySelector(".block_body_bottom"),d=o&&o.querySelector(".inner");o&&d&&(o.style.height=n?d.offsetHeight+"px":0,t.toggleClass(e,u,n))}function o(e){delete c[e]}function d(t,d,r){var l=t&&document.getElementById(t.id);if(l)if(c[t.id])(r||n)(l);else{if(c[t.id]===!1)return;c[t.id]=!1,t.requestAJAXPlacement(function(i){var d=l.querySelector(".block_body_bottom .inner");d&&i?(c[t.id]=!0,d.innerHTML=i,e.initWidgets(d),require.defined("mobile/lite/image-loader")&&require("mobile/lite/image-loader").init(200,d),setTimeout(r||n,0,l)):o(t.id)},function(){o(t.id)},i.extend({"more_content_request":!0},d))}}function r(t,i,n){var d=t&&document.getElementById(t.id);d&&(i.updateContentRequest=!0,c[t.id]!==!1&&(c[t.id]=!1,t.requestAJAXPlacement(function(i){var r=d.querySelector(".block_body_top");r&&i?(c[t.id]=!0,r.innerHTML=i,e.initWidgets(r),n&&n(!0)):(o(t.id),n&&n(!1))},function(){o(t.id),n&&n(!1)},i)))}function l(d,r){var l=d&&document.getElementById(d.id);if(l)if(c[d.id])n(l,!0);else{if(c[d.id]===!1)return;c[d.id]=!1,d.requestAJAXPlacement(function(i){var r=l.querySelector(".block_body_bottom .inner");if(r&&i){delete c[d.id];var u=document.createElement("div");if(u.innerHTML=i,u=u.firstElementChild,r.appendChild(u),t.hasClass(u,"last_batch")){var s=l.querySelector(".block_footer");s&&(s.style.display="none")}e.initWidgets(r),setTimeout(n,0,l,!0)}else o(d.id)},function(){o(d.id)},i.extend({"more_content_request":!0},r))}}var u="expanded",c={};return{expandContent:d,updateContent:r,expandContentNoToggle:l,toggleSection:n}});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"location_qa","handlers",["handlers"]);t(["placement","vanillajs","hotels/HRContentBlockUtils","ta/util/ReCaptcha","ta/util/GeeTest","ta/Core/TA.Record","api-mod","utils/ajax","overlays/widgetoverlays","ta/util/Error","ta/Core/TA.Event","ta/registration/RegOverlay","ta/registration/AuthCheck"],function(e,t,n,a,i,o,r,s,l,d,u,c,f){function p(){r.removeClass(r.find(".askQuestionForm"),"hidden"),r.find(".topicText",k).focus(),o.trackEventOnPage(A,"click","ask_a_question")}function h(){r.addClass(r.find(".askQuestionForm"),"hidden")}function v(){var e=r.find(".topicText",k);if(!e.value.length)return void e.focus();var t={username:!0};if(f.isAuthorized(t))g();else{var n={flow:"CONTENT_SUBMISSION",pid:-1,userRequestedForce:!0,onSuccess:function(){g()}};c.show(null,null,n)}return!1}function m(e){return e?e.value:""}function g(){var e=r.find(".askQuestionForm",k),t=r.find(".topicText",e).value,n=!!r.find("[name=optin]:checked",e),l={act:n?"ats":"at",topicText:t,detail:e.detail.value,pid:-1,optIn:n,altsessid:e.altsessid.value,token:e.token.value,"g-recaptcha-response":m(r.find(".recaptcha_input",e)),geetest_challenge:m(e.geetest_challenge),geetest_validate:m(e.geetest_validate),geetest_seccode:m(e.geetest_seccode),redirect:!0},u=r.find(".formSubmit",e);r.addClass(u,"loading"),s({url:"/AnswersAjax",method:"POST",dataType:"html",data:l,evalScripts:!0,trackEvent:{module:"answers_faq_question_crud",action:"answers_faq_create_question",context:l.detail,value:0,noninteraction:!1},success:function(t){a.resetAll(),i.resetAll(),o.trk("QuestionSubmit",!1,r.find(".formSubmit",e)),_(t)||(r.find(".topicText",k).value="",window.location=t),r.removeClass(u,"loading")},error:function(t){a.resetAll(),i.resetAll(),o.trk("QuestionSubmit",!1,r.find(".formSubmit",e)),t&&t.getAllResponseHeaders()&&d.ajaxFailure("Failed to submit question (location_qa/handlers)",t),null!==t&&null!==t.responseText&&_(t.responseText),r.removeClass(u,"loading")}})}function _(e){var t=null;try{t=JSON.parse(e)}catch(e){return!1}if(t&&t.ALERT&&(t.errors=[t.ALERT]),t&&t.errors&&t.errors.length>0){var n=r.find(".errors",k);n.innerHTML="";for(var a=0;a<t.errors.length;a++){var i=document.createElement("li");i.innerHTML=t.errors[a],n.appendChild(i)}r.removeClass(n,"hidden")}return!0}function C(){null==r.find(".captcha_here",k).querySelector("#sharedCaptcha")&&r.find(".captcha_here",k).appendChild(r.find("#sharedCaptcha"))}function T(e){l.showLightbox("QA_POSTING_GUIDELINES",{locationId:e},{})}var k=document.getElementById(e.id),A="faq";return u.on("paginationChanged",function(t){document.getElementById(e.id).contains(t)&&(u.fireEvent("TabHeader_clickTab",document.getElementById("TABS_ANSWERS")),n.updateContent(e,{"offset":t.getAttribute("data-offset")},function(){u.fireEvent("qaListUpdated")}))}),u.on("qaLastQuestionDeleted",function(){p()}),u.queueForLoad(function(){var t=r.find(".shouldUpdateOnLoad",k);t&&t.getAttribute("data-should-update")&&n.updateContent(e,{"offset":"0"})}),{moreClick:function(){n.expandContent(e)},askQuestionClick:p,submitAskQuestion:v,cancelAskQuestion:h,moveCaptchaHere:C,initPostingGuidelinesOverlay:T}})});
require(["ta/p13n/placements"],function(e){var a=e.define.bind(e,"location_review_keyword_search","handlers",["handlers"]);a(["placement","lib/jquery-amd","ta/Core/TA.Store","ta/Core/TA.Event","ta/Core/TA.Record","ta/util/Deferred","ta/util/Element","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/styles/windowshade","overlays/options/autoReposition"],function(e,a,t,n,r,l,i,o,s,c,u,v){function d(t){var n=a("#"+e.id+"_supportedLangSwitch");F||(F=new o(null,s(null,"center",null,null,null,n.html()),u,c.center(),v),a(F.inner).addClass(C.attr("class")),a("a.confirm_switch",F.inner).on("click",function(n){var r=a("#"+e.id+"_createCookieNoConfirmation");r.val("true"),_(t),r.val(""),F.hide(n)}),a("a.decline_switch",F.inner).on("click",function(e){F.hide(e)})),F.show()}function h(){var e=ta.retrieve("ta.p13n.review_keyword_search.hasLangFilter")||!1,a=ta.retrieve("ta.p13n.review_keyword_search.noNativeReviewsForPos");null!==a&&(S=a||!1),T.toggleClass("hidden",!e&&S)}function f(){var e=O.data("tags"),a="true"===O.data("hasLangFilter"),n=O.data("noNativeReviewsForPos");if(e){var r=e.split(",");t.store("ta.p13n.review_keyword_search.tags",r)}t.store("ta.p13n.review_keyword_search.hasLangFilter",Boolean(a)),n&&t.store("ta.p13n.review_keyword_search.noNativeReviewsForPos",n)}function g(t){a(".ui_tagcloud",C).each(function(e,n){a(n).toggleClass("selected",a(n).data("content")===t)}),t||a("#"+e.id+"_all_reviews").addClass("selected")}function w(){x.val(""),g(""),m(!0)}function p(e){b.val(""),w(),e&&e()}function _(e,a){if(x.val()===e)e="";else{if(a&&"true"===q.val())return void d(e);b.prop("defaultValue",""),b.val("")}x.val(e),g(e),m(!0),n.fireEvent("review_keyword_search.tag_toggled")}function y(e){x.val()!==e&&(b.prop("defaultValue",""),b.val(""),x.val(e),g(e),m(!0),n.fireEvent("review_keyword_search.tag_toggled"))}function m(e){var a=b.val()||"";x.val()||"";return a&&x.length&&(x.val(""),g(a)),ta.page&&ta.page.applyReviewFiltersForm?ta.page.applyReviewFiltersForm(T.get(0),{whiteBoxTopElmt:C.next().get(0)}):(ta.servlet.Reviews.filterReviews(T.get(0),{whiteBoxTopElmt:C.next().get(0)}),!1)}function k(){b.blur();var e=b.val()||"";r.trackEventOnPage("Reviews_Controls","click_search",e.replace(/(\W|_)+/g,"_"))}function R(n,i){if(n&&n.stopPropagation(),!i.get("typeahead")){var o,s=20,c={name:"Review-Keyword-Search",minChars:1,startEventOn:"focus",autopopulateHighlighted:!1,defaultValue:"",clearDefaultTextOnFocus:!1,selectOnBlur:!1,assumeOnBlur:!1,restoreOnFocus:!1,cycleInput:!1,containerClass:"typeahead-container keywords_typeahead",containerParent:document.getElementById(e.id+"_search_box"),positionRelative:!0,offsetX:0,offsetY:2,width:null,cacheResults:!0,shouldSubmit:function(){return k(),m(),!1},search:function(e){var a=t.retrieve("ta.p13n.review_keyword_search.tags"),n=[];if(a)for(var r=0;r<a.length;r++){var i=a[r];if(0===i.indexOf(e)&&(n.push({value:i}),n.length>=s))break}return l().resolve({results:n,query:e})},onSetSelectedIndex:function(e,a){E.html(e>=0?a.results[e].value:"")},onKeyDown:function(e,a){38!==e.which&&40!==e.which||E.html(a.selectedIndex>=0?a.results[a.selectedIndex].value:"")},onSelect:function(){var e=b.val()||"";r.trackEventOnPage("Reviews_Controls","keyword_search_auto_complete",e.replace(/(\W|_)+/g,"_")),w(),o.sync({query:e,result:{}})},onRender:function(){var e=a(".typeahead-choices *",C).length;a(".typeahead-container",C).css("visibility",0===e?"hidden":"visible")},onHide:function(){E.html("")}};return o=new TypeAhead(i,a.extend({},c)),i.store("typeahead",o),o}}var F,C=a("#"+e.id),T=a("form",C),b=a("#"+e.id+"_q"),x=a("#"+e.id+"_reviewTag"),E=a("#"+e.id+"_search_ghost_back"),q=a("#"+e.id+"_askForConfirmation"),O=a("#"+e.id+"_jsData"),S=!1;return x.val()?n.queueForReady(function(){g(x.val())}):b.length&&n.queueForReady(function(){g(b.val())}),n.queueForReady(f),n.on("update-"+e.name,function(t){f(),b.blur(),C=a("#"+e.id),t=a(t);var n=a("input[name=q]",t);n.length&&b.prop("defaultValue",n.val()).val(n.val());var r=a("input[name=t]",t);r.length&&x.val(r.val());var l=a("input[name=askForConfirmation]",t);l.length&&q.val(l.val()),x.val()?g(tagElvmt.val()):b.length&&g(b.val()),h()}),n.on("reviews-selectTag",y),n.on("reviews-search",m),n.on("reviews-clearTagsAndQuery",p),n.on("review-list-update",function(){C=a("#"+e.id)}),x.length&&i.trackWhenScrolledIntoView("#"+e.id,["Reviews_Tag_Cloud","in_view"]),h(),{search:m,clearTagsAndQuery:p,clearTags:w,toggleTag:_,createTypeAhead:R,trackManualSubmit:k}})});
define("ta/photos/oysterTracking",["vanillajs"],function(t){function n(t){return a.contains(t)}var a=["LB_OPEN","FEATURED_REEL","EOAR_SINGLE","EOAR_HERO","PHOTO_CONTENT_BLOCK","FEATURED_REEL_LR","HERO","ALBUM"];return{trackCandidateSession:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","CANDIDATE_SESSION",E)},trackImpression:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","IMPRESSION",E)},trackInterest:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","INTEREST",E)},trackAction:function(t,a,E){n(E)&&ta.trackEventOnPage("Oyster","ACTION",E)}}});
define("ta/media/viewerScaffold",["api-mod","vanillajs","utils/HistoryManager","utils/objutils","utils/urlutils","ta/photos/oysterTracking","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/styles/windowshade","overlays/options/closeOnEmit","commerce/offerclickEvents","overlays/options/ajax"],function(e,t,a,i,o,r,n,l,s,d,c,u,m){function h(){var e=[];this.register=function(t,a,i,o){i||(o=!0,i=ta);var r=o?"on":"addEvent",n=o?"off":"removeEvent";i[r](t,a),e.push(function(){i[n](t,a)})},this.addCleanup=function(t){e.push(t)},this.cleanup=function(){e.forEach(function(e){e()}),e=[]}}function w(){E&&E.onResize&&E.onResize()}function v(){R.register("resize",w,window),w(),E&&E.onLoad&&E.onLoad();var e=ta.retrieve("oyster_location_data");e&&e.hasOyster&&e.hasOyster[L]&&r.trackCandidateSession(null,null,null,"LB_OPEN"),R.register("mediaViewerEscapePressed",function(){try{k.fireEvent("onClose",k)}catch(e){}k.hide()})}function g(){document.body.addClass("remove-scrolling"),ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.retrieve("meta.baseLocationId")&&ta.meta.update&&ta.commerce.meta.updateProvAreaFromLightBox(ta.retrieve("meta.baseLocationId")),E&&E.onShow&&E.onShow(),I&&(ta.retrieve("tabletRacOnPhotoViewer")&&(ta.remove("RASCalendar"),ta.restaurantAvailabilitySearch&&(M=ta.restaurantAvailabilitySearch.getContainerSelector())),ta.find(".albumLightbox .ui_close_x").addClass("svgico")),ta.fireEvent("refreshedDOMContent",k.container)}function f(){k.container.removeClass("loaded"),ta.fireEvent("mediaViewerLightboxHide"),document.body.removeClass("remove-scrolling"),E&&E.onClose&&E.onClose(),ta.remove("meta.requestFromArea");var e=ta.retrieve("metaCheckRatesOverlay");e&&(e.hide(),ta.remove("metaCheckRatesOverlay")),ta.meta.linkTracking&&ta.meta.linkTracking.restoreCRPageServlet(),ta.retrieve("photo.viewer.refreshOnClose")&&(window.location=window.location),ta.has("translationOverlay")&&ta.retrieve("translationOverlay").hide(),ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")&&ta.isMetaHotelsRequest&&ta.isMetaHotelsRequest()?(ta.commerce.minimeta.doMetaDateSearch(),ta.remove("hotels.datesChanged")):ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")&&(ta.commerce.minimeta.ajax.resetAjaxCall(),ta.commerce.minimeta.ajax.send(!1,!0),ta.remove("hotels.datesChanged")),ta.widgets.calendar.closeCalendarWidgets(),R.cleanup(),I&&ta.retrieve("tabletRacOnPhotoViewer")&&(ta.remove("RASCalendar"),ta.restaurantAvailabilitySearch&&ta.restaurantAvailabilitySearch.setContainerSelector(M)),E&&E.onHide&&E.onHide(),ta.fireEvent("photoLightBoxHidden")}function b(e){ta.store("media.albums.loadOnEvent",!0),R.register("show",g,k,!0),R.register("hide",f,k,!0),v(),g(),ta.has("albumViewer.historyEnabled")&&A(e),setTimeout(function(){ta.fireEvent("mediaViewerDOMLoaded"),ta.prwidgets&&ta.prwidgets.initWidgets(k.container)},1)}function p(e){var t=e;t.heroMinWidth=window.innerWidth-2*_,t.heroMinHeight=window.innerHeight-2*_,t.albumid=e.albumId,e.albumViewMode||((e.ff||e.imageId)&&(t.ff=e.ff||e.imageId,t.albumid=101,t.albumViewMode="hero",t.albumPartialsToUpdate="full",t.thumbnailMinWidth=50,t.cnt=30,t.offset=-5,t.baseMediaId=t.ff,t.extraAlbumCoverCount=2),e.albumId&&(t.albumViewMode="images",t.albumPartialsToUpdate="full",t.extraAlbumCoverCount=4));var a="QC_Meta_Mini|Photo_Lightbox";t.area=a,window.pageServlet&&i.extend(t,{metaReferer:window.pageServlet});var r="/LocationPhotoAlbum?"+o.toQueryString(t),n=r;if(ta&&ta.commerce&&ta.commerce.meta&&ta.commerce.meta.tracking)try{ta.commerce.meta.tracking.resetTimingLockForNavArea(a),r=ta.commerce.meta.tracking.updateUrlWithTiming(r,a)}catch(e){ta.util.error.record(e,"problem updating url with timing in viewerScaffold"),r=n}return r}function C(e,t){var a=window.location.hash;if(a.indexOf(T)>=0){var i=y();i?(!i.detail&&window.modelLocId&&(i.detail=window.modelLocId),!i.geo&&window.modelGeoId&&(i.geo=window.modelGeoId),S(i,!0)):S({detail:e,geo:t},!0)}}function y(){var e=window.location.hash,t=e.indexOf(H)>=0&&e.substring(e.indexOf(H)+H.length,e.length);return t&&t.length>0?t.parseQueryString(!1,!1):null}function A(t){var i=new a;if(i.isSupported()){if(t){var o=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search;window.history.replaceState(null,null,o)}R.register("albumViewerPushState",i.pushState),R.register("albumViewerReplaceState",i.replaceState);var r=!1;R.register("mediaViewerLightboxHide",function(){window.location.hash.indexOf(T)>=0&&(r=!0,i.disableCallbacks(!0),history.back())}),e.addEvent(window,"popstate",function(){window.location.hash.indexOf(T)>=0?r?history.back():k.show():(r=!1,i.disableCallbacks(!1),k.hide())})}}function S(e,t){if(!e.geo||!e.detail)return ta.util.error.record(null,"viewerScaffold.js:load missing required arguments"),!1;E=e.evtDelegates,e.evtDelegates=null,L=e.detail,O=e.geo;var a="dark mediaAlbumsBackdrop",i="albumLightbox",o=s.framed([0,0]),r=[ta.isTabletAlbumViewer&&ta.isTabletAlbumViewer()&&window.getCssAlbumPhotoLBIconAsset&&window.getCssAlbumPhotoLBIconAsset(),window.cssAlbumViewerAssetHotels,window.cssPhotoLightboxAsset,window.cssAlbumViewerExtendedAsset,window.hrExtraCssLightboxAsset,window.jsAlbumViewerExtendedAsset,window.g_jqueryFiles];if(k)k.updateContent(p(e));else{var h=0,w=setInterval(function(){ta.trackEventOnPage("Photo_LB","slow_load",30*++h,navigator.userAgent)},3e4);k=new n(document.body,l(null,"",i),o,d(a),c(u,"beforeClick",function(e){return e.isBooking}),m(p(e),{resources:r,noCache:!0})),k.on("contentLoaded",function(){clearInterval(w),b(t)}).on("hide",clearInterval.bind(null,w)),k.on("data-targetEvent",ta.fireEvent.bind(ta))}P||(V=Date.now(),P=!0),k.show()}function x(){return V?Date.now()-V:null}var k,E,L,O,V,P=!1;if(ta.isTabletAlbumViewer)var I=ta.isTabletAlbumViewer();var M,_=I?0:20,R=new h,T="#photos",H=T+";";return{getTimeSincePhotoviewerFirstOpened:x,load:S,handleFragment:C,parseFragment:y}});
define("actions/openPhotoViewer",["ta/media/viewerScaffold","common/trackingStreams","ta/util/Cookie"],function(e,o,t){function i(i,n,r,a,c,f){return o.trackEvent("photoviewer","click","btf_userreviews"),t.setPIDCookie(5042),e.load({detail:r,geo:a,filter:f,imageId:c}),!1}return{open:i}});
require(["ta/prwidgets"],function(e){var r=e.define.bind(e,"reviews_basic_review_hsx","handlers",["handlers"]);r(["widget","lib/jquery-amd"],function(e,r){function i(){r(e.element).trigger("review:expand",[e.element,l])}function n(){r(e.element).trigger("review:collapse",[e.element,l])}var t=r(".reviewSelector",e.element),l=Number(t.attr("data-reviewId"));return{clickExpand:i,clickCollapse:n}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"saves_cta_highlights","handlers",["handlers"]);t(["placement","lib/jquery-amd","page-model","utils/localstorage"],function(e,t,s,a){"use strict";var n,o=t("#"+e.id),i=t(".saves-cta-highlights-test",o),r=t(".saves-cta-highlights-control",o),l="saves-cta-highlights-test",u="saves-cta-highlights-control",c="saves-cta-highlights-skip",d=require("page-model").JS_SECURITY_TOKEN,h=require("page-model").session.pageServlet,v=function(e,t){return(new Date).getTime()-t<60*e*60*1e3},g=function(){var e=["trjs!overlays/Overlay","trjs!overlays/styles/popover","trjs!overlays/position","trjs!overlays/options/fade","trjs!overlays/options/centerArrowOnSrcElement","trjs!overlays/options/autoReposition","trcss!src/build/styleguide/ui_popovers/ui_popover","trcss!src/build/common/saves_cta_highlights"];require(e,function(e,s,a,r,l,u,c){i.on("click",".ui_close_x",function(){n&&n.destroy()&&(n=null)}),o.parent().on("click",".saves-widget-button",function(){n&&n.destroy()&&(n=null)});var d=t(".saves-icon-locator",o.parent()[0]),h=t(".saves-cta-highlights-test .test-title",o),v=t(".saves-cta-highlights-test .test-content",o);n=new e(o[0],[new s(i[0],"below","saves-cta-highlights-test-flyout small dark",h[0],v[0]),a.bottomLeft([-12,-12]),r(r.SHORT,!0,!0),l(d),u]),n.show()})},f=function(e){t.ajax({type:"GET",url:"/data/1.0/recent/locations",data:{limit:3},beforeSend:function(e){e.setRequestHeader("X-Requested-By",d)},success:e})},p=function(e){t.ajax({type:"GET",url:"/data/1.0/trips/item",data:{limit:1},beforeSend:function(e){e.setRequestHeader("X-Requested-By",d)},success:e})},y=function(e,t){var s="";return require("page-model").session.loggedIn?void f(function(n){n.data&&n.data.length>1&&v(2,n.data[1].date)&&(n.data.length<=2||!v(2,n.data[2].date))&&p(function(n){if(n.data&&0!=n.data.length){if(v(720,new Date(n.data[0].created).getTime()))return void a.set(c,!0);s="no_save_last_30_days|"+h}else s="never_saved|"+h;e||g(),a.set(t,!0),require(["trjs!ta/Core/TA.Record"],function(e){e.trackEventOnPage(t,"flyout_shown",s,0,!1)})})}):(s="logged_out|"+h,e||g(),a.set(t,!0),void require(["trjs!ta/Core/TA.Record"],function(e){e.trackEventOnPage(t,"flyout_shown",s,0,!1)}))},_=function(){return t(".ui_notification_container").length||t(".ui_overlay").length||t("#qual_ol").length},m=function(){setTimeout(function(){if(!a.has(c)){if(_())return void a.set(c,!0);if("Hotel_Review"!==s.session.pageServlet||!require.defined("hotels/hrSurveys")||!require("hotels/hrSurveys").shouldShowSurvey())if(i.length){var e=i.attr("data-test-version"),t=l+e;a.has(t)||y(!1,t)}else if(r.length){var t=u;a.has(t)||y(!0,t)}}},1600)};a.enabled&&("complete"===document.readyState?m():t(window).ready(m))})});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"war_review_rating_inline","handlers",["handlers"]);n(["placement","lib/jquery-amd","ta/Core/TA.Record"],function(e,n,i){"use strict";var t=function(){var t=n("#"+e.id);i.trackEventOnPage("WAR_Review_Rating_Inline","Bubble_Hover","");var a=n(".rate",t).get(0),r=n("#overallRatingFlagText",t).get(0),l=require("ta/widgets/DynamicRating");new l(a,{prefix:"b",prefixes:{0:"gb"},textNode:r,strings:window.RATING_STRINGS,ratingNode:r,ratingNodeClass:"noRating",update:n("input[name=qid10]",t).get(0),onSelect:function(){var e=n("input[name=qid10]",t);e.length&&i.setEvtCookie("WAR_Review_Rating_Inline","Bubble_Select","",e.val(),"/UserReviewEdit"),n("#SUBMIT").click()}})};return{addDynamicRating:t}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"attraction_detail_urgency_callout","handlers",["handlers"]);t(["placement","ta","ta/Core/TA.Record"],function(e,t,n){function a(e){n.trackEventOnPage("Attraction_Review","LTSO_Message","click_"+e)}return{"trackClickEvent":a}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"attraction_merchandising","handlers",["handlers"]);t(["placement"],function(e){function t(e,t){var i=ta.id("TABS_TOURS"),r=e.querySelector(".placement"),s=r?r.getAttribute("data-attr-prod-per-row"):"";i&&("true"==t&&(ta.on("arrrTabBarFixBegin",a),ta.on("arrrTabBarUnFixBegin",n),ta.servlet&&ta.servlet.LocationDetail&&ta.servlet.LocationDetail.clickTab(i),o("auto_expansion")),ta.on("clickTab",function(e){"TABS_TOURS"===e&&d()})),ta.trackEventOnPage("AR_XSELL_MERCH","true"==t?"sideways_impression":"Impression",s,0,!0)}function n(){ta.select(".sideways_header_container").addClass("hidden")}function a(){ta.select(".sideways_header_container").removeClass("hidden")}function i(){var n=ta.id(e.id);if(n){var a=n.querySelector(".attractionMerchandising");if(a){var i=a.getAttribute("data-attraction-id"),r=a.getAttribute("data-geo-id"),o=a.getAttribute("data-sideways");if("true"==o){var s=ta.id("FLOATING_PERSISTENT_TAB_HEADER");s&&s.addClass("sideways")}e.requestAJAXPlacement(function(e){n.set("html",e),ta.queueForLoad(function(){t(n,o)})},function(){},{"attraction-id":i,"geo-id":r,"sideways":o})}}return!1}function r(t){var n=ta.id(e.id);if(n){var a=n.getElement(".content"),i=a.getElement(".inner"),r=a.offsetHeight;a.style.maxHeight=r+"px",t();var o=i.offsetHeight,s=o<r;o!=r&&(a.offsetHeight=o),a.style.maxHeight="",s&&ta.util.element.scrollIntoView(n,-100)}}function o(t){var n=ta.id(e.id);if(n){var a=n.getElement(".moreContent");a&&(r(function(){n.getElements(".toggleable").removeClass("hidden")}),n.getElements(".moreContent").addClass("hidden"),n.getElements(".lessContent").removeClass("hidden"),ta.trackEventOnPage("AR_XSELL_MERCH",t))}}function s(){var t=ta.id(e.id);if(t){var n=t.getElement(".lessContent");n&&(r(function(){t.getElements(".toggleable").addClass("hidden")}),t.getElements(".lessContent").addClass("hidden"),t.getElements(".moreContent").removeClass("hidden"),ta.trackEventOnPage("AR_XSELL_MERCH","collapse_click"))}}function d(){o("expansion_click")}function l(e,t,n,a){return ta.trackEventOnPage("AR_XSELL_MERCH",n,a),window.open(t,"_blank"),e.stopPropagation(),!1}return ta.queueForReady(i),{"lessContent":s,"moreContent":d,"trackAndOpenUrl":l}})});
require(["ta/p13n/placements"],function(a){var r=a.define.bind(a,"attraction_promo_header","handlers",["handlers"]);r(["placement","ta","lib/jquery-amd"],function(a,r,e){var t=function(a){return e(".attraction_promo_header").find(".ui_modal_card").addClass("is-active"),r.trackEventOnPage("attraction_promo_click","terms","",a,!1),!1},n=function(a){return e(".attraction_promo_header").find(".ui_modal_card").removeClass("is-active"),!1};return{showPromoTermsDialog:t,hidePromoTermsDialog:n}})});
require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"attraction_review_xsell_shelf","handler",["handler"]);e(["placement","ta/prwidgets"],function(t,e){function a(){var a=ta.id(t.id),i=a.querySelector(".attractions_coverpage_widget");if(i){var n=i.getAttribute("data-geo-id"),r=i.getAttribute("data-attraction-id");n&&r&&t.requestAJAXPlacement(function(t){a.set("html",t),e.initWidgets()},function(){},{"data-geo-id":n,"data-attraction-id":r})}}return ta.queueForReady(a),{}})});
require(["ta/prwidgets"],function(e){var a=e.define.bind(e,"attractions_curated_shopping_carousel","handlers",["handlers"]);a(["widget","lib/jquery-amd","ta/Core/TA.Record"],function(e,a,n){"use strict";function r(e){var a=o.find(c+l),n=a.data("idx")+e;t(n)}function t(e){var r=o.find(c);r.removeClass(s),e<=0?(e=0,o.find(".left_nav").addClass("hidden")):o.find(".left_nav").removeClass("hidden"),e>=r.length-1?(e=r.length-1,o.find(".right_nav").addClass("hidden")):o.find(".right_nav").removeClass("hidden"),a(r[e]).addClass(s);var t=o.find(".buttonStyle");t.removeClass("selected"),a(t[e]).addClass("selected"),n.trk("shopping_carousel_select",!1,r[e])}function d(e){var a;a=e?e+"_carousel_click":"shopping_carousel_click",n.setEvtCookieAndPath(a)}var i,s="currentCarousel",l=".currentCarousel",c=".curated_carousel_wrap",o=a(e.element),u=function(){var e={};ta.SwipeHandler&&(e.onForward=function(){r(1)},e.onBackward=function(){r(-1)},i=new ta.SwipeHandler(o[0],e))};return u(),{selectImage:t,advanceImage:r,trackCarouselClick:d}})});
define("utils/ellipsis",["lib/jquery-amd"],function(t){"use strict";var i=function(i,e){if(null!=i){var l="…",n=t(i),r=n.height(),s=n.data("overview"),o=0,u=s.length,f=u;if(n.text(s),i.scrollHeight>r){for(;u-o>1;){var a=Math.floor((o+u)/2),c=s.substr(0,a)+l;n.text(c),i.scrollHeight<=r?(o=a,f=a):u=a}n.text(s.substr(0,f)+l)}e&&e(s.length-f)}},e=function(e,l){i(e,l),t(window).resize(function(){i(e,l)})};return{initEllipsis:e}});
require(["ta/prwidgets"],function(i){var n=i.define.bind(i,"attractions_curated_shopping_description","handlers",["handlers"]);n(["widget","lib/jquery-amd","ta/Core/TA.Event","ta/Core/TA.Record","utils/ellipsis"],function(i,n,t,e,r){function s(i){a.find("span.more").each(function(){i>0?n(this).show():n(this).hide()})}var a=n(i.element),c={};return c.more=function(i){var n;n=i?i:"shopping_description_click",a.find(".ui_modal_card").addClass("is-active"),e.trk(n)},c.trackExternalDesc=function(i){var n;n=i?i:"shopping_description_click",e.setEvtCookieAndPath(n)},a.find(".description_container").each(function(){r.initEllipsis(this,s)}),c})});
require(["ta/p13n/placements"],function(a){var n=a.define.bind(a,"curated_shopping_premium_content","handlers",["handlers"]);n(["placement","lib/jquery-amd","ta/Core/TA.Record"],function(a,n,e){var r={};return r.showSiblingModal=function(a){var r=n(a);r.siblings(".ui_modal_card").addClass("is-active");var i=r.data("trackaction");i&&e.trk(i)},r})});
require(["ta/p13n/placements"],function(t){var a=t.define.bind(t,"nearby_attractions_xsell","handlers",["handlers"]);a(["placement"],function(t){function a(){var t=ta.id("NEARBY_ATTRACTIONS_LIST");if(t){var a=t.getAttribute("data-attr-products");a&&ta.trackEventOnPage("AR_XSELL_MERCH_TEST","Impression",a,0,!0)}}return ta.queueForLoad(a),{}})});
define("xsell/metaLightbox",["vanillajs","ta","api-mod","overlays/widgetoverlays","overlays/options/closeOnTaEvent","ta/Core/TA.LocalStorage","ta/Core/TA.Record"],function(e,t,n,a,i,o,s){function r(e,a,i){function o(){if(n.inDocument(e.container)){var o=t.page&&t.page.hasDates&&t.page.hasDates("STAYDATES")||t.widgets&&t.widgets.calendar&&t.widgets.calendar.hasPageDates();o&&(e.hide(),setTimeout(function(){f(a,i)},0))}}e.on("show",function(){t.page&&t.page.usingUnifiedDates?t.page.on("dateSelected",o):t.on("newInlinePageDates",o)}),e.on("hide",function(){t.page&&t.page.usingUnifiedDates?t.page.off("dateSelected",o):t.off("newInlinePageDates",o)})}function c(e,i,o,s){if(e&&("click"===e.type||"mouseenter"===e.type||"mouseover"===e.type)){var c=t.page&&t.page.hasDates&&t.page.hasDates("STAYDATES")||t.widgets&&t.widgets.calendar&&t.widgets.calendar.hasPageDates();return"click"===e.type&&n.stopEvent(e),c?"click"===e.type&&f(o,s):a.triggerFlyout(e,i,"DATE_SEARCH_FLYOUT",{locationId:String(o)},{mixins:[function(){r(this,o,s)}]}),!1}}function g(e){return o.enabled&&!!o.getSessionKey(e+v)}function l(e){o.enabled&&o.setSessionKey(e+v,!0)}function d(e){e&&!g(e)&&(s.trackEventOnPage(e,"meta_LB_in_view"),l(e))}function p(e,t,a,i){t[u]||(t[u]=!0,n.addEvent(t,"click",function(e){c(e||window.event,this,a,i)}),n.addEvent(t,"mouseenter",function(e){c(e||window.event,this,a,i)}),e&&c(e,t,a,i))}function f(e,n,o){if(!t.page||!t.page.usingUnifiedDates)return void t.overlays.Factory.metaCheckRatesOverlay_allProviders(e,null);var s={locationId:String(e)};o&&"string"==typeof o.mapSponsorship&&(s.mapSponsorship=o.mapSponsorship);var r=[i("ibOfferClick")];a.showLightbox("HOTEL_META_LIGHTBOX",s,{sendTravelInfo:!0,classes:"no_padding below_stay_dates_popover",mixins:r}),d(n)}var u="xsell_metaLightbox_init",v="track_xsell_metaligtbox_opened";return{initShowPricesButton:p,showMetaLightbox:f}});
require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"meta_small_rec_button","handlers",["handlers"]);t(["widget","xsell/metaLightbox"],function(e,t){function a(e,a,n,l,r,i){t.initShowPricesButton(e,a,n,i)}function n(e,t,a,n,l){ta.call("ta.overlays.Factory.microMetaOverlay",e,t,a,n,null,null,l)}return{"calendarOverlay":a,"metaOverlay":n}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"ar_nearby_hotels_dust","handlers",["handlers"]);t(["placement"],function(e){function t(){if(!(l>1)){a();try{l=1,_=setTimeout(r,1e3)}catch(e){ta.util.error.record(e,"meta_hotels_narrow - hoverIn")}}}function a(){1==l&&(clearTimeout(_),l=0)}function r(){try{ta.trk(e.name+"_HOVER_EXPAND",!1,null),l=2;var t=ta.id("expand_"+e.id+"_on_hover");if(!t)return;t.removeClass("hidden"),t.addClass("expanding");var a=t.getSize().y;t.removeClass("expanding"),t.addClass("show");var r=new Fx.Tween(t,{duration:"long",property:"height"});r.start(0,a)}catch(e){ta.util.error.record(e,"also viewed - avafExpand")}}function n(){try{ta.trk(e.name+"_EXPAND_MORE",!1,null);var t=ta.id("hide_"+e.id+"_on_more");if(t&&t.addClass("hidden"),t=ta.id("expand_"+e.id+"_on_more"),!t)return;t.removeClass("hidden"),0===d&&(t.addClass("expanding"),d=t.getSize().y,t.removeClass("expanding")),t.addClass("show"),new Fx.Tween(t,{duration:"long",property:"height"}).start(0,d)}catch(e){ta.util.error.record(e,"also viewed - avafMore")}}function i(){try{ta.trk(e.name+"_HOVER_EXPAND_LESS",!1,null),l=2;var t=ta.id("expand_"+e.id+"_on_more");if(!t)return;new Fx.Tween(t,{duration:"long",property:"height"}).start(t.getSize().y,0).chain(function(){t.removeClass("show"),t.addClass("hidden");var a=ta.id("hide_"+e.id+"_on_more");a&&a.removeClass("hidden")})}catch(e){ta.util.error.record(e,"also viewed - avafMore")}}function o(t){try{if(ta.retrieve("ta.redirectingPage"))return;(!t||t<1)&&(t=1);var a=(new Date).getTime();c=a;var r=1e3,n=!1,i=!1;if(n=ta.widgets.calendar.getCheckRatesData(),!n)return;var s={};window.pageServlet&&(s={metaReferer:window.pageServlet}),i=Object.merge(n,{"detail":""+e.location_id,"reqNum":t>1?"2":"1","placementName":e.name,"servletClass":e.servletClass},s);var d=Object.toQueryString(i);if(!d||!d.trim())return void ta.util.error.record(null,e.name+" load - toQueryString failure",null,i);new Request({"url":"/MetaPlacementAjax","data":i,"evalScripts":!0,"onSuccess":function(n){if(c==a){var i=t>=4||n.contains("xsellHacStatusReady")||n.contains("xsellHacStatusSOL");if(i){var s=ta.id(e.id),d=document.getElement(".clearDates");if(s){2==l&&(l=0),s.show(),s.setStyle("height",0),s.setStyle("opacity","0"),s.innerHTML=n,ta.prwidgets&&ta.prwidgets.initWidgets(s),d&&(d.style.display="none");var _=s.getElement(".propList");if(_){var h=new Fx.Tween(s,{property:"opacity"}),u=_.getSize().y,m=new Fx.Tween(s,{property:"height",onComplete:function(){s.setStyle("height","auto"),h.start(0,1)}});m.start(0,u)}}}else setTimeout(function(){o(t+1)},r)}},"onFailure":function(){ta.retrieve("ta.redirectingPage")||ta.util.error.record(null,e.name+" load - MetaPlacementAjax request failed")}}).send()}catch(t){ta.util.error.record(t,e.name+" load")}}function s(){var e=document.getElement(".col.sidebar"),t=document.getElement("#BODYCON .gridA .balance")||document.getElement("#BODYCON .gridR .balance"),a=document.getElement("#HSCS");if(e&&t&&a){var r=t.getTop(),n=e.offsetHeight,i=r+n-15;a.getTop()>i?(a.addClass("similar_tab_rhr"),$$("div.similar_tab_rhr_yes").show(),$$("span.similar_tab_rhr_yes").show("inline"),$$(".similar_tab_rhr_no").hide(),ta.retrieve("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on")||(ta.store("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on",!0),ta.trackEventOnPage("prodp13n_hr_similar_xsell","expand_into_rhr"))):(a.removeClass("similar_tab_rhr"),$$(".similar_tab_rhr_yes").hide(),$$("div.similar_tab_rhr_no").show(),$$("span.similar_tab_rhr_no").show("inline"),ta.retrieve("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on")&&(ta.store("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on",!1),ta.trackEventOnPage("prodp13n_hr_similar_xsell","shrink_from_rhr")))}}var l=0,d=0,_=null,c=null;return ta.queueForLoad(function(){ta.widgets.calendar.getCheckRatesData()?o(1):ta.on("onCalendarRangeSelect",function(){o(1)});var t=ta.id(e.id);ta.util.element.doIfElementIsVisible(t,ta.trackEventOnPage,[e.name,"inView"])},"initialize "+e.container_id),ta.retrieve("ta.p13n.setHscsRHROverflow")||(ta.store("ta.p13n.setHscsRHROverflow",!0),setInterval(s,1e3)),{hoverIn:t,hoverOut:a,expandMore:n,expandLess:i}})});
require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"ar_nearby_hotels_xsell","handlers",["handlers"]);t(["placement"],function(e){function t(){if(!(l>1)){r();try{l=1,_=setTimeout(a,1e3)}catch(e){ta.util.error.record(e,"meta_hotels_narrow - hoverIn")}}}function r(){1==l&&(clearTimeout(_),l=0)}function a(){try{ta.trk(e.name+"_HOVER_EXPAND",!1,null),l=2;var t=ta.id("expand_"+e.id+"_on_hover");if(!t)return;t.removeClass("hidden"),t.addClass("expanding");var r=t.getSize().y;t.removeClass("expanding"),t.addClass("show");var a=new Fx.Tween(t,{duration:"long",property:"height"});a.start(0,r)}catch(e){ta.util.error.record(e,"also viewed - avafExpand")}}function n(){try{ta.trk(e.name+"_EXPAND_MORE",!1,null);var t=ta.id("hide_"+e.id+"_on_more");if(t&&t.addClass("hidden"),t=ta.id("expand_"+e.id+"_on_more"),!t)return;t.removeClass("hidden"),0==d&&(t.addClass("expanding"),d=t.getSize().y,t.removeClass("expanding")),t.addClass("show"),new Fx.Tween(t,{duration:"long",property:"height"}).start(0,d)}catch(e){ta.util.error.record(e,"also viewed - avafMore")}}function i(){try{ta.trk(e.name+"_HOVER_EXPAND_LESS",!1,null),l=2;var t=ta.id("expand_"+e.id+"_on_more");if(!t)return;new Fx.Tween(t,{duration:"long",property:"height"}).start(t.getSize().y,0).chain(function(){t.removeClass("show"),t.addClass("hidden");var r=ta.id("hide_"+e.id+"_on_more");r&&r.removeClass("hidden")})}catch(e){ta.util.error.record(e,"also viewed - avafMore")}}function o(t){try{if(ta.retrieve("ta.redirectingPage"))return;t&&t>=1||(t=1);var r=(new Date).getTime();c=r;var a=1e3,n=!1,i=!1;if(n=ta.widgets.calendar.getCheckRatesData(),!n)return;var s={};window.pageServlet&&(s={metaReferer:window.pageServlet}),i=Object.merge(n,{"detail":""+e.location_id,"reqNum":t>1?"2":"1","placementName":e.name,"servletClass":e.servletClass},s);var d=Object.toQueryString(i);if(!d||!d.trim())return void ta.util.error.record(null,e.name+" load - toQueryString failure",null,i);new Request({"url":"/MetaPlacementAjax","data":i,"evalScripts":!0,"onSuccess":function(n){if(c==r){var i=t>=4||n.contains("xsellHacStatusReady")||n.contains("xsellHacStatusSOL");if(i){var s=ta.id(e.id),d=document.getElement(".clearDates");if(s){2==l&&(l=0),s.show(),s.setStyle("height",0),s.setStyle("opacity","0"),s.innerHTML=n,ta.prwidgets&&ta.prwidgets.initWidgets(s),d&&(d.style.display="none");var _=s.getElement(".propList");if(_){var h=new Fx.Tween(s,{property:"opacity"}),u=_.getSize().y,m=new Fx.Tween(s,{property:"height",onComplete:function(){s.setStyle("height","auto"),h.start(0,1)}});m.start(0,u)}}}else setTimeout(function(){o(t+1)},a)}},"onFailure":function(){ta.retrieve("ta.redirectingPage")||ta.util.error.record(null,e.name+" load - MetaPlacementAjax request failed")}}).send()}catch(t){ta.util.error.record(t,e.name+" load")}}function s(){var e=document.getElement(".col.sidebar"),t=document.getElement("#BODYCON .gridA .balance")||document.getElement("#BODYCON .gridR .balance"),r=document.getElement("#HSCS");if(e&&t&&r){var a=t.getTop(),n=e.offsetHeight,i=a+n-15;r.getTop()>i?(r.addClass("similar_tab_rhr"),$$("div.similar_tab_rhr_yes").show(),$$("span.similar_tab_rhr_yes").show("inline"),$$(".similar_tab_rhr_no").hide(),ta.retrieve("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on")||(ta.store("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on",!0),ta.trackEventOnPage("prodp13n_hr_similar_xsell","expand_into_rhr"))):(r.removeClass("similar_tab_rhr"),$$(".similar_tab_rhr_yes").hide(),$$("div.similar_tab_rhr_no").show(),$$("span.similar_tab_rhr_no").show("inline"),ta.retrieve("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on")&&(ta.store("ta.p13n.prodp13n_hr_similar_tab_rhr_is_on",!1),ta.trackEventOnPage("prodp13n_hr_similar_xsell","shrink_from_rhr")))}}var l=0,d=0,_=null,c=null;return ta.queueForLoad(function(){ta.widgets.calendar.getCheckRatesData()?o(1):ta.on("onCalendarRangeSelect",function(){o(1)})},"initialize "+e.container_id),ta.retrieve("ta.p13n.setHscsRHROverflow")||(ta.store("ta.p13n.setHscsRHROverflow",!0),setInterval(s,1e3)),{hoverIn:t,hoverOut:r,expandMore:n,expandLess:i}})});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"neighborhood_widget","handlers",["handlers"]);n(["placement"],function(e){function n(n,o,i,r){if(g)return!1;ta.trackEventOnPage("neighborhood_widget","showWidget");var a=ta.id(e.id);if(!a)return!1;var d=a.getElement(".info");return!!d&&(e.requestAJAXPlacement(function(e){var n=$(document.createElement("div"));return n.innerHTML=e,g=n.getElement(".widgetContainer"),t(d,g)},function(){},{geoId:i,locationId:r}),!1)}function t(e,n){n&&e&&(c=new ta.overlays.RelativeOverlayBelow({style:"",offsetTop:-7,flipPadding:14,noPadding:!0,activate:ta.overlays.ACTIVATE_CLICK_TOGGLE,showCloseButton:!1,autoShow:!1,delayShow:!0,centered:!0,onShow:function(){return o(c)},content:n},e))}function o(e){if(e&&e.container){var n=e.container.getElement(".widget");if(n){var t=e.container.hasClass("relAbove");n.toggleClass("widgetAbove",t),n.toggleClass("widgetBelow",!t)}}}function i(){return c&&c.hide(),!1}function r(){return ta.trackEventOnPage("neighborhood_widget","thumbClicked"),!1}function a(){return ta.trackEventOnPage("neighborhood_widget","titleClicked"),!1}function d(e,n){return ta.trackEventOnPage("neighborhood_widget","explore_neighborhood_RR_small"),!0}function l(){if(ta.trackEventOnPage("neighborhood_widget","readMore"),c&&c.container){var e=c.container.getElement(".baseText"),n=c.container.getElement(".fullText");if(e&&n){var t=c.container.getSize();e.addClass("hidden"),n.removeClass("hidden");var o=c.container.getSize();if(c.container.hasClass("relAbove")&&t&&t.y&&o&&o.y&&t.y<o.y){var i=o.y-t.y,r=c.container.getPosition();r&&r.x&&r.y&&c.container.position({x:r.x,y:r.y-i})}}return!1}}var c=null,g=null;return{showWidget:n,closeWidget:i,readMore:l,thumbClicked:r,titleClicked:a,exploreThisNeighborhood:d}})});
require(["ta/p13n/placements"],function(e){var r=e.define.bind(e,"prodp13n_hr_sur_reviews_no_results","handlers",["handlers"]);r(["placement","vanillajs"],function(e,r){return{clearAll:function(r){var t={whiteBoxTopElmt:document.querySelector("#REVIEWS .ratings_and_types .ppr_rup"),loadingBoxTopElmt:e.id};return ta.page&&ta.page.applyReviewFiltersForm?ta.page.applyReviewFiltersForm(r,t):ta.servlet.Reviews.filterReviews(r,t),!1}}})});
require(["ta/p13n/placements"],function(e){var n=e.define.bind(e,"waypoint_for_poi","handlers",["handlers"]);n(["placement"],function(e){function n(n){if(r)return!1;var a=ta.id(e.id);if(!a)return!1;var o=a.getElement(".h_name_link");return!!o&&(e.requestAJAXPlacement(function(e){var n=$(document.createElement("div"));n.innerHTML=e;var a=n.getElement(".widget");return t(o,a)},function(){ta.trackEventOnPage("Restaurant_Review_Page","Hover_Failure")},{locationId:n}),!1)}function t(e,n){e&&n&&(r=new ta.overlays.RelativeOverlayBelow({style:"",offsetTop:-7,flipPadding:14,noPadding:!0,activate:ta.overlays.ACTIVATE_HOVER,showCloseButton:!1,autoShow:!0,delayShow:!1,centered:!0,onShow:function(){return a(n)},content:n},e))}function a(e){var n=e.getElement(".card_container");if(n&&e.parentElement&&e.parentElement.parentElement){var t=e.parentElement.parentElement.hasClass("relAbove");n.toggleClass("above",t),n.toggleClass("below",!t)}}var r=null;return{showHover:n}})});
define("ta/servlet/userreview/common",["ns-exporter","lib/jquery-amd","ta/Core/TA.Record"],function(e,t,r){"use strict";var a=function(){var e=200,a=-1;return function(n,u){if(n&&u){var _=n.getAttribute("data-minlen")||e,c=i(n);c>=_/2&&a<_/2?r.trackEventOnPage("WAR_Required","Review_Field_Half_Done",""):c>=_&&a<_&&r.trackEventOnPage("WAR_Required","Review_Field_All_Done",""),a<c&&(a=c),0===c?t(u).text(u.getAttribute("data-empty-msg")):1===c?t(u).text(u.getAttribute("data-singular-msg")):t(u).text(u.getAttribute("data-plural-msg").replace("XLENGTH",c)),t(u).toggleClass("longEnoughReview",c>=_)}}}(),n=function(e){return u(e,"focus")},u=function(){var e={},a={ReviewText_focus:["WAR_Required","Review_Field_Focus",""],ReviewTitle_focus:["WAR_Required","Title_Field_Focus",""],ROOM_TIP_focus:["WAR_Optional","Tips_Field_Focus",""],DualWhere_focus:["WAR_First_Focus_Where","Focus_Where"],DualWhat_focus:["WAR_First_Focus_What","Focus_What"],reviewGeo_input:["Unattached_Search","Select_WAR_Rental_City"],VR_OWNER_input:["Unattached_Search","Type_WAR_Rental_Owner"],VR_PROP_input:["Unattached_Search","Type_WAR_Rental_Property_ID"],query_focus:["Unattached_Search","Unified_WAR_Search_Bar"]};return function(n,u){if(n=t("string"==typeof n?"#"+n:n),n.prop("id")){var i=n.prop("id")+"_"+u,_=a[i];!e[i]&&_&&(r.trackEventOnPage.apply(null,_),e[i]=1)}}}(),i=function(e){var t,r=e.getAttribute("data-lang")||"",a=e.value||"";if(/^zh/.test(r)){var n=a.match(/[\u4E00-\u9FAF]/g,"");t=n?n.length:0}else t=a.trim().replace(/\s{2,}/g," ").length;return t},_={updateCharCounter:a,trackFieldFocus:n,trackOnlyOnce:u,getInputLength:i};return e.exportTo(_,"ta.userreview.common"),_});
define("ta/util/Qualaroo",["vanillajs","ns-exporter","ta/util/Error","ta/util/Object"],function(e,n,t,o){"use strict";var r={},u=["//","while(true);","while(1);","for(;;);"],a="check",i="force",l=function(e,n){t.record(e,n)},s=function(e,n){var t,o,r;if(!e||!n)return!1;if("json"!==n&&"jsonp"!==n)return e;for(t=0;t<u.length;t++)if(o=u[t],r=e.indexOf(o),0===r)return e.substring(o.length);return e},c=function(e){e?p("/CheckSurvey",S({key:e,action:"init"})):l(null,"_initSurveyKey: No surveyKey to use as token for qualaroo survey display")},y=function(e){e?p("/CheckSurvey",S({key:e,action:"set"})):l(null,"_setSurveyKey: No surveyKey to use as token for qualaroo survey display")},d=function(e,n){if(window._kiq){var t={name:e};n&&(t=o.merge(t,n)),ta.has("ta.qualaroo."+e)&&(t=o.merge(t,ta.retrieve("ta.qualaroo."+e))),window._kiq.push(["set",t])}},f=function(e,n,t,o,r){return new Promise(function(u,a){e&&n&&o?p("/CheckSurvey",S({key:e,action:o,name:n}),function(e){var o=JSON.parse(e),i=o&&"true"===o.display;i&&(t?(window.parent.postMessage("loadQualarooSurvey","*"),u()):window.loadQualarooSurvey?(d(n,r),window.loadQualarooSurvey(),u()):window._kiq?(d(n,r),u()):(l(null,"_conditionallyDisplaySurvey: window.loadQualarooSurvey is not defined, can't display survey"),a()))}):(l(null,"_conditionallyDisplaySurvey: No surveyKey or surveyName or checkAction defined for qualaroo survey display"),a())})},v=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],n=null,t=0;t<e.length;t++)try{n=new ActiveXObject(e[t]);break}catch(e){}return n},p=function(e,n,t){var o=null;try{o=v()}catch(e){return void l(null,"ta.qualaroo._doGet: Unable to make request in _doGet")}return o?(o.open("GET",e+n,!0),o.onreadystatechange=function(){4===o.readyState&&t&&t(s(o.responseText,"json"))},void o.send(null)):void l(null,"ta.qualaroo._doGet: Unable to make request in _doGet")},S=function(e){var n=[];for(var t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return"?"+n.join("&")};return r.initSurvey=function(e){c(e)},r.cancelSurvey=function(e){y(e)},r.checkAndDisplaySurvey=function(e,n,t){return f(e,n,t,a,null)},r.forceDisplaySurvey=function(e,n,t,o){return f(e,n,t,i,o)},n.exportTo(r,"ta.qualaroo"),r});
!function(t){var e="ListingQuestionsAjax",i="LISTING_QUESTIONS",n="engage_questions",s="UNKNOWN",o=0;t.widgets||(t.widgets={});var a=function(e){var i="listingQuestions-offset-"+window.modelLocId;return void 0!==e&&t.localStorage.set(i,+e),+t.localStorage.get(i)||0},g=function(t){return"/"+e+"?"+Object.toQueryString(t)},u=[],d=function(){var t=document.body||document.documentElement,e=t.style,i="transition";if("string"==typeof e[i])return!0;var n=["Moz","webkit","Webkit","Khtml","O","ms"];i=i.charAt(0).toUpperCase()+i.substr(1);for(var s=0;s<n.length;s++)if("string"==typeof e[n[s]+i])return!0;return!1}();t.widgets.listingQuestions={getRoot:function(){return t.id(i)},load:function(){var e=a();u.length>0?(a(e+1),t.widgets.listingQuestions.shiftIn()):t.widgets.listingQuestions.hide()},registerQuestion:function(t){var e=new Element("div",{"class":"container shifty"});e.appendChild(t),u.unshift(e)},shiftIn:function(e){if(e=e||u.pop(),!e)return void t.widgets.listingQuestions.hide();e.getElement(".single_question")&&e.getElement(".single_question").get("data-locationtag-id")&&t.trackEventOnPage(n,this.copyName()+"_places_vote_shown",e.getElement(".single_question").get("data-locationtag-id"));var i=t.widgets.listingQuestions.getRoot(),s=i.getElement(".listing_questions"),o=+i.get("data-trans-pause")||10,a=+i.get("data-trans-ms")||200,g=s.getChildren(".container");return d?(g.length>0&&(g.setStyles({width:g[0].getWidth(),height:g[0].getHeight()}),g.addClass("shift-out"),e.addClass("shift-in")),s.grab(e),void setTimeout(function(){e.removeClass("shift-in"),i.addClass("loaded"),setTimeout(function(){g.dispose()},a)},o)):(g.dispose(),void setTimeout(function(){s.grab(e),i.addClass("loaded")},a))},vote:function(i,s){if(!i.getAttribute("checked")){i.setAttribute("checked",!0);var o=i.getAttribute("data-locid"),a={locationId:o,id:i.getAttribute("data-id"),value:i.getAttribute("data-value"),pid:this.pid(),token:t.retrieve("securityToken")};t.trackEventOnPage(n,"vote_"+a.value,this.copyName());var u=[10977,10978,10974,10975,12125,12126];u.indexOf(parseInt(a.id))>=0&&t.trackEventOnPage(n,this.copyName()+"_places_vote_"+a.value,a.id),new t.util.ajax({data:a,method:"POST",url:g({format:"json",a:"TAG_VOTE"}),onSuccess:s,onFailure:function(i){t.util.error.record(i,e),t.widgets.listingQuestions.hide()}})}},voteAndRefresh:function(e,i,n){this.vote(e,function(){t.widgets.listingQuestions.load(i,n)})},skip:function(e,i){t.trackEventOnPage(n,"skip",this.copyName()),t.widgets.listingQuestions.load(e,i)},evtCookie:function(e,i){t.setEvtCookie(n,e,this.copyName(),0,i)},copyName:function(t){return t&&(s=t)||s},pid:function(t){return t&&(o=t)||o},hide:function(){t.widgets.listingQuestions.getRoot().hide(),window.fireEvent("resize")},userClose:function(){t.trackEventOnPage(n,"close",this.copyName());var e=t.widgets.listingQuestions.getRoot();e.setStyle("height",0);var i=e.get("data-trans-pause")||10,s=e.get("data-trans-ms")||200;setTimeout(function(){e.hide()},s+i)},init:function(){var e=t.widgets.listingQuestions.getRoot()&&t.widgets.listingQuestions.getRoot().getElement(".listing_questions");if(e){var i=a();e.getChildren().each(function(e){t.widgets.listingQuestions.registerQuestion(e)}),i>0&&u.splice(-i);var n=0;"BANNER"==t.widgets.listingQuestions.copyName()&&(n=1),u.length>n?t.widgets.listingQuestions.shiftIn():t.widgets.listingQuestions.hide()}}},t.queueForLoad(t.widgets.listingQuestions.init)}(ta);
require(["ta/rollupAmdShim"],function(a){a.install(["ta/media/viewerScaffold","ta/photos/oysterTracking","pages/inappropriate_vote_stub"],["ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"media_albums",files:{js3:{src:{pages:{inappropriate_vote_stub:1},ta:{media:{viewerScaffold:1},photos:{oysterTracking:1}}}}},_:{baseUrl:"/"}})};
define("mixins/mixin",["vanillajs"],function(r){"use strict";return function(r){var i,n,t=Array.prototype.slice.call(arguments,1);for(var e in t)if(t.hasOwnProperty(e)){i=t[e];for(n in i)r[n]=i[n]}return r}});
require(["ta/rollupAmdShim"],function(a){a.install(["mixins/Events","utils/browserutils","api-mod","utils/MouseAway","utils/resourceLoader","overlays/Overlay","overlays/utils","overlays/ajaxUtil","overlays/options/closeOnDocClick","overlays/options/delayedCloseOnDocClick","overlays/options/closeOnChildClick","overlays/options/closeOnSourceClick","overlays/options/closeOnWindowshadeClick","overlays/options/closeOnMouseOut","overlays/options/closeOnMouseAway","overlays/options/closeOnScroll","overlays/options/closeOnEscape","overlays/options/closeOnEvent","overlays/options/closeOnTaEvent","overlays/options/closeOnTargetEvent","overlays/options/closeOnLegacyOverlay","overlays/options/fireEventOnWindowshadeClick","overlays/options/hoverDelay","overlays/options/storeOverlayOnElement","overlays/options/fadeInOut","overlays/options/highlightElement","overlays/options/repositionOnEvent","overlays/options/repositionOnTaEvent","overlays/options/autoReposition","overlays/options/autosizePage","overlays/options/keepInDom","overlays/options/matchWidth","overlays/options/maxWidth","overlays/options/minWidth","overlays/options/ajax","overlays/options/centerArrowOnSrcElement","overlays/options/closeOnTargetChildClick","overlays/options/stickyClick","overlays/position","overlays/styles/modal","overlays/styles/popover","overlays/styles/tooltip","overlays/styles/windowshade","overlays/styles/dropdown","overlays/styles/notification","overlays/uiOverlay"],["ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"uiOverlays",files:{"js-amd":{src:{mixins:{Events:1},utils:{browserutils:1,resourceLoader:1,MouseAway:1},"api-mod":1,overlays:{ajaxUtil:1,uiOverlay:1,utils:1,options:{closeOnTargetChildClick:1,keepInDom:1,autoReposition:1,closeOnTaEvent:1,ajax:1,closeOnDocClick:1,closeOnMouseOut:1,closeOnSourceClick:1,centerArrowOnSrcElement:1,fadeInOut:1,highlightElement:1,storeOverlayOnElement:1,autosizePage:1,closeOnScroll:1,stickyClick:1,maxWidth:1,closeOnWindowshadeClick:1,closeOnEscape:1,closeOnMouseAway:1,minWidth:1,closeOnLegacyOverlay:1,closeOnChildClick:1,closeOnTargetEvent:1,matchWidth:1,repositionOnEvent:1,fireEventOnWindowshadeClick:1,closeOnEvent:1,repositionOnTaEvent:1,delayedCloseOnDocClick:1,hoverDelay:1},styles:{notification:1,popover:1,tooltip:1,windowshade:1,dropdown:1,modal:1},position:1,Overlay:1}}}},_:{baseUrl:"/"}})};
define("utils/MouseAway",["vanillajs","api-mod","ta","mixins/mixin","mixins/Events","utils/throttle"],function(t,o,e,r,n,i){"use strict";function l(t,o){var e=t.right<=o.left,r=t.left>=o.right,n=t.top>=o.bottom,i=t.bottom<=o.top;if(e||r){var l=e?"left":"right",u=e?"right":"left";return[[t[l],t.top],[o[l],o.top],[o[u],o.top],[o[u],o.bottom],[o[l],o.bottom],[t[l],t.bottom]]}if(n||i){var a=n?"bottom":"top",f=n?"top":"bottom";return[[t.right,t[a]],[o.right,o[a]],[o.right,o[f]],[o.left,o[f]],[o.left,o[a]],[t.left,t[a]]]}return null}function u(t,o){if(!o)return!1;for(var e=t[0],r=t[1],n=!1,i=0,l=o.length-1;i<o.length;l=i++){var u=o[i][0],a=o[i][1],f=o[l][0],s=o[l][1],m=a>r!=s>r&&e<(f-u)*(r-a)/(s-a)+u;m&&(n=!n)}return n}function a(t,e,r){var n=r.relatedTarget||r.target;if(!t||!e)return!1;if(o.containsElement(t,n)||o.containsElement(e,n))return!0;var i=l(o.getCoords(t),o.getCoords(e)),a=u([r.clientX+o.scrollLeft(),r.clientY+o.scrollTop()],i);return a}function f(t,e){r(this,new n("mouseAway")),o.addEvent(window,"mousemove",i(function(o){var r=a(t,e,o);r||this.emit("mouseAway")}).bind(this),300)}return f});
define("overlays/options/delayedCloseOnDocClick",["api-mod"],function(t){"use strict";function e(e){if(!(this.sourceElement&&t.containsElement(this.sourceElement,e.target)||t.containsElement(this.container,e.target)||e.target&&("option"===e.target.tagName||t.hasClass(e.target,"ui_dropdown")||t.getParent(e.target,"ui_dropdown"))||t.checkBrowser("ie")&&e.target&&"select"==e.target.tagName&&t.containsEvent(e.target,e)&&t.select(this.container,"input").indexOf(e.target)))if(i&&i>0){var n=this;setTimeout(function(){n.hide("doc-click")},i)}else this.hide("doc-click")}function n(n){return function(o){return function(){var c=t.bind(e,this);i=o,this.on("show",function(){setTimeout(function(){this.isOpen()&&(t.addEvent(document,"click",c),n&&t.addEvent(document,"touchstart",c))}.bind(this),1)}).on("hide",function(){t.removeEvent(document,"click",c),n&&t.removeEvent(document,"touchstart",c)})}}}var i=0,o=n(!0);return o.withoutTouchEvents=n(!1),o});
define("overlays/options/closeOnChildClick",["vanillajs","api-mod"],function(t,n){"use strict";function i(t){n.containsElement(this.container,t.target)&&this.hide("child-click")}function e(t){return function(){var e=n.bind(i,this);this.on("show",function(){n.addEvent(this.domParent,"click",e),t&&n.addEvent(this.domParent,"touchstart",e)}).on("hide",function(){n.removeEvent(this.domParent,"click",e),t&&n.removeEvent(this.domParent,"touchstart",e)})}}var o=e(!0);return o.withoutTouchEvents=e(!1),o});
define("overlays/options/closeOnSourceClick",["vanillajs","api-mod"],function(t,e){"use strict";function n(t){e.containsElement(this.sourceElement,t.target)&&(this.hide("source-click"),t.stopPropagation(),t.preventDefault())}function i(t){return function(){var i=n.bind(this),o=function(t){setTimeout(t.bind(this),1)}.bind(this);this.on("show",o.bind(void 0,function(){e.addEvent(this.sourceElement,"click",i),t&&e.addEvent(this.sourceElement,"touchstart",i)})).on("hide",o.bind(void 0,function(){e.removeEvent(this.sourceElement,"click",i),t&&e.removeEvent(this.sourceElement,"touchstart",i)}))}}var o=i(!0);return o.withoutTouchEvents=i(!1),o});
define("overlays/options/closeOnMouseOut",["vanillajs","api-mod"],function(e,t){"use strict";function n(e){t.containsElement(this.sourceElement,e.relatedTarget)||t.containsElement(this.container,e.relatedTarget)||this.hide()}var o=function(){var e=t.bind(n,this);this.on("show",function(){t.addEvent(this.sourceElement,"mouseout",e),t.addEvent(this.container,"mouseout",e)}).on("hide",function(){t.removeEvent(this.sourceElement,"mouseout",e),t.removeEvent(this.container,"mouseout",e)})};return o});
define("overlays/options/closeOnMouseAway",["vanillajs","utils/MouseAway"],function(n,o){"use strict";return function(){var n=new o(this.sourceElement,this.container),e=this.hide;this.on("show",function(){n.on("mouseAway",e)}).on("hide",function(){n.off("mouseAway")})}});
define("overlays/options/closeOnScroll",["vanillajs","api-mod"],function(n,o){"use strict";var i=function(){this.on("show",function(){o.addEvent(window,"scroll",this.hide)}).on("hide",function(){o.removeEvent(window,"scroll",this.hide)})};return i});
define("overlays/options/closeOnEvent",["vanillajs","api-mod"],function(n,t){"use strict";function i(){this.hide("on-event")}return function(n){return function(){var e=t.bind(i,this);this.on("show",function(){t.addEvent(this.domParent,n,e)}).on("hide",function(){t.removeEvent(this.domParent,n,e)})}}});
define("overlays/options/closeOnTargetEvent",["vanillajs","api-mod"],function(n,t){"use strict";function i(){this.hide("on-event")}return function(n,o){return function(){var e=o.splice?o:[o],c=i.bind(this);this.on("show",function(){e.forEach(function(i){t.addEvent(n,i,c)})}).on("hide",function(){e.forEach(function(i){t.removeEvent(n,i,c)})})}}});
define("overlays/options/closeOnLegacyOverlay",["vanillajs","ta/Core/TA.Event"],function(n,e){"use strict";return function(){e.on("onOverlayShow",this.hide.bind(this))}});
define("overlays/options/fireEventOnWindowshadeClick",["vanillajs","api-mod"],function(n,i){"use strict";var e=function(n){return function(){i.addEvent(this.shade,"click",function(){i.fireEvent(document,n,{})})}};return e});
define("overlays/options/hoverDelay",["vanillajs","api-mod"],function(e,t){"use strict";var i=function(e,i){return function(){var n=t.bind(function(){this.hoverTimer=setTimeout(this.show,e)},this),o=t.bind(function(){clearTimeout(this.hoverTimer)},this);t.addEvent(this.sourceElement,"mouseover",n),t.addEvent(this.sourceElement,"mouseout",o),i&&n()}};return i});
define("overlays/options/storeOverlayOnElement",["vanillajs","api-mod"],function(e,t){"use strict";var n=function(){this.sourceElement&&t.store(this.sourceElement,"overlay",this)};return n});
define("overlays/options/fadeInOut",["vanillajs","api-mod"],function(i,n){"use strict";var t={"fade_none":0,"fade_short":250,"fade_normal":500,"fade_long":1e3},e="fade_in";return function(i,s){return function(){if(i&&i in t){n.addClass(this.container,i);var o=t[i],a=n.bind(this.show,this),d=n.bind(this.hide,this),h=null;this.show=function(){a&&a(),setTimeout(function(){n.addClass(this.container,e)}.bind(this),0),clearTimeout(h),s&&(h=setTimeout(n.bind(this.hide,this),o+s))},this.hide=function(){n.removeClass(this.container,e),clearTimeout(h),h=setTimeout(function(){d&&d()},o)},n.bindAll(this,"show","hide")}}}});
define("overlays/options/highlightElement",["api-mod"],function(i){"use strict";var n=function(n){function t(n){this.on("show",function(){i.addClass(n,"highlight")}).on("hide",function(){i.removeClass(n,"highlight")})}return arguments.length?function(){t.call(this,n)}:void t.call(this,this.sourceElement)};return n});
define("overlays/options/repositionOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(n,i){"use strict";return function(n){return function(){var t=this.emit.bind(this,"positionDirty");this.on("show",function(){i.on(n,t)}).on("hide",function(){i.off(n,t)})}}});
define("overlays/options/autosizePage",["lib/jquery-amd","api-mod"],function(o,t){"use strict";return function(i,n){return function(){function n(){var n=t.getCoords(this.container),s=t.getSize(window);this._scrollTop||(this._scrollTop=t.scrollTop()),o(document.body).css("overflow","hidden"),n.height+2*i>s.y&&o(this.container).css({top:i,marginTop:0}),window.scrollTo(0,0)}this.domParent=o("<div></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,overflow:"auto"})[0],this.on("append",function(){o(document.body).append(this.domParent)}),this.on("show",n),this.on("positionDirty",n),this.on("hide",function(){o(document.body).css("overflow","auto"),o(this.domParent).remove(),window.scrollTo(0,this._scrollTop),delete this._scrollTop})}}});
define("overlays/options/keepInDom",["vanillajs","api-mod"],function(i,n){var t="";return function(){this.show=function(){return n.inDocument(this.container)?(this.container.style.display=t,n.removeClass(this.container,"hidden")):this.domParent.appendChild(this.container),this.emit("show"),this},this.hide=function(i){return n.inDocument(this.container)&&"none"!=this.container.style.display&&("none"!=this.container.style.display&&(t=this.container.style.display||"",this.container.style.display="none"),n.hasClass(this.container,"hidden")||n.addClass(this.container,"hidden"),this.emit("hide",{trigger:i})),this}}});
define("overlays/options/matchWidth",["vanillajs","api-mod"],function(t,i){"use strict";var n=function(t){function n(){this.container&&t&&(i.setStyle(this.container,"width",i.getSize(t).x+"px"),this.emit("positionDirty"))}return function(){this.on("show",i.bind(n,this))}};return n});
define("overlays/options/maxWidth",["vanillajs"],function(i){"use strict";var t=function(i){function t(){this.container.style.maxWidth=i+"px",this.emit("positionDirty")}return function(){this.on("show",t.bind(this))}};return t});
define("overlays/options/minWidth",["vanillajs"],function(i){"use strict";var n=function(i){function n(){this.container.style.minWidth=i+"px",this.emit("positionDirty")}return function(){this.on("show",n.bind(this))}};return n});
define("overlays/options/centerArrowOnSrcElement",["vanillajs","api-mod"],function(t,i){"use strict";var o=function(t){function o(){if(t=t||this.sourceElement,this.container&&t&&this.arrow){var o=i.getCoords(this.container),r=i.getCoords(t),n=i.hasClass(this.container,"arrow_top")||i.hasClass(this.container,"arrow_bottom");if(n){var s=r.left+r.width/2,e=i.getSize(this.arrow).x/2,a=Math.max(e,Math.min(o.width-e,s-o.left));i.setStyle(this.arrow,{"left":a+"px","right":"auto","margin":"0 0 0 -"+e+"px"})}else{var s=r.top+r.height/2,e=i.getSize(this.arrow).y/2,h=Math.max(e,Math.min(o.height-e,s-o.top));i.setStyle(this.arrow,{"top":h+"px","bottom":"auto","margin":"-"+e+"px 0 0 0"})}}}return function(){this.on("show",i.bind(o,this)),this.on("positionDirty",i.bind(o,this)),this.on("repositionArrow",i.bind(o,this))}};return o});
define("overlays/options/closeOnTargetChildClick",["vanillajs","api-mod"],function(i,n){"use strict";return function(i){return function(){var t,c=n.bind(function(){this.hide("target-child-click")},this);this.on("show",function(){t=n.find(i),t&&n.addEvent(t,"click",c)}).on("hide",function(){t&&n.removeEvent(t,"click",c)})}}});
define("overlays/options/stickyClick",["vanillajs","api-mod","utils/MouseAway"],function(i,n,t){"use strict";var o=!1;return function(){var i=new t(this.sourceElement,this.container);n.addEvent(this.sourceElement,"click",function(){o=!0}),this.on("hide",function(){o=!1,i.off("mouseAway")}),this.on("show",function(){var n=this.hide.bind(this);i.on("mouseAway",function(){o||n("stickyClick")})})}});
define("overlays/styles/notification",["vanillajs","api-mod"],function(n,e){"use strict";function i(n,i){this.container=e.createElement("div",{"class":"ui_overlay ui_notification "+n}),this.icon=e.createElement("span",{"class":"ui_icon main_icon "+i}),this.container.appendChild(this.icon),this.close=e.createElement("span",{"class":"ui_icon times close"}),this.container.appendChild(this.close),this.inner=e.createElement("div",{"class":"message"}),this.container.appendChild(this.inner),this.contentElement=this.inner}function t(n){var i=e.find("."+u);i||(i=document.createElement("div"),i.className=u,document.body.appendChild(i)),n.domParent=i,i.appendChild(n.container),o(n),s(n)}function a(n){r(n),o(n),e.addEvent(n.container,"mouseleave",function i(){e.removeEvent(n.container,"mouseleave",i),s(n)}),n.emit("hover")}function o(n){e.removeClass(n.container,"hidden"),n.container.clientHeight,e.removeClass(n.container,"transparent")}function c(n){e.addClass(n.container,"transparent"),r(n),n.__hideTimer=setTimeout(e.bind(l,null,n),m)}function s(n){r(n),n.__transitionOutTimer=setTimeout(c.bind(null,n),h)}function r(n){n.__transitionOutTimer&&clearTimeout(n.__transitionOutTimer),n.__hideTimer&&clearTimeout(n.__hideTimer)}function l(n,e){n.hide(e)}function d(n){n.on("show",e.bind(t,null,n)),e.addEvent(n.container,"click",e.bind(l,null,n,"click")),e.addEvent(n.container,"mouseenter",e.bind(a,null,n))}var u="ui_notification_container",m=2e3,h=1e4,_=function(n,e,t,a){return e=e||n&&n.getAttribute("data-modal")||"",a=a||n&&n.getAttribute("data-icon")||"",function(){i.call(this,e,a),this.updateContent(t),d(this)}};return _});
define("widget/saves",["page-model","ta/registration/RegEvents","utils/to-array","ajax-request"],function(t,e,a,r){"use strict";function n(e,n,d){var c;if(3===arguments.length)return c=a(document.querySelectorAll('.saves-widget-button[data-id="'+e+'"][data-type="'+n+'"]')),void c.forEach(function(t){s(t,d)});if(t.session.loggedIn){c=a(document.querySelectorAll(".saves-widget-button"));var o=[];c.forEach(function(t){o.push({reference_type:t.getAttribute("data-type"),reference_id:t.getAttribute("data-id"),reference_uid:t.getAttribute("data-id")})}),0!==o.length&&r({"url":"/data/1.0/trips/references","type":"POST","data":JSON.stringify({data:o}),"content-type":"application/json","x-requested-by":t.JS_SECURITY_TOKEN}).then(i.bind(null,c))}}function i(t,e){var a={};JSON.parse(e).data.forEach(function(t){a[t.reference_type]||(a[t.reference_type]=[]),a[t.reference_type].push(t.reference_id)}),t.forEach(function(t){var e=t.getAttribute("data-type"),r=t.getAttribute("data-id"),n=!!(a[e]&&a[e].indexOf(+r)>=0);s(t,n)})}function d(t,e){return t.classList.contains(e)?t:t.querySelector("."+e)}function s(t,e){var a=(t.getAttribute("data-type"),t.getAttribute("data-id"),t.getAttribute("data-icon-class")),r=t.getAttribute("data-text"),n=t.getAttribute("data-text-saved"),i=d(t,"saves-icon-locator");if(i&&(e?(i.classList.remove(a),i.classList.add(a+"-fill")):(i.classList.add(a),i.classList.remove(a+"-fill"))),r&&n){var s=d(t,"saves-text-locator");s&&(s.innerText=e?n:r)}}function c(){o||(e.on("success",n),"complete"===document.readyState||"interactive"===document.readyState||"loaded"===document.readyState?n():document.addEventListener("DOMContentLoaded",n),o=!0)}var o=!1;return c(),{init:c,updateSaveButtonsStatus:n}});
define("mixins/page-dates/DateEvents",["mixins/Events","vanillajs"],function(e){"use strict";return new e("dateSelected","calendarOpened")});
define("ta/util/Date",["vanillajs","ns-exporter"],function(e,t){var n={};return n.MS_IN_DAY=864e5,n.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],n.HOUR_CONST=12,n.THAI_BUDDHIST_YEAR_OFFSET=543,n.MAX_STAY_DURATION_DAYS=30,n.MAX_VR_DURATION_DAYS=183,n.MAX_DAYS_BEFORE_RETURN_FLIGHT=330,n.inDateSet=function(e,t){if(null==e||null==t)return!1;for(var n=t.length,r=0;r<n;r++){var a=t[r];if(a.length){var i=a[0].getTime(),u=a[1].getTime();if(i<=e.getTime()&&u>=e.getTime())return!0}else if(e.getTime()==a.getTime())return!0}return!1},n.rangesIntersect=function(e,t){return Math.max(e[0].getTime(),t[0].getTime())<=Math.min(e[1].getTime(),t[1].getTime())},n.getDaysInRange=function(e,t){return Math.round((t.getTime()-e.getTime())/n.MS_IN_DAY)+1},n.getLastDayOfMonth=function(e){var t=new Date;return e&&(t=new Date(e.getTime())),t=new Date(n.normalize(t)),t.setDate(1),t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()},n.getDaysApart=function(e,t){var n=864e5;return e&&t?Math.round(Math.abs((e.getTime()-t.getTime())/n)):0},n.inSameMonth=function(e,t){return null!=e&&null!=t&&e.getMonth()==t.getMonth()&&e.getYear()==t.getYear()},n.normalize=function(e){return e.setHours(n.HOUR_CONST,0,0,0)},n.create=function(e,t,r){return new Date(e,t,r,n.HOUR_CONST)},t.exportTo(n,"ta.util.date"),n});
define("mixins/page-dates/Utils",["vanillajs"],function(e){"use strict";function t(e){var t=String(e);return(1===t.length?"0":"")+t}function r(e){return e.getFullYear()+"_"+t(e.getMonth()+1)+"_"+t(e.getDate())}function n(e){if(!e)return null;var t=e.split("-");return t.length<2&&(t=e.split("_")),new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))}function a(e){return"[object Date]"===Object.prototype.toString.call(e)}function i(e,t){if((!e||!t)&&[e,t].every(a))return!1;var r=new Date(e.getTime()),n=new Date(t.getTime());return r.setHours(0,0,0,0),n.setHours(0,0,0,0),r.getTime()===n.getTime()}function o(e,t){for(var r;e;){if(r=e.querySelector("[data-dateType="+t+"]"))return r;e=e.parentNode}return null}function u(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=!0,n=0;n<e.length;n++)r=r&&i(e[n],t[n]);return r}return{pad:t,dateToIso:r,fromString:n,compareDatesNoTime:i,compareDatesArrayNoTime:u,findClosestDatepicker:o}});
define("calendars/CalendarDate",["vanillajs"],function(t){"use strict";function n(t){t=t||new Date,this.date=new Date(t.getFullYear(),t.getMonth(),t.getDate())}return n.prototype={constructor:n,daysInMonth:function(){return new Date(this.year(),this.month()+1,0).getDate()},eachDayInMonth:function(t){for(var e=1,r=this.daysInMonth();e<=r;e++)t(new n(new Date(this.year(),this.month(),e)))},thisMonth:function(){return new n(new Date(this.year(),this.month(),1))},nextMonth:function(){return this.relativeMonth(1)},previousMonth:function(){return this.relativeMonth(-1)},relativeMonth:function(t){return new n(new Date(this.year(),this.month()+t,1))},relativeDay:function(t){return new n(new Date(this.year(),this.month(),this.day()+t))},firstOfMonth:function(){return new n(new Date(this.year(),this.month(),1))},lastOfMonth:function(){return new n(new Date(this.year(),this.month(),this.daysInMonth()))},year:function(){return this.date.getFullYear()},month:function(){return this.date.getMonth()},day:function(){return this.date.getDate()},dayOfWeek:function(){return this.date.getDay()},firstDayOfMonth:function(){return new Date(this.year(),this.month(),1).getDay()},inRange:function(t,n){return!(!t||!n)&&(this.compare(t)>0&&this.compare(n)<0)},compare:function(t){for(var n,e=["getFullYear","getMonth","getDate"],r=0,i=e.length;r<i;r++){if(n=e[r],this.date[n]()<t.date[n]())return-1;if(this.date[n]()>t.date[n]())return 1}return 0},daysTo:function(t){return Math.ceil((t.date.getTime()-this.date.getTime())/864e5)},toString:function(){return this.year()+"-"+this.month()+"-"+this.day()}},n.fromString=function(t){var e=t.split("-");return new n(new Date(e[0],e[1],e[2]))},n});
define("mixins/page-dates/DateTypeStore",["vanillajs","ta/Core/TA.Store","calendars/CalendarDate","mixins/page-dates/Utils"],function(e,t,n,r){"use strict";function i(e){var t=u(e);return 0==t.length?e:E[t[0]].children[0]}function a(e){var t=u(e);if(0==t.length)return e;var n=E[t[0]];return n.children[n.children.length-1]}function u(e){var t=[];for(var n in E)E.hasOwnProperty(n)&&E[n].children&&E[n].children.indexOf(e)>=0&&t.push(n);return t}function l(e){var t=ta.page.getDates(e);return t&&t[0]?new n(t[0]):null}var g="zu",E={CHECKIN:{queryString:null,pathString:null},CHECKOUT:{queryString:null,pathString:null},STAYDATES:{children:["CHECKIN","CHECKOUT"],queryString:"staydates",pathString:g+"s"},EATERY:{queryString:"eaterydate",pathString:g+"r"},DEPARTURE:{queryString:null,pathString:null},RETURN:{queryString:null,pathString:null},ROUNDTRIP:{children:["DEPARTURE","RETURN"],queryString:"rtdates",pathString:g+"t"},ONEWAYFLIGHT:{queryString:"oneway",pathString:g+"o"},LEG_1:{queryString:"leg1date",pathString:g+"1"},LEG_2:{queryString:"leg2date",pathString:g+"2"},LEG_3:{queryString:"leg3date",pathString:g+"3"},ATTRACTION:{queryString:"attrdate",pathString:g+"a"}};return E.isChildDateType=function(e){return u(e).length>0},E.isSingleDateType=function(e){var t=E[e];return!(E.isChildDateType(e)||t&&t.children&&t.children.length>0)},E.getParents=u,E.isHotelDateType=function(e){return u(e).indexOf("STAYDATES")>=0},E.isRoundTripDateType=function(e){return u(e).indexOf("ROUNDTRIP")>=0},E.isMultiCityDateType=function(e){return"LEG_1"==e||"LEG_2"==e||"LEG_3"==e},E.isStartDateType=function(e){var t=u(e);return 0!=t.length&&0==E[t[0]].children.indexOf(e)},E.isEndDateType=function(e){var t=u(e);if(0==t.length)return!1;var n=E[t[0]];return n.children.indexOf(e)==n.children.length-1},E.getStartDate=function(e){var t=i(e);return null==t?ta.page.getDates(e)[0]:ta.page.getDates(t)[0]},E.getEndDate=function(e){var t=a(e);return null==t?ta.page.getDates(e)[0]:ta.page.getDates(t)[0]},E.getMinEnabledDate=function(e){if(E.isHotelDateType(e)||E.isRoundTripDateType(e)){var i=t.retrieve("multiDP.minCheckInDate");if(i)return new n(r.fromString(i))}else{if("LEG_1"==e)return l("ONEWAYFLIGHT");if("LEG_2"==e)return l("LEG_1")||l("ONEWAYFLIGHT");if("LEG_3"==e)return l("LEG_2")||l("LEG_1")||l("ONEWAYFLIGHT")}return null},E.flattenType=function(e){var t=E[e];return t?t.children?t.children.slice(0):[e]:[]},E.getCorrespondingDateType=function(e){switch(e){case"CHECKIN":return"CHECKOUT";case"CHECKOUT":return"CHECKIN";case"DEPARTURE":return"RETURN";case"RETURN":return"DEPARTURE";default:return null}},E});
define("mixins/page-dates/Base",["vanillajs","ta","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore"],function(e,t,r,n){"use strict";function a(e){return e instanceof Date&&!isNaN(e.getTime())}function i(e){if(!n[e])throw"Invalid date type: "+e}function s(e){var t=[];for(var r in n)n.hasOwnProperty(r)&&n[r].children&&n[r].children.indexOf(e)>=0&&t.push(r);return t}function o(e,t){var a=n[e],i="";if(a.children)for(var s=0,o=a.children.length;s<o;s++){if("_"===t[a.children[s]])return"_";i+=(s>0?"_":"")+r.dateToIso(t[a.children[s]])}else{if("_"===t[e])return"_";i+=r.dateToIso(t[e])}return i}function h(e,t){var r=n[e];if(r.children){for(var a=0,i=r.children.length;a<i;a++)if("_"!==t[r.children[a]])return!1;return!0}return"_"===t[e]}var f=function(e){var s={},f={};!function(){var t,i;if(e)for(i in e)t=r.fromString(e[i]),e.hasOwnProperty(i)&&n[i]&&a(t)&&(s[i]=t)}(),this.hasDates=function(e){if(i(e),n[e].children){for(var r=0,a=n[e].children.length;r<a;r++)if(!t.page.hasDates(n[e].children[r]))return!1;return!0}return!!s[e]&&"_"!==s[e]},this.hasUserSetDates=function(e){return n[e].children?n[e].children.reduce(function(e,t){return e||!!f[t]},!1):!!f[e]},this.getDates=function(e){var t=[];if(i(e),n[e].children)for(var r=0,a=n[e].children.length;r<a;r++)t.push(s[n[e].children[r]]);else t.push(s[e]);for(var r in t)"_"===t[r]&&(t[r]=null);return t},this.setDates=function(e,t){if(i(e),Array.isArray(t)||(t=[t]),t=t.map(function(e){return e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate()):"_"}),n[e].children){if(n[e].children.length!==t.length)throw"Incorrect number of dates for date type "+e;for(var r=0,a=n[e].children.length;r<a;r++){var o=n[e].children[r];s[o]=t[r],f[o]=!0}}else{if(1!==t.length)throw"Incorrect number of dates for date type "+e;s[e]=t[0]}f[e]=!0},this.clearDates=function(e){if(!e)return void(s={});if(i(e),n[e].children)for(var t=0,r=n[e].children.length;t<r;t++)s[n[e].children[t]]="_";else s[e]="_"},this.datesToQueryString=function(e){var r=n[e];if(i(e),!r.queryString)throw"Cannot generate query-string for DateType "+e;return(t.page.hasDates(e)||h(e,s))&&t.page.hasUserSetDates(e)?r.queryString+"="+o(e,s):""},this.datesToQueryPath=function(e){var r=n[e];if(i(e),!r.pathString)throw"Cannot generate path-string for DateType "+e;return(t.page.hasDates(e)||h(e,s))&&t.page.hasUserSetDates(e)?r.pathString+o(e,s):""},this.datesToQueryJson=function(e){var r=n[e],a={};if(i(e),!r.queryString)throw"Cannot generate query json for DateType "+e;return(t.page.hasDates(e)||h(e,s))&&(t.page.hasUserSetDates(e)||"EATERY"===e)?(a[r.queryString]=o(e,s),a):{}}};return f.prototype.onDatesSelected=function(e,r,n){var a=s(r);if(t.page&&t.page.emit){t.page.emit("dateSelected",e,r,n);for(var i=0,o=a.length;i<o;i++)t.page.hasDates(a[i])&&t.page.emit("dateSelected",e,a[i],t.page.getDates(a[i]))}},f.prototype.usingUnifiedDates=!0,f});
define("overlays/options/moveIntoView",["lib/jquery-amd"],function(t){"use strict";var o=500;return function(e,n){return e="undefined"==typeof e||e,n="undefined"!=typeof n||isNaN(n)?n:0,function(){this.on("show",function(){var i,f,r=t(this.container),s=t(this.sourceElement);e?(i=Math.min(r.offset().top,s.offset().top),f=Math.max(r.offset().top+r.outerHeight(),s.offset().top+s.outerHeight())):(i=r.offset().top,f=r.offset().top+r.outerHeight());var u=window.innerHeight,a=t(window).scrollTop(),h=a+u;if(!(i>=a&&f<=h)){var p,c=f-i;p=c>u||i<a?i-n:f-u+n,t("html, body").animate({scrollTop:p},o)}})}}});
define("ta/util/I18N",["vanillajs","ns-exporter"],function(t,n){var e={};return e.isRtl=function(){return document.body&&!!document.body.className.match(/\brtl\b/)},n.exportTo(e,"ta.util.i18n"),e});
define("ta/Core/TA.Dust",["vanillajs","ns-exporter","ta/util/Error","ta/util/Deferred","ta/Core/TA.Store"],function(e,r,t,n,u){"use strict";var d={},i=null,o=function(){if(null!=i)return i;try{return i=JSON.parse(u.retrieve("DUST_GLOBAL"))}catch(e){}return i=u.retrieve("DUST_GLOBAL_CONTEXT"),i?i:"undefined"!=typeof window&&window.DUST_GLOBAL?window.DUST_GLOBAL:require.defined("page-model")?require("page-model").DUST_GLOBAL:{}};d.render=function(e,r,n,u){var d=o(),i="string"==typeof n?document.querySelector(n):n,a=dust.makeBase(d).rebase(r);return!!(i&&e&&d.LOCALE&&dust)&&(dust.render(s(e),a,function(n,d){d?i.innerHTML=d:n&&t.record(n,"Error rendering dust template "+e),u&&u(r)}),!0)},d.renderToString=function(e,r){var u=o(),d=dust.makeBase(u).rebase(r),i=n(!0);return e&&u.LOCALE&&dust?(dust.render(s(e),d,function(r,n){n?i.resolve(n):r&&(t.record(r,"Error rendering dust template "+e),i.reject(r))}),i.promise()):(i.reject("Missing dependencies"),i.promise())};var s=function(e){var r=e.replace(/\//g,"_").replace(".dust",""),t=o().LOCALE;return t+r};return r.exportTo(d,"ta.dust"),d});
define("calendars/DesktopStayDates",["vanillajs","api-mod","overlays/Overlay","overlays/styles/modal","overlays/styles/popover","overlays/position","overlays/options/closeOnDocClick","overlays/options/repositionOnEvent","overlays/options/repositionOnTaEvent","overlays/options/storeOverlayOnElement","calendars/CalendarDate","overlays/options/closeOnTaEvent","overlays/options/centerArrowOnSrcElement","overlays/options/moveIntoView","ta/util/I18N","ta/Core/TA.Dust","ta/util/Deferred","ta/util/Date","mixins/page-dates/DateTypeStore","ta/Core/TA.Record","utils/responsive"],function(e,t,n,a,r,o,i,d,s,l,c,u,p,h,f,v,m,D,y,T,w){"use strict";function C(e,t){var n,a=[],r=!1,o=y.isSingleDateType(t.dateType);e.eachDayInMonth(function(e){var n=!r&&0===e.compare(t.today);r=r||n;var i=t.startDate&&0===e.compare(t.startDate);a.push({label:e.day(),date:_(e,t)?null:e.toString(),today:n,start:!o&&i,end:t.endDate&&0===e.compare(t.endDate),selected:o?i:e.inRange(t.startDate,t.endDate)})}),n=e.firstDayOfMonth()-jsGlobalDayOffset,n+=n<0?7:0;for(var i=0;i<n;i++)a.unshift({label:"&nbsp;"});var d=e.year();t.thaiOffset===!0&&(d+=H);var s=ta.i18n?ta.i18n.formatDate("date_medium_month_year",new Date(d,e.month())):jsGlobalMonths[e.month()]+" "+d;return{dayLabels:jsGlobalDaysShort,days:a,header:s}}function M(e){var t=[C(e.currentMonth,e),C(e.currentMonth.nextMonth(),e)];return{incomplete:e.incomplete,months:t,showPrices:e.showPrices,didCreateDefaultDates:e.didCreateDefaultDates,calendarPopupDirection:e.calendarPopupDirection,showClearButton:e.showClearButton,calendarTitle:e.calendarTitle}}function b(e){if(y.isChildDateType(e))for(var t=y.getParents(e),n=0;n<t.length;n++)ta.page.clearDates(t[n]);else ta.page.clearDates(e)}function E(e){var t=new c,n={availableDates:e.availableDates,excludedDates:e.excludedDates,startDate:e.startDate&&new c(e.startDate),endDate:e.endDate&&new c(e.endDate),today:t,thisMonth:t.thisMonth(),incomplete:e.incomplete,dateType:e.dateType,minEnabledDate:e.minEnabledDate||t,maxEnabledDate:e.maxEnabledDate||t.relativeDay(330),maxStayLength:e.maxStayLength||D.MAX_STAY_DURATION_DAYS,thaiOffset:e.thaiOffset,didCreateDefaultDates:e.didCreateDefaultDates,calendarPopupDirection:e.calendarPopupDirection,showClearButton:e.showClearButton||!1,className:e.className||null,calendarTitle:e.calendarTitle||null};return n.currentMonth=g(n),n.minEnabledDate&&y.isMultiCityDateType(n.dateType)&&n.currentMonth.compare(n.minEnabledDate.thisMonth())<0&&(n.currentMonth=n.minEnabledDate.thisMonth()),n}function g(e){var t;if("RETURN"===e.dateType&&e.endDate){var n=e.startDate?e.startDate.thisMonth():e.thisMonth;t=n.compare(e.endDate.previousMonth())<0?e.endDate.previousMonth():n}else e.startDate?t=e.startDate.thisMonth():e.endDate?(t=e.endDate.previousMonth(),e.thisMonth.compare(t)>0&&(t=e.thisMonth)):t=e.thisMonth;return y.isEndDateType(e.dateType)&&y.isHotelDateType(e.dateType)&&e.endDate&&(w.mobile()?t=e.endDate.thisMonth():(t=e.endDate.previousMonth(),e.thisMonth.compare(t)>0&&(t=e.thisMonth))),t}function _(e,t){var n=t.today,a=t.startDate,r=t.dateType,o=t.minEnabledDate,i=t.maxEnabledDate,d=t.maxStayLength,s=t.availableDates,l=t.excludedDates;if(!A(r)){if(s){for(var u=0;u<s.length;u++)if(0==new c(e.date).compare(new c(s[u])))return!1;return!0}if(l)for(var u=0;u<l.length;u++)if(0==new c(e.date).compare(new c(l[u])))return!0}if(o&&o.compare(e)>0)return!0;var p=n&&n.relativeDay(1);return!!(y.isEndDateType(r)&&p&&p.compare(e)>0)||(!!(A(r)&&a&&a.daysTo(e)>d)||!!(i&&i.compare(e)<0))}function x(e,n,a){var r=2,o=e>0?r:-1,i=n.currentMonth.relativeMonth(o),d=f.isRtl()?"dsdc-scroll-right":"dsdc-scroll-left";i.compare(n.minEnabledDate.thisMonth())<0||i.compare(n.maxEnabledDate.thisMonth())>0||(i.compare(n.today.relativeMonth(12))>0&&!L&&(L=!0,T.trackEventOnPage("DATEPICKER","viewed_year_out")),N=!0,v.renderToString(B,{month:C(i,n)}).then(function(r){var o=t.find(".dsdc-months",a),i=document.createElement("div");i.innerHTML=r,e<0?(t.addClass(o,"dsdc-no-anim"),o.insertBefore(i.firstChild,o.firstChild),t.addClass(o,d),t.forceReflow(o),t.removeClass(o,"dsdc-no-anim")):o.appendChild(i.firstChild),e<0?t.removeClass(o,d):t.addClass(o,d),setTimeout(function(){e<0?o.removeChild(o.lastChild):(t.addClass(o,"dsdc-no-anim"),o.removeChild(o.firstChild),t.removeClass(o,d),t.forceReflow(o),t.removeClass(o,"dsdc-no-anim")),N=!1},I?F:0),n.currentMonth=n.currentMonth.relativeMonth(e),S(n)}))}function S(e,n){e.currentMonth.compare(e.minEnabledDate.thisMonth())<=0?t.addClass(t.find(".dsdc-prev",n),"dsdc-inactive"):t.removeClass(t.find(".dsdc-prev",n),"dsdc-inactive"),e.currentMonth.relativeMonth(1).compare(e.maxEnabledDate.thisMonth())>=0?t.addClass(t.find(".dsdc-next",n),"dsdc-inactive"):t.removeClass(t.find(".dsdc-next",n),"dsdc-inactive")}function k(){document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function O(e,t,n,a){if(a=a||window.event,a&&a.target&&!N){var r=a.target.className;return r.indexOf("dsdc-next")>=0?x(1,t,n):r.indexOf("dsdc-prev")>=0?x(-1,t,n):a.target.getAttribute("data-date")&&(e.resolve([c.fromString(a.target.getAttribute("data-date")).date]),R&&R.hide()),k(),!1}}function P(e){var t="no_x no_padding date_picker_modal";return t+=" "+(window.isTabletOnFullSite?"tablet":"desktop"),t+=" "+e.dateType,t+=" "+(e.className||"")}function A(e){return y.isChildDateType(e)&&!y.isStartDateType(e)&&!y.isRoundTripDateType(e)}var R,N,j="calendars/desktop_stay-dates/calendar.dust",B="calendars/desktop_stay-dates/month.dust",F=300,I=!!window.TransitionEvent,L=!1,H=543;return{open:function(e,r){R&&R.destroy();var s=m(!0),c=E(r);return v.renderToString(j,M(c)).then(function(r){var p=[a(e,"below",P(c),null,null,r),o.bottomRight(),i,l,d(window,"date_bar_docked"),d(window,"date_bar_undocked"),u("dualSearchTypeaheadOpen")];R=new n(e,p),R.on("hide",function(){s.isFulfilled()||s.reject(),R=null}),R.show(),S(c,R.container),t.addEvent(R.container,"click",O.bind(null,s,c,R.container))}),s.promise()},openInline:function(e,n,a){var r=m(!0),o=E(n),i=a.querySelector(".innerCalendarWrapper");t.destroy(i),i=document.createElement("div"),i.className="innerCalendarWrapper",a.appendChild(i),o.showPrices=!ta.page.hasDates("STAYDATES");var d=function(){i.style.display="none",r.isFulfilled()||r.reject()};return v.renderToString(j,M(o)).then(function(n){i.innerHTML=n,S(o,i),t.addEvent(i,"click",O.bind(null,r,o,i)),t.addEvent(t.find(".update_results_button",i),"click",function(){t.addClass(e,"greenFocus")}),t.addEvent(t.find(".dsdc-close-x",i),"click",d),t.addEvent(t.find(".clearDatesBox",i),"click",function(){b(o.dateType),d()})}),r.promise()},openInContainer:function(e,n,a){var r=m(!0),o=E(n),i=t.getParent(a,"calendarFlyout"),d=t.find(".innerCalendarWrapper",a),s=a.overlay;return t.destroy(d),d=document.createElement("div"),d.className="innerCalendarWrapper",a.appendChild(d),s&&s.on("hide",function(){r.isFulfilled()||r.reject()}),v.renderToString(j,M(o)).then(function(e){d.innerHTML=e,S(o,d),t.addEvent(d,"click",O.bind(null,r,o,d))}),i.deferred=r,r.promise()},closeCalendar:function(){R&&R.destroy()},openAsPopover:function(e,a){function c(e){return"function"==typeof o[e]&&"below"!=e?o[e]([0,0]):o.bottomRight([-16,-8])}function f(e){return e&&e.calendarPopupDirection&&""!=e.calendarPopupDirection?e.calendarPopupDirection:"below"}R&&R.destroy();var D=m(!0),y=E(a);return v.renderToString(j,M(y)).then(function(o){var v=f(y),m=t.find(".trip_search"),T=t.find(".ui_icon.calendar",e);m&&(v="below");var w=c(v),C=[r(e,v,P(y),null,o),w,p(T),i,l,d(window,["resize","date_bar_docked","date_bar_undocked"]),s("showingCookieConsentBanner"),s("makeTextFitResizedText"),u("dualSearchTypeaheadOpen")];a.moveIntoView&&C.push(h(!0,30)),R=new n(e,C),R.on("hide",function(){D.isFulfilled()||D.reject(),R=null}),t.addEvent(t.find(".dsdc-close-x",R.container),"click",function(){R.hide()}),t.addEvent(t.find(".dsdc-wrapper .ui_close_x",R.container),"click",function(){R.hide()}),t.addEvent(t.find(".clearDatesBox",R.container),"click",function(){b(y.dateType),R.hide()}),R.show(),S(y,R.container),t.addEvent(R.container,"click",O.bind(null,D,y,R.container))}),D.promise()}}});
define("mixins/page-dates/Validator",["vanillajs","ta","mixins/page-dates/DateTypeStore","calendars/CalendarDate","ta/util/Date"],function(e,t,a,n,r){"use strict";function i(e){if(!a[e].children||!t.page.hasDates(e))return!0;var n=a[e].children,r=t.page.getDates(e);return a.isStartDateType(n[0])&&a.isEndDateType(n[1])&&r[0]<=r[1]||a.isEndDateType(n[0])&&a.isStartDateType(n[1])&&r[1]<=r[0]}function s(e){if(!a[e].children||!t.page.hasDates(e))return!0;var n=t.page.getDates(e);return n[0].getTime()!==n[1].getTime()}function u(e){return function(n){return!a[n].children||!t.page.hasDates(n)||D.apply(null,t.page.getDates(n))<=e}}function D(e,t){var a=e instanceof n?e:new n(e),r=t instanceof n?t:new n(t);return Math.abs(a.daysTo(r))}var o=function(e){var t=e&&e.hasOwnProperty("maxStayLength")?e.maxStayLength:r.MAX_STAY_DURATION_DAYS;this.VALIDATORS={STAYDATES:[i,s,u(t)],ROUNDTRIP:[i]}};return o.prototype.validate=function(e){var t=this.VALIDATORS[e];return!t||0==t.length||!t.some(function(t){return!t(e)})},o});
define("mixins/page-dates/default-dates",["ta","mixins/mixin","mixins/Events","mixins/page-dates/pop-calendar","common/trackingStreams","vanillajs","ta/Core/TA.Event"],function(e,t,a,n,o,d,i){"use strict";function r(e){n.init(e),c=!!e.datesWereDefaulted,f=!!e.refreshLocalStorage,g=e.localStorageTTL,D=!0,m.emit("init")}function s(e){"function"==typeof e&&(D?e():m.on("init",e))}function p(t,a){function d(t){n.wasPoppedThisPageLoad()&&(m.emit("poppedCalendarDismissed",t),e.page.off("datepickerRejected",d))}function r(){if(s&&(c&&o.trackEvent("DATEPICKER","undated_to_default_dated"),!a)){var t=n.shouldPop();(t||n.shouldPopMetaMarketing())&&(t&&m.emit("popFromDefault"),e.page.on("datepickerRejected",d),n.popCalendar(s))}}if(e.page.usingUnifiedDates){e.page.hasDates("STAYDATES")||e.page.clearDates("STAYDATES"),u=e.page.getDates("CHECKIN")[0],l=e.page.getDates("CHECKOUT")[0];var s=t.querySelector('[data-datetype="CHECKIN"]');e.page.on("dateSelected",function(a,i,r){var s,p=u&&l,f=e.page.getDates("STAYDATES")[0],g=e.page.getDates("STAYDATES")[1];t.contains(a)&&(!p&&e.page.hasDates("STAYDATES")?s="undated_to_manually_dated":f==u&&g==l||(n.setUserEnteredDates(),e.page.off("datepickerRejected",d),c?(s="default_dated_to_manually_dated",c=!1):s="manually_dated_to_manually_dated"),u=f,l=g,s&&o.trackEvent("DATEPICKER",s))}),"loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r(),i.on("specialOfferClosed",function(){a||n.shouldPop()&&s&&n.popCalendar(s)})}}var u,l,c=!1,f=!1,g=0,D=!1,m={init:r,onInit:s,apply:p,usingDefaults:function(){return c},shouldRefreshLocalStorage:function(){return f},getLocalStorageTTL:function(){return g}};return t(m,new a("popFromDefault"))});
define("mixins/page-dates/Desktop",["vanillajs","ta","api-mod","ta/Core/TA.Event","ta/Core/TA.Store","ta/Core/TA.LocalStorage","ta/util/Date","mixins/page-dates/Base","calendars/DesktopStayDates","calendars/CalendarDate","mixins/page-dates/Utils","mixins/page-dates/DateTypeStore","mixins/page-dates/Validator","mixins/page-dates/default-dates"],function(e,a,t,n,r,l,s,i,d,o,p,u,D,g){"use strict";function c(e,t){var n={startDate:u.getStartDate(e),dateType:e,thaiOffset:y,autoSelectDates:x,didCreateDefaultDates:P,calendarPopupDirection:I,showClearButton:M,calendarTitle:Y,popCalendarType:K,qualtricsSurveyEnabled:L,moveIntoView:R,hasMetaMarketingDefaultDates:U},r=u.getMinEnabledDate(e);return u.isHotelDateType(e)||u.isRoundTripDateType(e)?(n.endDate=u.getEndDate(e),n.incomplete=!a.page.hasDates("STAYDATES"),n.maxStayLength=b,r&&(n.minEnabledDate=r),H?n.maxEnabledDate=new o(p.fromString(H)):w&&(n.maxEnabledDate=(new o).relativeDay(parseInt(w))),t&&(n.calendarPopupDirection=t)):(n.incomplete=!a.page.hasDates(e),n.availableDates=_,n.excludedDates=k,n.minEnabledDate=r||N&&new o(p.fromString(N)),n.maxEnabledDate=H&&new o(p.fromString(H))),n}function f(e){var n,r=e.getAttribute("data-dateType"),l=void 0,s=void 0,i=e;if(null==u.getCorrespondingDateType(r))return null;if(n="[data-dateType="+u.getCorrespondingDateType(r)+"]",window&&window.pageServlet&&("HotelHighlight"==window.pageServlet||"SmartDeals"==window.pageServlet)){for(var d=0;d<3&&!s;d++){if(e=e.parentNode,!e)return null;s=e.getAttribute("data-pickerIndex")}var o=document.querySelector("[data-pickerIndex='"+s+"']");return a.find(n,o)}for(var d=0;d<3&&!l;d++){if(e=e.parentNode,!e)return null;l=t.find(n,e)}return null==l&&u.isStartDateType(r)?(i.setAttribute("data-dateType",u.getCorrespondingDateType(r)),i):l}function T(e){u.getParents(e).forEach(function(t){m.validate(t)||u[t].children.filter(function(a){return a!==e}).forEach(function(e){a.page.clearDates(e),a.page.emit("dateSelected",null,e,[null])})})}function S(){if(a.widgets.calendar&&!a.widgets.calendar.isShim){var e=a.page.getDates("CHECKIN")[0],t=a.page.getDates("CHECKOUT")[0];a.page.hasDates("CHECKIN")?a.widgets.calendar.setPageInDate(s.create(e.getFullYear(),e.getMonth(),e.getDate()),!0):a.widgets.calendar.clearPageInDate(!0),a.page.hasDates("CHECKOUT")?a.widgets.calendar.setPageOutDate(s.create(t.getFullYear(),t.getMonth(),t.getDate()),!0):a.widgets.calendar.clearPageOutDate(!0),a.widgets.calendar.syncAllDatePickers()}}function C(e,t,n){if(null!=e){var r=e.getAttribute("data-trackingContext");r||(r=e.getAttribute("data-dateType")),r+=n||!a.page.hasDates(e.getAttribute("data-dateType"))?"|PRE":"|CHANGE",a.trackEventOnPage("DATEPICKER",t,r)}}function E(e,t,n,r){var l="START";if("STAYDATES"!==n&&r&&null!=r[0]){if(("CHECKIN"===n||"CHECKOUT"===n)&&a.page.hasDates("STAYDATES")&&(l="SELECT",t)){var s;s=O?P?"default_dated_to_manually_dated":"manually_dated_to_manually_dated":"undated_to_manually_dated",a.trackEventOnPage("DATEPICKER",s),P=!1,O=!0}C(t,l,e)}}var m,h=!(!(a&&a.widgets&&a.widgets.calendar)||a.widgets.calendar.isShim),v=!1,A=d.openAsPopover,y=!1,w=null,b=s.MAX_STAY_DURATION_DAYS,x=!1,P=!1,I=null,O=!1,_=null,k=null,N=null,H=null,M=!1,Y=null,K="",L=!1,R=!1,U=!1,F=function(e,a){t.mixin(this,new i(e)),m=new D(a),a&&(y=a.thaiOffset||y,v=a.popCheckInFirst||v,b=a.maxStayLength||s.MAX_STAY_DURATION_DAYS,x=a.autoSelectDates,P=a.didCreateDefaultDates,I=a.calendarPopupDirection,_=a.availableDates,k=a.excludedDates,N=a.minEnabledDate,H=a.maxEnabledDate,w=a.maxEnabledDaysOut,M=a.showClearButton||M,Y=a.calendarTitle||Y,K=a.popCalendarType||K,L=a.qualtricsSurveyEnabled||L,R=a.moveIntoView||R,U=a.hasMetaMarketingDefaultDates||U,g.init({datesWereDefaulted:a.didCreateDefaultDates,popFromDefault:a.supportsPrePopWithDefaultDates,popFromUndated:a.supportsPrePopWithNoDates,popCalendarType:a.popCalendarType,qualtricsSurveyEnabled:L,hasMetaMarketingDefaultDates:a.hasMetaMarketingDefaultDates,refreshLocalStorage:a.defaultDatesRefreshLocalStorage,localStorageTTL:a.defaultDatesLocalStorageTTL||0}))};return F.prototype.gatherDates=function(e,l,s,i,o){v&&e&&"CHECKOUT"===e.getAttribute("data-dateType")&&!a.page.hasDates("CHECKIN")&&!a.page.hasDates("CHECKOUT")&&(e.blur(),e=f(e));var p=e?e.getAttribute("data-dateType"):"UNKNOWN",u=E.bind(null,!a.page.hasDates(p));if(!e||!t.hasClass(e,"focused")){t.addClass(e,"focused"),C(e,"OPEN"),a.page.on("dateSelected",u);var D=A;l&&(D=i?d.openInline:d.openInContainer);var g=e?e.getAttribute("data-popup-direction-override"):null;return D.call(null,e,c(p,g),l).then(function(d){r.store("enteredDatesInPreDates",!a.page.hasDates("STAYDATES")),t.removeClass(e,"focused"),t.removeClass(e,"greenFocus"),a.page.pushDates(e,p,d,s),a.page.removeListener("dateSelected",u),a.page.emit("userClickedDate",p);var o=a.page.hasDates("STAYDATES");o&&!s&&n.fireEvent("onCalendarRangeSelect"),i&&o&&l.getElement(".innerCalendarWrapper").hide()},function(){t.removeClass(e,"focused"),t.removeClass(e,"greenFocus"),a.page.removeListener("dateSelected",u),i&&a.page.hasDates("STAYDATES")&&l.getElement(".innerCalendarWrapper").hide(),o&&a.page.hasDates("STAYDATES")&&a.page.onDatesSelected(e,p,a.page.getDates("STAYDATES"),s),a.page.emit("datepickerRejected",e)})}},F.prototype.gatherDatesNear=function(e){var t=p.findClosestDatepicker(e,"CHECKIN");t&&a.page.gatherDates(t)},F.prototype.pushDates=function(e,t,n,r){a.page.setDates(t,n),T(t),h&&S(),a.page.onDatesSelected(e,t,n,r)},F.prototype.setAvailableDates=function(e){_=e},F.prototype.setMaximumDaysOut=function(e){w=e},F.prototype.setExcludedDates=function(e){k=e},F});
define("common/pixels-loader",["vanillajs","mixins/page-dates/DateEvents","ta/Core/TA.FireEvent"],function(n,o,e){"use strict";var i,t=2e3,a=function(){require(["trjs!ta/common/behavior/Ads-pagemoniker"],function(n){n.loadMonikers(),o.on("dateSelected",function(o,e){"STAYDATES"==e&&window.setTimeout(n.loadMonikerForEnterDates,2e3)})}),i&&i.shouldInitFlightsEvents&&r(),a=function(){}},r=function(){var n=new Promise(require.bind(null,["trjs!ta/common/behavior/Ads-pagemoniker"]));e.on("lcbPop",function(){n.then(function(n){n.loadMonikerForLCBPop()})}),e.on("packageClick",function(){n.then(function(n){n.loadVacationPackageMetaMonikers()})}),e.on("metaLinkClickPixelLoad",function(o){n.then(function(n){n.loadFlightsMetaMonikers(o)})}),e.on("metaLightboxLoad",function(o){n.then(function(n){n.loadLightboxMonikers(o)})}),e.on("flightSearchPixelLoad",function(){n.then(function(n){n.loadMonikerForFlightSearch()})})};return{init:function(n){i=n,n&&n.pixelsEnabled&&setTimeout(a,t)},remarketingOptions:function(){return i}}});
define("mixins/Reviews",["lib/jquery-amd","utils/asdf-encoder","ta/common/Repoll","ta/util/ajaxPreserves","ta/Core/TA.Event","ta/util/Error","ta/prwidgets","utils/form-to-json"],function(e,t,i,o,a,n,r,s){"use strict";function l(t){var i=e(t.scrollDestination,t.reviews).filter(":visible");if(i.length){var o=i.offset().top-80,a=window.pageYOffset;e("html,body").animate({scrollTop:o},400,function(){window.pageYOffset==a&&window.scrollTo(0,o)})}}function f(t,i){t=t||{};var o=e(i.reviews),a=o.find(i.loadingContainer),n=a.find(i.loadingBox),r=0;t.whiteBoxTopElmt&&(r=e(t.whiteBoxTopElmt).offset().top-o.offset().top),a.css({top:r});var s=t.loadingBoxTopElmt;if(r="",s){s.substr&&s.match(/^[a-zA-Z]/)&&(s="#"+s);var l=e(s).offset(),f=o.offset();l&&f&&(r=l.top-f.top)}n.css({top:r}),o.addClass("loading")}function d(e){return e=e||{},e.reviews=e.reviews||"#REVIEWS",e.scrollDestination=e.scrollDestination||".filters_container, .search_box_container, .pagination-details, .review",e.loadingContainer=e.loadingContainer||".loadingContainer",e.loadingBox=e.loadingBox||".loadingBox",e.loadingClass=e.loadingClass||"loading",e}var p=function(c){function g(e,i){var o,a=e.getAttribute("href")||e.getAttribute("data-href");if(a)o=a;else{var r=e.getAttribute("data-page");if(!r)return void n.record(new Error("No href, data-href or data-page found in pagination element."),"Reviews.js _applyPaginationOffset");o=t.asdf(r)}var s=location.pathname!==o;if(s){if(f(i,c),!history.replaceState)return void setTimeout(function(){window.location.href=o},10);history.replaceState(history.state,document.title,o),l(c),y.setPageUrl(o),y.setOneTimeParams({},"REVIEW_LIST")}}function u(t,i){h=!0,f(i,c);var o=location.pathname.replace(/-or\d+/,""),a=location.pathname!==o;if(!history.replaceState&&a)return void t.submit();a&&(history.replaceState(history.state,document.title,o),y.setPageUrl(o));var n=s(e(t).get(0));y.setOneTimeParams(n,"REVIEW_LIST")}function v(t){var i=e(c.reviews),n=i.find(":focus");o.replaceContent(t,i.get(0)),i.removeClass(c.loadingClass),r.initWidgets(i.get(0)),n.closest(".ajax_preserve").length&&n.focus(),h=!1,a.fireEvent("reviewListUpdated",t)}function m(){e(c.reviews+"."+c.loadingClass).removeClass(c.loadingClass).empty(),h=!1}function w(){return h}c=d(c);var h=!1,y=new i({evaluateScripts:!0});a.on("page-repoll-failed",m),a.on("review-list-update",v),p.prototype.applyReviewFiltersForm=u,p.prototype.applyPaginationOffset=g,p.prototype.isRefreshingReview=w};return p});
define("mobile/lite/image-loader",["utils/throttle","vanillajs"],function(e){"use strict";function t(t,n){n=n||document,l=t||0;var i=Array.prototype.filter.call(n.querySelectorAll("["+o+"]"),r());if(0!=i.length){var a=e(function(e){i=i.filter(r()),0==i.length&&(window.removeEventListener("scroll",a),window.removeEventListener("resize",a))},200);window.addEventListener("scroll",a),window.addEventListener("resize",a)}}function r(){return function(e){if(!document.body.contains(e))return!1;try{if(!i(e))return!0}catch(e){return!1}var t=e.getAttribute(o);return!t||("IMG"===e.tagName?e.src=t:e.style.backgroundImage="url("+t+")",e.removeAttribute(o),!1)}}function n(e){e=e||document;var t=e.querySelectorAll("["+o+"]");Array.prototype.filter.call(t,r())}function i(e){var t=e.getBoundingClientRect();return t.width>0&&t.height>0&&t.top+l>=0&&t.top-l<=window.innerHeight}var o="data-lazyurl",l=0;return{init:t,demandLoadImages:n}});
define("servlets/attractionreview",["mixins/mixin","mixins/page-dates/DateEvents","mixins/page-dates/Desktop","common/pixels-loader","mixins/Reviews","mobile/lite/image-loader"],function(i,e,t,n,s,a){"use strict";function r(r){return m||(i(this,e),i(this,new t(r.pageDates)),i(this,new s),n.init(r.remarketingOptions),a.init(200),m=!0),this}var m=!1;return{init:r}});
